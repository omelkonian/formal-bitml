<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>BitML.Semantics.Configurations.Helpers</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Utilities for constructing configurations.</a>
<a id="120" class="Comment">------------------------------------------------------------------------</a>
<a id="193" class="Keyword">open</a> <a id="198" class="Keyword">import</a> <a id="205" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="218" class="Keyword">open</a> <a id="223" class="Keyword">import</a> <a id="230" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="244" class="Keyword">open</a> <a id="249" class="Keyword">import</a> <a id="256" href="Prelude.Sets.html" class="Module">Prelude.Sets</a>
<a id="269" class="Keyword">open</a> <a id="274" class="Keyword">import</a> <a id="281" href="Prelude.Collections.html" class="Module">Prelude.Collections</a>
<a id="301" class="Keyword">open</a> <a id="306" class="Keyword">import</a> <a id="313" href="Prelude.Applicative.html" class="Module">Prelude.Applicative</a>
<a id="333" class="Keyword">open</a> <a id="338" class="Keyword">import</a> <a id="345" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="363" class="Keyword">open</a> <a id="368" class="Keyword">import</a> <a id="375" href="Prelude.Nary.html" class="Module">Prelude.Nary</a>

<a id="389" class="Keyword">open</a> <a id="394" class="Keyword">import</a> <a id="401" href="BitML.BasicTypes.html" class="Module">BitML.BasicTypes</a>

<a id="419" class="Keyword">module</a> <a id="426" href="BitML.Semantics.Configurations.Helpers.html" class="Module">BitML.Semantics.Configurations.Helpers</a>
  <a id="467" class="Symbol">(</a><a id="468" href="BitML.Semantics.Configurations.Helpers.html#468" class="Bound">Participant</a> <a id="480" class="Symbol">:</a> <a id="482" class="PrimitiveType">Set</a><a id="485" class="Symbol">)</a>
  <a id="489" class="Symbol">{{</a><a id="491" href="BitML.Semantics.Configurations.Helpers.html#491" class="Bound">_</a> <a id="493" class="Symbol">:</a> <a id="495" href="Prelude.DecEq.html#553" class="Record">DecEq</a> <a id="501" href="BitML.Semantics.Configurations.Helpers.html#468" class="Bound">Participant</a><a id="512" class="Symbol">}}</a>
  <a id="517" class="Symbol">(</a><a id="518" href="BitML.Semantics.Configurations.Helpers.html#518" class="Bound">Honest</a> <a id="525" class="Symbol">:</a> <a id="527" href="Data.List.NonEmpty.html#1318" class="Record">List⁺</a> <a id="533" href="BitML.Semantics.Configurations.Helpers.html#468" class="Bound">Participant</a><a id="544" class="Symbol">)</a>
  <a id="548" class="Keyword">where</a>

<a id="555" class="Keyword">open</a> <a id="560" class="Keyword">import</a> <a id="567" href="BitML.Contracts.Types.html" class="Module">BitML.Contracts.Types</a> <a id="589" href="BitML.Semantics.Configurations.Helpers.html#468" class="Bound">Participant</a> <a id="601" href="BitML.Semantics.Configurations.Helpers.html#518" class="Bound">Honest</a>
<a id="608" class="Keyword">open</a> <a id="613" class="Keyword">import</a> <a id="620" href="BitML.Contracts.Helpers.html" class="Module">BitML.Contracts.Helpers</a> <a id="644" href="BitML.Semantics.Configurations.Helpers.html#468" class="Bound">Participant</a> <a id="656" href="BitML.Semantics.Configurations.Helpers.html#518" class="Bound">Honest</a>
<a id="663" class="Keyword">open</a> <a id="668" class="Keyword">import</a> <a id="675" href="BitML.Semantics.Action.html" class="Module">BitML.Semantics.Action</a> <a id="698" href="BitML.Semantics.Configurations.Helpers.html#468" class="Bound">Participant</a> <a id="710" href="BitML.Semantics.Configurations.Helpers.html#518" class="Bound">Honest</a>
<a id="717" class="Keyword">open</a> <a id="722" class="Keyword">import</a> <a id="729" href="BitML.Semantics.Configurations.Types.html" class="Module">BitML.Semantics.Configurations.Types</a> <a id="766" href="BitML.Semantics.Configurations.Helpers.html#468" class="Bound">Participant</a> <a id="778" href="BitML.Semantics.Configurations.Helpers.html#518" class="Bound">Honest</a>

<a id="786" class="Comment">-------------------------------------------------------------------</a>

<a id="855" class="Comment">-- Re-ordering configurations</a>
<a id="cfgToList"></a><a id="885" href="BitML.Semantics.Configurations.Helpers.html#885" class="Function">cfgToList</a> <a id="895" class="Symbol">:</a> <a id="897" href="BitML.Semantics.Configurations.Types.html#599" class="Datatype">Configuration</a> <a id="911" class="Symbol">→</a> <a id="913" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="918" href="BitML.Semantics.Configurations.Types.html#599" class="Datatype">Configuration</a>
<a id="932" href="BitML.Semantics.Configurations.Helpers.html#885" class="Function">cfgToList</a> <a id="942" href="BitML.Semantics.Configurations.Types.html#639" class="InductiveConstructor">∅ᶜ</a>       <a id="951" class="Symbol">=</a> <a id="953" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
<a id="956" href="BitML.Semantics.Configurations.Helpers.html#885" class="Function">cfgToList</a> <a id="966" class="Symbol">(</a><a id="967" href="BitML.Semantics.Configurations.Helpers.html#967" class="Bound">l</a> <a id="969" href="BitML.Semantics.Configurations.Types.html#1171" class="InductiveConstructor Operator">∣</a> <a id="971" href="BitML.Semantics.Configurations.Helpers.html#971" class="Bound">r</a><a id="972" class="Symbol">)</a> <a id="974" class="Symbol">=</a> <a id="976" href="BitML.Semantics.Configurations.Helpers.html#885" class="Function">cfgToList</a> <a id="986" href="BitML.Semantics.Configurations.Helpers.html#967" class="Bound">l</a> <a id="988" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="991" href="BitML.Semantics.Configurations.Helpers.html#885" class="Function">cfgToList</a> <a id="1001" href="BitML.Semantics.Configurations.Helpers.html#971" class="Bound">r</a>
<a id="1003" href="BitML.Semantics.Configurations.Helpers.html#885" class="CatchallClause Function">cfgToList</a><a id="1012" class="CatchallClause"> </a><a id="1013" href="BitML.Semantics.Configurations.Helpers.html#1013" class="CatchallClause Bound">c</a>        <a id="1022" class="Symbol">=</a> <a id="1024" href="Data.List.Base.html#4458" class="Function Operator">[</a> <a id="1026" href="BitML.Semantics.Configurations.Helpers.html#1013" class="Bound">c</a> <a id="1028" href="Data.List.Base.html#4458" class="Function Operator">]</a>

<a id="1031" class="Keyword">infix</a> <a id="1037" class="Number">3</a> <a id="1039" href="BitML.Semantics.Configurations.Helpers.html#1043" class="Function Operator">_≈_</a>
<a id="_≈_"></a><a id="1043" href="BitML.Semantics.Configurations.Helpers.html#1043" class="Function Operator">_≈_</a> <a id="1047" class="Symbol">:</a> <a id="1049" href="BitML.Semantics.Configurations.Types.html#599" class="Datatype">Configuration</a> <a id="1063" class="Symbol">→</a> <a id="1065" href="BitML.Semantics.Configurations.Types.html#599" class="Datatype">Configuration</a> <a id="1079" class="Symbol">→</a> <a id="1081" class="PrimitiveType">Set</a>
<a id="1085" href="BitML.Semantics.Configurations.Helpers.html#1085" class="Bound">c</a> <a id="1087" href="BitML.Semantics.Configurations.Helpers.html#1043" class="Function Operator">≈</a> <a id="1089" href="BitML.Semantics.Configurations.Helpers.html#1089" class="Bound">c′</a> <a id="1092" class="Symbol">=</a> <a id="1094" href="BitML.Semantics.Configurations.Helpers.html#885" class="Function">cfgToList</a> <a id="1104" href="BitML.Semantics.Configurations.Helpers.html#1085" class="Bound">c</a> <a id="1106" href="Data.List.Relation.Binary.Permutation.Propositional.html#1041" class="Datatype Operator">↭</a> <a id="1108" href="BitML.Semantics.Configurations.Helpers.html#885" class="Function">cfgToList</a> <a id="1118" href="BitML.Semantics.Configurations.Helpers.html#1089" class="Bound">c′</a>

<a id="1122" class="Keyword">infix</a> <a id="1128" class="Number">3</a> <a id="1130" href="BitML.Semantics.Configurations.Helpers.html#1135" class="Function Operator">_≈?_</a>
<a id="_≈?_"></a><a id="1135" href="BitML.Semantics.Configurations.Helpers.html#1135" class="Function Operator">_≈?_</a> <a id="1140" class="Symbol">:</a> <a id="1142" href="Relation.Binary.Definitions.html#4575" class="Function">Decidable²</a> <a id="1153" class="Symbol">{</a><a id="1154" class="Argument">A</a> <a id="1156" class="Symbol">=</a> <a id="1158" href="BitML.Semantics.Configurations.Types.html#599" class="Datatype">Configuration</a><a id="1171" class="Symbol">}</a> <a id="1173" href="BitML.Semantics.Configurations.Helpers.html#1043" class="Function Operator">_≈_</a>
<a id="1177" href="BitML.Semantics.Configurations.Helpers.html#1177" class="Bound">c</a> <a id="1179" href="BitML.Semantics.Configurations.Helpers.html#1135" class="Function Operator">≈?</a> <a id="1182" href="BitML.Semantics.Configurations.Helpers.html#1182" class="Bound">c′</a> <a id="1185" class="Symbol">=</a> <a id="1187" href="BitML.Semantics.Configurations.Helpers.html#885" class="Function">cfgToList</a> <a id="1197" href="BitML.Semantics.Configurations.Helpers.html#1177" class="Bound">c</a> <a id="1199" href="Prelude.DecEq.html#7889" class="Function Operator">↭?</a> <a id="1202" href="BitML.Semantics.Configurations.Helpers.html#885" class="Function">cfgToList</a> <a id="1212" href="BitML.Semantics.Configurations.Helpers.html#1182" class="Bound">c′</a>

<a id="1216" class="Keyword">instance</a>
  <a id="HNᵃᶜ"></a><a id="1227" href="BitML.Semantics.Configurations.Helpers.html#1227" class="Function">HNᵃᶜ</a> <a id="1232" class="Symbol">:</a> <a id="1234" href="BitML.Semantics.Action.html#606" class="Datatype">Action</a> <a id="1241" href="Prelude.Collections.html#148" class="Record Operator">has</a> <a id="1245" href="BitML.BasicTypes.html#333" class="Function">Name</a>
  <a id="1252" href="BitML.Semantics.Configurations.Helpers.html#1227" class="Function">HNᵃᶜ</a> <a id="1257" class="Symbol">.</a><a id="1258" href="Prelude.Collections.html#198" class="Field">collect</a> <a id="1266" href="BitML.Semantics.Configurations.Helpers.html#1266" class="Bound">ac</a> <a id="1269" class="Keyword">with</a> <a id="1274" href="BitML.Semantics.Configurations.Helpers.html#1266" class="Bound">ac</a>
  <a id="1279" class="Symbol">...</a> <a id="1283" class="Symbol">|</a> <a id="1285" href="BitML.Semantics.Action.html#666" class="InductiveConstructor Operator">♯▷</a> <a id="1288" href="BitML.Semantics.Configurations.Helpers.html#1288" class="Bound">ad</a>            <a id="1302" class="Symbol">=</a> <a id="1304" href="Prelude.Collections.html#198" class="Field">collect</a> <a id="1312" href="BitML.Semantics.Configurations.Helpers.html#1288" class="Bound">ad</a>
  <a id="1317" class="Symbol">...</a> <a id="1321" class="Symbol">|</a> <a id="1323" href="BitML.Semantics.Configurations.Helpers.html#1323" class="Bound">x</a> <a id="1325" href="BitML.Semantics.Action.html#729" class="InductiveConstructor Operator">▷ˢ</a> <a id="1328" href="BitML.Semantics.Configurations.Helpers.html#1328" class="Bound">ad</a>          <a id="1340" class="Symbol">=</a> <a id="1342" href="Data.Sum.Base.html#778" class="InductiveConstructor">inj₁</a> <a id="1347" href="BitML.Semantics.Configurations.Helpers.html#1323" class="Bound">x</a> <a id="1349" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1351" href="Prelude.Collections.html#198" class="Field">collect</a> <a id="1359" href="BitML.Semantics.Configurations.Helpers.html#1328" class="Bound">ad</a>
  <a id="1364" class="Symbol">...</a> <a id="1368" class="Symbol">|</a> <a id="1370" href="BitML.Semantics.Configurations.Helpers.html#1370" class="Bound">x</a> <a id="1372" href="BitML.Semantics.Action.html#784" class="InductiveConstructor Operator">▷</a> <a id="1374" href="BitML.Semantics.Configurations.Helpers.html#1374" class="Bound">c</a>            <a id="1387" class="Symbol">=</a> <a id="1389" href="Data.Sum.Base.html#778" class="InductiveConstructor">inj₁</a> <a id="1394" href="BitML.Semantics.Configurations.Helpers.html#1370" class="Bound">x</a> <a id="1396" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1398" href="Prelude.Collections.html#198" class="Field">collect</a> <a id="1406" href="BitML.Semantics.Configurations.Helpers.html#1374" class="Bound">c</a>
  <a id="1410" class="Symbol">...</a> <a id="1414" class="Symbol">|</a> <a id="1416" href="BitML.Semantics.Configurations.Helpers.html#1416" class="Bound">x</a> <a id="1418" href="BitML.Semantics.Action.html#835" class="InductiveConstructor Operator">↔</a> <a id="1420" href="BitML.Semantics.Configurations.Helpers.html#1420" class="Bound">y</a> <a id="1422" href="BitML.Semantics.Action.html#835" class="InductiveConstructor Operator">▷⟨</a> <a id="1425" class="Symbol">_</a> <a id="1427" href="BitML.Semantics.Action.html#835" class="InductiveConstructor Operator">,</a> <a id="1429" class="Symbol">_</a> <a id="1431" href="BitML.Semantics.Action.html#835" class="InductiveConstructor Operator">⟩</a> <a id="1433" class="Symbol">=</a> <a id="1435" href="Data.List.Base.html#1497" class="Function">map</a> <a id="1439" href="Data.Sum.Base.html#778" class="InductiveConstructor">inj₁</a> <a id="1444" href="Prelude.Nary.html#161" class="Function Operator">⟦</a> <a id="1446" href="BitML.Semantics.Configurations.Helpers.html#1416" class="Bound">x</a> <a id="1448" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1450" href="BitML.Semantics.Configurations.Helpers.html#1420" class="Bound">y</a> <a id="1452" href="Prelude.Nary.html#161" class="Function Operator">⟧</a>
  <a id="1456" class="Symbol">...</a> <a id="1460" class="Symbol">|</a> <a id="1462" href="BitML.Semantics.Configurations.Helpers.html#1462" class="Bound">x</a> <a id="1464" href="BitML.Semantics.Action.html#911" class="InductiveConstructor Operator">▷⟨</a> <a id="1467" class="Symbol">_</a> <a id="1469" href="BitML.Semantics.Action.html#911" class="InductiveConstructor Operator">,</a> <a id="1471" class="Symbol">_</a> <a id="1473" href="BitML.Semantics.Action.html#911" class="InductiveConstructor Operator">,</a> <a id="1475" class="Symbol">_</a> <a id="1477" href="BitML.Semantics.Action.html#911" class="InductiveConstructor Operator">⟩</a> <a id="1479" class="Symbol">=</a> <a id="1481" href="Data.List.Base.html#4458" class="Function Operator">[</a> <a id="1483" href="Data.Sum.Base.html#778" class="InductiveConstructor">inj₁</a> <a id="1488" href="BitML.Semantics.Configurations.Helpers.html#1462" class="Bound">x</a> <a id="1490" href="Data.List.Base.html#4458" class="Function Operator">]</a>
  <a id="1494" class="Symbol">...</a> <a id="1498" class="Symbol">|</a> <a id="1500" href="BitML.Semantics.Configurations.Helpers.html#1500" class="Bound">x</a> <a id="1502" href="BitML.Semantics.Action.html#1003" class="InductiveConstructor Operator">▷ᵈ</a> <a id="1505" class="Symbol">_</a>           <a id="1517" class="Symbol">=</a> <a id="1519" href="Data.List.Base.html#4458" class="Function Operator">[</a> <a id="1521" href="Data.Sum.Base.html#778" class="InductiveConstructor">inj₁</a> <a id="1526" href="BitML.Semantics.Configurations.Helpers.html#1500" class="Bound">x</a> <a id="1528" href="Data.List.Base.html#4458" class="Function Operator">]</a>
  <a id="1532" class="Symbol">...</a> <a id="1536" class="Symbol">|</a> <a id="1538" href="BitML.Semantics.Configurations.Helpers.html#1538" class="Bound">xs</a> <a id="1541" href="BitML.Semantics.Action.html#1081" class="InductiveConstructor Operator">,</a> <a id="1543" class="Symbol">_</a> <a id="1545" href="BitML.Semantics.Action.html#1081" class="InductiveConstructor Operator">▷ᵈˢ</a> <a id="1549" href="BitML.Semantics.Configurations.Helpers.html#1549" class="Bound">x</a>     <a id="1555" class="Symbol">=</a> <a id="1557" href="Data.List.Base.html#1497" class="Function">map</a> <a id="1561" href="Data.Sum.Base.html#778" class="InductiveConstructor">inj₁</a> <a id="1566" class="Symbol">(</a><a id="1567" href="BitML.Semantics.Configurations.Helpers.html#1549" class="Bound">x</a> <a id="1569" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1571" href="BitML.Semantics.Configurations.Helpers.html#1538" class="Bound">xs</a><a id="1573" class="Symbol">)</a>

  <a id="HDᶜᶠ"></a><a id="1578" href="BitML.Semantics.Configurations.Helpers.html#1578" class="Function">HDᶜᶠ</a> <a id="1583" class="Symbol">:</a> <a id="1585" href="BitML.Semantics.Configurations.Types.html#599" class="Datatype">Configuration</a> <a id="1599" href="Prelude.Collections.html#148" class="Record Operator">has</a> <a id="1603" href="BitML.Contracts.Types.html#2776" class="Function">DepositRef</a>
  <a id="1616" href="BitML.Semantics.Configurations.Helpers.html#1578" class="Function">HDᶜᶠ</a> <a id="1621" class="Symbol">.</a><a id="1622" href="Prelude.Collections.html#198" class="Field">collect</a> <a id="1630" href="BitML.Semantics.Configurations.Helpers.html#1630" class="Bound">cf</a> <a id="1633" class="Keyword">with</a> <a id="1638" href="BitML.Semantics.Configurations.Helpers.html#1630" class="Bound">cf</a>
  <a id="1643" class="Symbol">...</a> <a id="1647" class="Symbol">|</a> <a id="1649" href="BitML.Semantics.Configurations.Types.html#842" class="InductiveConstructor Operator">⟨</a> <a id="1651" href="BitML.Semantics.Configurations.Helpers.html#1651" class="Bound">A</a> <a id="1653" href="BitML.Semantics.Configurations.Types.html#842" class="InductiveConstructor Operator">has</a> <a id="1657" href="BitML.Semantics.Configurations.Helpers.html#1657" class="Bound">v</a> <a id="1659" href="BitML.Semantics.Configurations.Types.html#842" class="InductiveConstructor Operator">⟩at</a> <a id="1663" href="BitML.Semantics.Configurations.Helpers.html#1663" class="Bound">x</a> <a id="1665" class="Symbol">=</a> <a id="1667" href="Data.List.Base.html#4458" class="Function Operator">[</a> <a id="1669" href="BitML.Semantics.Configurations.Helpers.html#1651" class="Bound">A</a> <a id="1671" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1673" href="BitML.Semantics.Configurations.Helpers.html#1657" class="Bound">v</a> <a id="1675" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1677" href="BitML.Semantics.Configurations.Helpers.html#1663" class="Bound">x</a> <a id="1679" href="Data.List.Base.html#4458" class="Function Operator">]</a>
  <a id="1683" class="Symbol">...</a> <a id="1687" class="Symbol">|</a> <a id="1689" href="BitML.Semantics.Configurations.Helpers.html#1689" class="Bound">l</a> <a id="1691" href="BitML.Semantics.Configurations.Types.html#1171" class="InductiveConstructor Operator">∣</a> <a id="1693" href="BitML.Semantics.Configurations.Helpers.html#1693" class="Bound">r</a>           <a id="1705" class="Symbol">=</a> <a id="1707" href="Prelude.Collections.html#198" class="Field">collect</a> <a id="1715" href="BitML.Semantics.Configurations.Helpers.html#1689" class="Bound">l</a> <a id="1717" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="1720" href="Prelude.Collections.html#198" class="Field">collect</a> <a id="1728" href="BitML.Semantics.Configurations.Helpers.html#1693" class="Bound">r</a>
  <a id="1732" class="CatchallClause Symbol">...</a><a id="1735" class="CatchallClause"> </a><a id="1736" class="CatchallClause Symbol">|</a><a id="1737" class="CatchallClause"> </a><a id="1738" class="CatchallClause Symbol">_</a>               <a id="1754" class="Symbol">=</a> <a id="1756" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>

  <a id="HNᶜᶠ"></a><a id="1762" href="BitML.Semantics.Configurations.Helpers.html#1762" class="Function">HNᶜᶠ</a> <a id="1767" class="Symbol">:</a> <a id="1769" href="BitML.Semantics.Configurations.Types.html#599" class="Datatype">Configuration</a> <a id="1783" href="Prelude.Collections.html#148" class="Record Operator">has</a> <a id="1787" href="BitML.BasicTypes.html#333" class="Function">Name</a>
  <a id="1794" href="BitML.Semantics.Configurations.Helpers.html#1762" class="Function">HNᶜᶠ</a> <a id="1799" class="Symbol">.</a><a id="1800" href="Prelude.Collections.html#198" class="Field">collect</a> <a id="1808" href="BitML.Semantics.Configurations.Helpers.html#1808" class="Bound">c</a> <a id="1810" class="Keyword">with</a> <a id="1815" href="BitML.Semantics.Configurations.Helpers.html#1808" class="Bound">c</a>
  <a id="1819" class="Symbol">...</a> <a id="1823" class="Symbol">|</a> <a id="1825" href="BitML.Semantics.Configurations.Types.html#639" class="InductiveConstructor">∅ᶜ</a>              <a id="1841" class="Symbol">=</a> <a id="1843" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="1848" class="Symbol">...</a> <a id="1852" class="Symbol">|</a> <a id="1854" href="BitML.Semantics.Configurations.Types.html#689" class="InductiveConstructor Operator">`</a> <a id="1856" href="BitML.Semantics.Configurations.Helpers.html#1856" class="Bound">ad</a>            <a id="1870" class="Symbol">=</a> <a id="1872" href="Prelude.Collections.html#198" class="Field">collect</a> <a id="1880" href="BitML.Semantics.Configurations.Helpers.html#1856" class="Bound">ad</a>
  <a id="1885" class="Symbol">...</a> <a id="1889" class="Symbol">|</a> <a id="1891" href="BitML.Semantics.Configurations.Types.html#748" class="InductiveConstructor Operator">⟨</a> <a id="1893" href="BitML.Semantics.Configurations.Helpers.html#1893" class="Bound">cs</a> <a id="1896" href="BitML.Semantics.Configurations.Types.html#748" class="InductiveConstructor Operator">,</a> <a id="1898" class="Symbol">_</a> <a id="1900" href="BitML.Semantics.Configurations.Types.html#748" class="InductiveConstructor Operator">⟩at</a> <a id="1904" href="BitML.Semantics.Configurations.Helpers.html#1904" class="Bound">x</a>  <a id="1907" class="Symbol">=</a> <a id="1909" href="Data.Sum.Base.html#803" class="InductiveConstructor">inj₂</a> <a id="1914" href="BitML.Semantics.Configurations.Helpers.html#1904" class="Bound">x</a> <a id="1916" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1918" href="Prelude.Collections.html#198" class="Field">collect</a> <a id="1926" href="BitML.Semantics.Configurations.Helpers.html#1893" class="Bound">cs</a>
  <a id="1931" class="Symbol">...</a> <a id="1935" class="Symbol">|</a> <a id="1937" href="BitML.Semantics.Configurations.Types.html#842" class="InductiveConstructor Operator">⟨</a> <a id="1939" class="Symbol">_</a> <a id="1941" href="BitML.Semantics.Configurations.Types.html#842" class="InductiveConstructor Operator">has</a> <a id="1945" class="Symbol">_</a> <a id="1947" href="BitML.Semantics.Configurations.Types.html#842" class="InductiveConstructor Operator">⟩at</a> <a id="1951" href="BitML.Semantics.Configurations.Helpers.html#1951" class="Bound">x</a> <a id="1953" class="Symbol">=</a> <a id="1955" href="Data.List.Base.html#4458" class="Function Operator">[</a> <a id="1957" href="Data.Sum.Base.html#803" class="InductiveConstructor">inj₂</a> <a id="1962" href="BitML.Semantics.Configurations.Helpers.html#1951" class="Bound">x</a> <a id="1964" href="Data.List.Base.html#4458" class="Function Operator">]</a>
  <a id="1968" class="Symbol">...</a> <a id="1972" class="Symbol">|</a> <a id="1974" class="Symbol">_</a> <a id="1976" href="BitML.Semantics.Configurations.Types.html#939" class="InductiveConstructor Operator">auth[</a> <a id="1982" href="BitML.Semantics.Configurations.Helpers.html#1982" class="Bound">ac</a> <a id="1985" href="BitML.Semantics.Configurations.Types.html#939" class="InductiveConstructor Operator">]</a>    <a id="1990" class="Symbol">=</a> <a id="1992" href="Prelude.Collections.html#198" class="Field">collect</a> <a id="2000" href="BitML.Semantics.Configurations.Helpers.html#1982" class="Bound">ac</a>
  <a id="2005" class="Symbol">...</a> <a id="2009" class="Symbol">|</a> <a id="2011" href="BitML.Semantics.Configurations.Types.html#1012" class="InductiveConstructor Operator">⟨</a> <a id="2013" class="Symbol">_</a> <a id="2015" href="BitML.Semantics.Configurations.Types.html#1012" class="InductiveConstructor Operator">∶</a> <a id="2017" href="BitML.Semantics.Configurations.Helpers.html#2017" class="Bound">s</a> <a id="2019" href="BitML.Semantics.Configurations.Types.html#1012" class="InductiveConstructor Operator">♯</a> <a id="2021" class="Symbol">_</a> <a id="2023" href="BitML.Semantics.Configurations.Types.html#1012" class="InductiveConstructor Operator">⟩</a>   <a id="2027" class="Symbol">=</a> <a id="2029" href="Data.List.Base.html#4458" class="Function Operator">[</a> <a id="2031" href="Data.Sum.Base.html#778" class="InductiveConstructor">inj₁</a> <a id="2036" href="BitML.Semantics.Configurations.Helpers.html#2017" class="Bound">s</a> <a id="2038" href="Data.List.Base.html#4458" class="Function Operator">]</a>
  <a id="2042" class="Symbol">...</a> <a id="2046" class="Symbol">|</a> <a id="2048" class="Symbol">_</a> <a id="2050" href="BitML.Semantics.Configurations.Types.html#1093" class="InductiveConstructor Operator">∶</a> <a id="2052" href="BitML.Semantics.Configurations.Helpers.html#2052" class="Bound">s</a> <a id="2054" href="BitML.Semantics.Configurations.Types.html#1093" class="InductiveConstructor Operator">♯</a> <a id="2056" class="Symbol">_</a>       <a id="2064" class="Symbol">=</a> <a id="2066" href="Data.List.Base.html#4458" class="Function Operator">[</a> <a id="2068" href="Data.Sum.Base.html#778" class="InductiveConstructor">inj₁</a> <a id="2073" href="BitML.Semantics.Configurations.Helpers.html#2052" class="Bound">s</a> <a id="2075" href="Data.List.Base.html#4458" class="Function Operator">]</a>
  <a id="2079" class="Symbol">...</a> <a id="2083" class="Symbol">|</a> <a id="2085" href="BitML.Semantics.Configurations.Helpers.html#2085" class="Bound">l</a> <a id="2087" href="BitML.Semantics.Configurations.Types.html#1171" class="InductiveConstructor Operator">∣</a> <a id="2089" href="BitML.Semantics.Configurations.Helpers.html#2089" class="Bound">r</a>           <a id="2101" class="Symbol">=</a> <a id="2103" href="Prelude.Collections.html#198" class="Field">collect</a> <a id="2111" href="BitML.Semantics.Configurations.Helpers.html#2085" class="Bound">l</a> <a id="2113" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="2116" href="Prelude.Collections.html#198" class="Field">collect</a> <a id="2124" href="BitML.Semantics.Configurations.Helpers.html#2089" class="Bound">r</a>

  <a id="HNᵗᶜᶠ"></a><a id="2129" href="BitML.Semantics.Configurations.Helpers.html#2129" class="Function">HNᵗᶜᶠ</a> <a id="2135" class="Symbol">:</a> <a id="2137" href="BitML.Semantics.Configurations.Types.html#1467" class="Record">TimedConfiguration</a> <a id="2156" href="Prelude.Collections.html#148" class="Record Operator">has</a> <a id="2160" href="BitML.BasicTypes.html#333" class="Function">Name</a>
  <a id="2167" href="BitML.Semantics.Configurations.Helpers.html#2129" class="Function">HNᵗᶜᶠ</a> <a id="2173" class="Symbol">.</a><a id="2174" href="Prelude.Collections.html#198" class="Field">collect</a> <a id="2182" class="Symbol">(</a><a id="2183" href="BitML.Semantics.Configurations.Helpers.html#2183" class="Bound">Γ</a> <a id="2185" href="BitML.Semantics.Configurations.Types.html#1512" class="InductiveConstructor Operator">at</a> <a id="2188" class="Symbol">_)</a> <a id="2191" class="Symbol">=</a> <a id="2193" href="Prelude.Collections.html#198" class="Field">collect</a> <a id="2201" href="BitML.Semantics.Configurations.Helpers.html#2183" class="Bound">Γ</a>

<a id="secretsOfᶜᶠ"></a><a id="2204" href="BitML.Semantics.Configurations.Helpers.html#2204" class="Function">secretsOfᶜᶠ</a> <a id="2216" class="Symbol">:</a> <a id="2218" href="BitML.Semantics.Configurations.Helpers.html#468" class="Bound">Participant</a> <a id="2230" class="Symbol">→</a> <a id="2232" href="BitML.Semantics.Configurations.Types.html#599" class="Datatype">Configuration</a> <a id="2246" class="Symbol">→</a> <a id="2248" href="BitML.BasicTypes.html#278" class="Function">Secrets</a>
<a id="2256" href="BitML.Semantics.Configurations.Helpers.html#2204" class="Function">secretsOfᶜᶠ</a> <a id="2268" href="BitML.Semantics.Configurations.Helpers.html#2268" class="Bound">A</a> <a id="2270" class="Symbol">=</a> <a id="2272" class="Comment">{- Set&#39;.nub ∘-}</a> <a id="2288" href="BitML.Semantics.Configurations.Helpers.html#2303" class="Function">go</a>
  <a id="2293" class="Keyword">where</a>
    <a id="2303" href="BitML.Semantics.Configurations.Helpers.html#2303" class="Function">go</a> <a id="2306" class="Symbol">:</a> <a id="2308" href="BitML.Semantics.Configurations.Types.html#599" class="Datatype">Configuration</a> <a id="2322" class="Symbol">→</a> <a id="2324" href="BitML.BasicTypes.html#278" class="Function">Secrets</a>
    <a id="2336" href="BitML.Semantics.Configurations.Helpers.html#2303" class="Function">go</a> <a id="2339" class="Symbol">(</a><a id="2340" href="BitML.Semantics.Configurations.Types.html#1012" class="InductiveConstructor Operator">⟨</a> <a id="2342" href="BitML.Semantics.Configurations.Helpers.html#2342" class="Bound">B</a> <a id="2344" href="BitML.Semantics.Configurations.Types.html#1012" class="InductiveConstructor Operator">∶</a> <a id="2346" href="BitML.Semantics.Configurations.Helpers.html#2346" class="Bound">a</a> <a id="2348" href="BitML.Semantics.Configurations.Types.html#1012" class="InductiveConstructor Operator">♯</a> <a id="2350" class="Symbol">_</a> <a id="2352" href="BitML.Semantics.Configurations.Types.html#1012" class="InductiveConstructor Operator">⟩</a><a id="2353" class="Symbol">)</a> <a id="2355" class="Symbol">=</a> <a id="2357" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2360" href="BitML.Semantics.Configurations.Helpers.html#2268" class="Bound">A</a> <a id="2362" href="Prelude.DecEq.html#633" class="Function Operator">==</a> <a id="2365" href="BitML.Semantics.Configurations.Helpers.html#2342" class="Bound">B</a> <a id="2367" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="2372" href="Data.List.Base.html#4458" class="Function Operator">[</a> <a id="2374" href="BitML.Semantics.Configurations.Helpers.html#2346" class="Bound">a</a> <a id="2376" href="Data.List.Base.html#4458" class="Function Operator">]</a> <a id="2378" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="2383" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="2390" href="BitML.Semantics.Configurations.Helpers.html#2303" class="Function">go</a> <a id="2393" class="Symbol">(</a><a id="2394" href="BitML.Semantics.Configurations.Helpers.html#2394" class="Bound">l</a> <a id="2396" href="BitML.Semantics.Configurations.Types.html#1171" class="InductiveConstructor Operator">∣</a> <a id="2398" href="BitML.Semantics.Configurations.Helpers.html#2398" class="Bound">r</a><a id="2399" class="Symbol">)</a>         <a id="2409" class="Symbol">=</a> <a id="2411" href="BitML.Semantics.Configurations.Helpers.html#2303" class="Function">go</a> <a id="2414" href="BitML.Semantics.Configurations.Helpers.html#2394" class="Bound">l</a> <a id="2416" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="2419" href="BitML.Semantics.Configurations.Helpers.html#2303" class="Function">go</a> <a id="2422" href="BitML.Semantics.Configurations.Helpers.html#2398" class="Bound">r</a>
    <a id="2428" href="BitML.Semantics.Configurations.Helpers.html#2303" class="CatchallClause Function">go</a><a id="2430" class="CatchallClause"> </a><a id="2431" class="CatchallClause Symbol">_</a>               <a id="2447" class="Symbol">=</a> <a id="2449" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>

<a id="committedParticipants"></a><a id="2453" href="BitML.Semantics.Configurations.Helpers.html#2453" class="Function">committedParticipants</a> <a id="2475" class="Symbol">:</a> <a id="2477" href="BitML.Semantics.Configurations.Types.html#599" class="Datatype">Configuration</a> <a id="2491" class="Symbol">→</a> <a id="2493" href="BitML.Contracts.Types.html#2308" class="Record">Advertisement</a> <a id="2507" class="Symbol">→</a> <a id="2509" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2514" href="BitML.Semantics.Configurations.Helpers.html#468" class="Bound">Participant</a>
<a id="2526" href="BitML.Semantics.Configurations.Helpers.html#2453" class="Function">committedParticipants</a> <a id="2548" class="Symbol">(</a><a id="2549" href="BitML.Semantics.Configurations.Helpers.html#2549" class="Bound">p</a> <a id="2551" href="BitML.Semantics.Configurations.Types.html#939" class="InductiveConstructor Operator">auth[</a> <a id="2557" class="Symbol">(</a><a id="2558" href="BitML.Semantics.Action.html#666" class="InductiveConstructor Operator">♯▷</a> <a id="2561" href="BitML.Semantics.Configurations.Helpers.html#2561" class="Bound">ad′</a><a id="2564" class="Symbol">)</a> <a id="2566" href="BitML.Semantics.Configurations.Types.html#939" class="InductiveConstructor Operator">]</a><a id="2567" class="Symbol">)</a> <a id="2569" href="BitML.Semantics.Configurations.Helpers.html#2569" class="Bound">ad</a> <a id="2572" class="Symbol">=</a> <a id="2574" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2577" href="BitML.Semantics.Configurations.Helpers.html#2569" class="Bound">ad</a> <a id="2580" href="Prelude.DecEq.html#633" class="Function Operator">==</a> <a id="2583" href="BitML.Semantics.Configurations.Helpers.html#2561" class="Bound">ad′</a> <a id="2587" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="2592" href="Data.List.Base.html#4458" class="Function Operator">[</a> <a id="2594" href="BitML.Semantics.Configurations.Helpers.html#2549" class="Bound">p</a> <a id="2596" href="Data.List.Base.html#4458" class="Function Operator">]</a> <a id="2598" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="2603" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
<a id="2606" href="BitML.Semantics.Configurations.Helpers.html#2453" class="Function">committedParticipants</a> <a id="2628" class="Symbol">(</a><a id="2629" href="BitML.Semantics.Configurations.Helpers.html#2629" class="Bound">l</a> <a id="2631" href="BitML.Semantics.Configurations.Types.html#1171" class="InductiveConstructor Operator">∣</a> <a id="2633" href="BitML.Semantics.Configurations.Helpers.html#2633" class="Bound">r</a><a id="2634" class="Symbol">)</a> <a id="2636" href="BitML.Semantics.Configurations.Helpers.html#2636" class="Bound">ad</a> <a id="2639" class="Symbol">=</a> <a id="2641" href="BitML.Semantics.Configurations.Helpers.html#2453" class="Function">committedParticipants</a> <a id="2663" href="BitML.Semantics.Configurations.Helpers.html#2629" class="Bound">l</a> <a id="2665" href="BitML.Semantics.Configurations.Helpers.html#2636" class="Bound">ad</a> <a id="2668" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="2671" href="BitML.Semantics.Configurations.Helpers.html#2453" class="Function">committedParticipants</a> <a id="2693" href="BitML.Semantics.Configurations.Helpers.html#2633" class="Bound">r</a> <a id="2695" href="BitML.Semantics.Configurations.Helpers.html#2636" class="Bound">ad</a>
<a id="2698" href="BitML.Semantics.Configurations.Helpers.html#2453" class="CatchallClause Function">committedParticipants</a><a id="2719" class="CatchallClause"> </a><a id="2720" class="CatchallClause Symbol">_</a><a id="2721" class="CatchallClause">       </a><a id="2728" class="CatchallClause Symbol">_</a>  <a id="2731" class="Symbol">=</a> <a id="2733" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>

<a id="isInitial"></a><a id="2737" href="BitML.Semantics.Configurations.Helpers.html#2737" class="Function">isInitial</a> <a id="2747" class="Symbol">:</a> <a id="2749" href="BitML.Semantics.Configurations.Types.html#599" class="Datatype">Configuration</a> <a id="2763" class="Symbol">→</a> <a id="2765" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="2770" href="BitML.Semantics.Configurations.Helpers.html#2737" class="Function">isInitial</a> <a id="2780" class="Symbol">(</a><a id="2781" href="BitML.Semantics.Configurations.Types.html#842" class="InductiveConstructor Operator">⟨</a> <a id="2783" class="Symbol">_</a> <a id="2785" href="BitML.Semantics.Configurations.Types.html#842" class="InductiveConstructor Operator">has</a> <a id="2789" class="Symbol">_</a> <a id="2791" href="BitML.Semantics.Configurations.Types.html#842" class="InductiveConstructor Operator">⟩at</a> <a id="2795" class="Symbol">_)</a> <a id="2798" class="Symbol">=</a> <a id="2800" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
<a id="2805" href="BitML.Semantics.Configurations.Helpers.html#2737" class="Function">isInitial</a> <a id="2815" class="Symbol">(</a><a id="2816" href="BitML.Semantics.Configurations.Helpers.html#2816" class="Bound">l</a> <a id="2818" href="BitML.Semantics.Configurations.Types.html#1171" class="InductiveConstructor Operator">∣</a> <a id="2820" href="BitML.Semantics.Configurations.Helpers.html#2820" class="Bound">r</a><a id="2821" class="Symbol">)</a>           <a id="2833" class="Symbol">=</a> <a id="2835" href="BitML.Semantics.Configurations.Helpers.html#2737" class="Function">isInitial</a> <a id="2845" href="BitML.Semantics.Configurations.Helpers.html#2816" class="Bound">l</a> <a id="2847" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="2849" href="BitML.Semantics.Configurations.Helpers.html#2737" class="Function">isInitial</a> <a id="2859" href="BitML.Semantics.Configurations.Helpers.html#2820" class="Bound">r</a>
<a id="2861" href="BitML.Semantics.Configurations.Helpers.html#2737" class="CatchallClause Function">isInitial</a><a id="2870" class="CatchallClause"> </a><a id="2871" class="CatchallClause Symbol">_</a>                 <a id="2889" class="Symbol">=</a> <a id="2891" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>

<a id="Initial"></a><a id="2898" href="BitML.Semantics.Configurations.Helpers.html#2898" class="Function">Initial</a> <a id="2906" class="Symbol">:</a> <a id="2908" href="BitML.Semantics.Configurations.Types.html#599" class="Datatype">Configuration</a> <a id="2922" class="Symbol">→</a> <a id="2924" class="PrimitiveType">Set</a>
<a id="2928" href="BitML.Semantics.Configurations.Helpers.html#2898" class="Function">Initial</a> <a id="2936" class="Symbol">=</a> <a id="2938" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="2940" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2942" href="BitML.Semantics.Configurations.Helpers.html#2737" class="Function">isInitial</a>
</pre></body></html>