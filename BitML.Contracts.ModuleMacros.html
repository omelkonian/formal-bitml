<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>BitML.Contracts.ModuleMacros</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-bitml/tree/master///BitML/Contracts/ModuleMacros.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Module macros for working with BitML contracts.</a>
<a id="125" class="Comment">------------------------------------------------------------------------</a>
<a id="198" class="Keyword">open</a> <a id="203" class="Keyword">import</a> <a id="210" href="Prelude.Init.html" class="Module">Prelude.Init</a><a id="222" class="Symbol">;</a> <a id="224" class="Keyword">open</a> <a id="229" href="Prelude.Init.html#504" class="Module">SetAsType</a>
<a id="239" class="Keyword">open</a> <a id="244" class="Keyword">import</a> <a id="251" href="Prelude.Lists.Indexed.html" class="Module">Prelude.Lists.Indexed</a>

<a id="274" class="Keyword">open</a> <a id="279" class="Keyword">import</a> <a id="286" href="BitML.BasicTypes.html" class="Module">BitML.BasicTypes</a>
<a id="303" class="Keyword">open</a> <a id="308" class="Keyword">import</a> <a id="315" href="BitML.Predicate.html" class="Module">BitML.Predicate</a>

<a id="332" class="Keyword">module</a> <a id="339" href="BitML.Contracts.ModuleMacros.html" class="Module">BitML.Contracts.ModuleMacros</a> <a id="368" href="BitML.Contracts.ModuleMacros.html#368" class="Bound">⋯</a> <a id="370" class="Symbol">(</a><a id="371" class="Keyword">let</a> <a id="375" class="Keyword">open</a> <a id="380" href="BitML.BasicTypes.html#631" class="Module">⋯</a> <a id="382" href="BitML.Contracts.ModuleMacros.html#368" class="Bound">⋯</a><a id="383" class="Symbol">)</a> <a id="385" class="Keyword">where</a>

<a id="392" class="Keyword">open</a> <a id="397" class="Keyword">import</a> <a id="404" href="BitML.Contracts.Types.html" class="Module">BitML.Contracts.Types</a> <a id="426" href="BitML.Contracts.ModuleMacros.html#368" class="Bound">⋯</a> <a id="428" class="Keyword">hiding</a> <a id="435" class="Symbol">(</a><a id="436" href="BitML.Contracts.Types.html#1222" class="Generalizable">d</a><a id="437" class="Symbol">;</a> <a id="439" href="BitML.Contracts.Types.html#2351" class="Field">C</a><a id="440" class="Symbol">;</a> <a id="442" href="BitML.Contracts.Types.html#2330" class="Field">G</a><a id="443" class="Symbol">)</a>
<a id="445" class="Keyword">open</a> <a id="450" class="Keyword">import</a> <a id="457" href="BitML.Contracts.Collections.html" class="Module">BitML.Contracts.Collections</a> <a id="485" href="BitML.Contracts.ModuleMacros.html#368" class="Bound">⋯</a>

<a id="488" class="Comment">-- selecting a sub-contract and stripping decorations</a>
<a id="542" class="Keyword">module</a> <a id="∣SELECT"></a><a id="549" href="BitML.Contracts.ModuleMacros.html#549" class="Module">∣SELECT</a> <a id="557" class="Symbol">(</a><a id="558" href="BitML.Contracts.ModuleMacros.html#558" class="Bound">c</a> <a id="560" class="Symbol">:</a> <a id="562" href="BitML.Contracts.Types.html#502" class="Function">Contract</a><a id="570" class="Symbol">)</a> <a id="572" class="Symbol">(</a><a id="573" href="BitML.Contracts.ModuleMacros.html#573" class="Bound">i</a> <a id="575" class="Symbol">:</a> <a id="577" href="Prelude.Lists.Indexed.html#542" class="Function">Index</a> <a id="583" href="BitML.Contracts.ModuleMacros.html#558" class="Bound">c</a><a id="584" class="Symbol">)</a> <a id="586" class="Keyword">where</a>
  <a id="∣SELECT.d"></a><a id="594" href="BitML.Contracts.ModuleMacros.html#594" class="Function">d</a>  <a id="597" class="Symbol">=</a> <a id="599" href="BitML.Contracts.ModuleMacros.html#558" class="Bound">c</a> <a id="601" href="Prelude.Lists.Indexed.html#650" class="Function Operator">‼</a> <a id="603" href="BitML.Contracts.ModuleMacros.html#573" class="Bound">i</a>
  <a id="∣SELECT.d∗"></a><a id="607" href="BitML.Contracts.ModuleMacros.html#607" class="Function">d∗</a> <a id="610" class="Symbol">=</a> <a id="612" href="BitML.Contracts.Collections.html#13244" class="Function">removeTopDecorations</a> <a id="633" href="BitML.Contracts.ModuleMacros.html#594" class="Function">d</a>

<a id="636" class="Comment">-- opening an advertisement to get the underlying contract and preconditions,</a>
<a id="714" class="Comment">-- as well as the involved participants</a>
<a id="754" class="Keyword">module</a> <a id="∣AD"></a><a id="761" href="BitML.Contracts.ModuleMacros.html#761" class="Module">∣AD</a> <a id="765" class="Symbol">(</a><a id="766" href="BitML.Contracts.ModuleMacros.html#766" class="Bound">ad</a> <a id="769" class="Symbol">:</a> <a id="771" href="BitML.Contracts.Types.html#2283" class="Record">Ad</a><a id="773" class="Symbol">)</a> <a id="775" class="Keyword">where</a>
  <a id="∣AD.C"></a><a id="783" href="BitML.Contracts.ModuleMacros.html#783" class="Function">C</a> <a id="785" class="Symbol">=</a> <a id="787" href="BitML.Contracts.ModuleMacros.html#766" class="Bound">ad</a> <a id="790" class="Symbol">.</a><a id="791" href="BitML.Contracts.Types.html#2351" class="Field">Ad.C</a>
  <a id="∣AD.G"></a><a id="798" href="BitML.Contracts.ModuleMacros.html#798" class="Function">G</a> <a id="800" class="Symbol">=</a> <a id="802" href="BitML.Contracts.ModuleMacros.html#766" class="Bound">ad</a> <a id="805" class="Symbol">.</a><a id="806" href="BitML.Contracts.Types.html#2330" class="Field">Ad.G</a>
  <a id="∣AD.partG"></a><a id="813" href="BitML.Contracts.ModuleMacros.html#813" class="Function">partG</a> <a id="819" class="Symbol">=</a> <a id="821" href="BitML.Contracts.Collections.html#2548" class="Function">nub-participants</a> <a id="838" href="BitML.Contracts.ModuleMacros.html#798" class="Function">G</a>
</pre></body></html>