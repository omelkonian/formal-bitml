<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Semantics.Actions.Types</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Types of actions.</a>
<a id="95" class="Comment">------------------------------------------------------------------------</a>

<a id="169" class="Keyword">open</a> <a id="174" class="Keyword">import</a> <a id="181" href="Level.html" class="Module">Level</a>        <a id="194" class="Keyword">using</a> <a id="200" class="Symbol">(</a><a id="201" href="Level.html#506" class="Function">0ℓ</a><a id="203" class="Symbol">)</a>
<a id="205" class="Keyword">open</a> <a id="210" class="Keyword">import</a> <a id="217" href="Data.Nat.html" class="Module">Data.Nat</a>     <a id="230" class="Keyword">using</a> <a id="236" class="Symbol">(</a><a id="237" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a><a id="238" class="Symbol">;</a> <a id="240" href="Data.Nat.Properties.html#2208" class="Function Operator">_≟_</a><a id="243" class="Symbol">;</a> <a id="245" href="Data.Nat.Base.html#1140" class="Function Operator">_&gt;_</a><a id="248" class="Symbol">;</a> <a id="250" href="Agda.Builtin.Nat.html#298" class="Primitive Operator">_+_</a><a id="253" class="Symbol">)</a>
<a id="255" class="Keyword">open</a> <a id="260" class="Keyword">import</a> <a id="267" href="Data.Product.html" class="Module">Data.Product</a> <a id="280" class="Keyword">using</a> <a id="286" class="Symbol">(</a><a id="287" href="Data.Product.html#1364" class="Function">∃</a><a id="288" class="Symbol">;</a> <a id="290" href="Data.Product.html#1783" class="Function">∃-syntax</a><a id="298" class="Symbol">;</a> <a id="300" href="Agda.Builtin.Sigma.html#139" class="Record">Σ</a><a id="301" class="Symbol">;</a> <a id="303" href="Data.Product.html#911" class="Function">Σ-syntax</a><a id="311" class="Symbol">;</a> <a id="313" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">_,_</a><a id="316" class="Symbol">)</a>
<a id="318" class="Keyword">open</a> <a id="323" class="Keyword">import</a> <a id="330" href="Data.List.html" class="Module">Data.List</a>    <a id="343" class="Keyword">using</a> <a id="349" class="Symbol">(</a><a id="350" href="Agda.Builtin.List.html#121" class="Datatype">List</a><a id="354" class="Symbol">;</a> <a id="356" href="Data.List.Base.html#8786" class="InductiveConstructor">[]</a><a id="358" class="Symbol">;</a> <a id="360" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">_∷_</a><a id="363" class="Symbol">;</a> <a id="365" href="Data.List.Base.html#4265" class="Function Operator">[_]</a><a id="368" class="Symbol">;</a> <a id="370" href="Data.List.Base.html#1570" class="Function Operator">_++_</a><a id="374" class="Symbol">;</a> <a id="376" href="Data.List.Base.html#1304" class="Function">map</a><a id="379" class="Symbol">;</a> <a id="381" href="Data.List.Base.html#4104" class="Function">length</a><a id="387" class="Symbol">)</a>
<a id="389" class="Keyword">open</a> <a id="394" class="Keyword">import</a> <a id="401" href="Data.Fin.html" class="Module">Data.Fin</a>     <a id="414" class="Keyword">using</a> <a id="420" class="Symbol">()</a>
  <a id="425" class="Keyword">renaming</a> <a id="434" class="Symbol">(</a><a id="435" href="Data.Fin.Properties.html#1730" class="Function Operator">_≟_</a> <a id="439" class="Symbol">to</a> <a id="442" href="Data.Fin.Properties.html#1730" class="Function Operator">_≟ᶠ_</a><a id="446" class="Symbol">)</a>

<a id="449" class="Keyword">open</a> <a id="454" class="Keyword">import</a> <a id="461" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>                      <a id="499" class="Keyword">using</a> <a id="505" class="Symbol">(</a><a id="506" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a><a id="509" class="Symbol">;</a> <a id="511" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a><a id="513" class="Symbol">)</a>
<a id="515" class="Keyword">open</a> <a id="520" class="Keyword">import</a> <a id="527" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>            <a id="565" class="Keyword">using</a> <a id="571" class="Symbol">(</a><a id="572" href="Relation.Nullary.Decidable.html#1210" class="Function">True</a><a id="576" class="Symbol">;</a> <a id="578" href="Relation.Nullary.Decidable.html#1247" class="Function">False</a><a id="583" class="Symbol">;</a> <a id="585" href="Relation.Nullary.Decidable.html#1441" class="Function">fromWitness</a><a id="596" class="Symbol">)</a>
<a id="598" class="Keyword">open</a> <a id="603" class="Keyword">import</a> <a id="610" href="Relation.Binary.html" class="Module">Relation.Binary</a>                       <a id="648" class="Keyword">using</a> <a id="654" class="Symbol">(</a><a id="655" href="Relation.Binary.Core.html#5557" class="Function">Decidable</a><a id="664" class="Symbol">)</a>
<a id="666" class="Keyword">open</a> <a id="671" class="Keyword">import</a> <a id="678" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="716" class="Keyword">using</a> <a id="722" class="Symbol">(</a><a id="723" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">_≡_</a><a id="726" class="Symbol">;</a> <a id="728" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="732" class="Symbol">)</a>

<a id="735" class="Keyword">open</a> <a id="740" class="Keyword">import</a> <a id="747" href="Category.Functor.html" class="Module">Category.Functor</a> <a id="764" class="Keyword">using</a> <a id="770" class="Symbol">(</a><a id="771" href="Category.Functor.html#421" class="Record">RawFunctor</a><a id="781" class="Symbol">)</a>
<a id="783" class="Keyword">open</a> <a id="788" class="Keyword">import</a> <a id="795" href="Data.List.Categorical.html" class="Module">Data.List.Categorical</a> <a id="817" class="Keyword">renaming</a> <a id="826" class="Symbol">(</a><a id="827" href="Data.List.Categorical.html#701" class="Function">functor</a> <a id="835" class="Symbol">to</a> <a id="838" href="Data.List.Categorical.html#701" class="Function">listFunctor</a><a id="849" class="Symbol">)</a>
<a id="851" class="Keyword">open</a> <a id="856" href="Category.Functor.html#421" class="Module">RawFunctor</a> <a id="867" class="Symbol">{</a><a id="868" href="Level.html#506" class="Function">0ℓ</a><a id="870" class="Symbol">}</a> <a id="872" href="Data.List.Categorical.html#701" class="Function">listFunctor</a> <a id="884" class="Keyword">using</a> <a id="890" class="Symbol">(</a>_&lt;$&gt;_<a id="896" class="Symbol">)</a>

<a id="899" class="Keyword">module</a> <a id="906" href="Semantics.Actions.Types.html" class="Module">Semantics.Actions.Types</a>
  <a id="932" class="Symbol">(</a><a id="933" href="Semantics.Actions.Types.html#933" class="Bound">Participant</a> <a id="945" class="Symbol">:</a> <a id="947" class="PrimitiveType">Set</a><a id="950" class="Symbol">)</a>
  <a id="954" class="Symbol">(</a><a id="955" href="Semantics.Actions.Types.html#955" class="Bound Operator">_≟ₚ_</a> <a id="960" class="Symbol">:</a> <a id="962" href="Relation.Binary.Core.html#5557" class="Function">Decidable</a> <a id="972" class="Symbol">{</a><a id="973" class="Argument">A</a> <a id="975" class="Symbol">=</a> <a id="977" href="Semantics.Actions.Types.html#933" class="Bound">Participant</a><a id="988" class="Symbol">}</a> <a id="990" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">_≡_</a><a id="993" class="Symbol">)</a>
  <a id="997" class="Symbol">(</a><a id="998" href="Semantics.Actions.Types.html#998" class="Bound">Honest</a> <a id="1005" class="Symbol">:</a> <a id="1007" href="Data.Product.html#911" class="Function">Σ[</a> <a id="1010" href="Semantics.Actions.Types.html#1010" class="Bound">ps</a> <a id="1013" href="Data.Product.html#911" class="Function">∈</a> <a id="1015" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="1020" href="Semantics.Actions.Types.html#933" class="Bound">Participant</a> <a id="1032" href="Data.Product.html#911" class="Function">]</a> <a id="1034" class="Symbol">(</a><a id="1035" href="Data.List.Base.html#4104" class="Function">length</a> <a id="1042" href="Semantics.Actions.Types.html#1010" class="Bound">ps</a> <a id="1045" href="Data.Nat.Base.html#1140" class="Function Operator">&gt;</a> <a id="1047" class="Number">0</a><a id="1048" class="Symbol">))</a>
  <a id="1053" class="Keyword">where</a>

<a id="1060" class="Keyword">open</a> <a id="1065" class="Keyword">import</a> <a id="1072" href="Utilities.Lists.html" class="Module">Utilities.Lists</a>

<a id="1089" class="Keyword">open</a> <a id="1094" class="Keyword">import</a> <a id="1101" href="Types.html" class="Module">Types</a>       <a id="1113" href="Semantics.Actions.Types.html#933" class="Bound">Participant</a> <a id="1125" href="Semantics.Actions.Types.html#955" class="Bound Operator">_≟ₚ_</a> <a id="1130" href="Semantics.Actions.Types.html#998" class="Bound">Honest</a>
<a id="1137" class="Keyword">open</a> <a id="1142" class="Keyword">import</a> <a id="1149" href="BitML.Types.html" class="Module">BitML.Types</a> <a id="1161" href="Semantics.Actions.Types.html#933" class="Bound">Participant</a> <a id="1173" href="Semantics.Actions.Types.html#955" class="Bound Operator">_≟ₚ_</a> <a id="1178" href="Semantics.Actions.Types.html#998" class="Bound">Honest</a>

<a id="1186" class="Comment">--------------------------------------------------------------------------------</a>

<a id="AdvertisedContracts"></a><a id="1268" href="Semantics.Actions.Types.html#1268" class="Function">AdvertisedContracts</a> <a id="1288" class="Symbol">:</a> <a id="1290" class="PrimitiveType">Set</a>
<a id="1294" href="Semantics.Actions.Types.html#1268" class="Function">AdvertisedContracts</a> <a id="1314" class="Symbol">=</a> <a id="1316" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="1321" href="BitML.Types.html#7260" class="Function">∃Advertisement</a>

<a id="ActiveContracts"></a><a id="1337" href="Semantics.Actions.Types.html#1337" class="Function">ActiveContracts</a> <a id="1353" class="Symbol">:</a> <a id="1355" class="PrimitiveType">Set</a>
<a id="1359" href="Semantics.Actions.Types.html#1337" class="Function">ActiveContracts</a> <a id="1375" class="Symbol">=</a> <a id="1377" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="1382" href="BitML.Types.html#4288" class="Function">∃Contracts</a>

<a id="1394" class="Keyword">data</a> <a id="Action"></a><a id="1399" href="Semantics.Actions.Types.html#1399" class="Datatype">Action</a> <a id="1406" class="Symbol">(</a><a id="1407" href="Semantics.Actions.Types.html#1407" class="Bound">p</a> <a id="1409" class="Symbol">:</a> <a id="1411" href="Semantics.Actions.Types.html#933" class="Bound">Participant</a><a id="1422" class="Symbol">)</a> <a id="1424" class="Comment">-- the participant that authorizes this action</a>
  <a id="1473" class="Symbol">:</a> <a id="1475" href="Semantics.Actions.Types.html#1268" class="Function">AdvertisedContracts</a> <a id="1495" class="Comment">-- the contract advertisements it requires</a>
  <a id="1540" class="Symbol">→</a> <a id="1542" href="Semantics.Actions.Types.html#1337" class="Function">ActiveContracts</a>     <a id="1562" class="Comment">-- the active contracts it requires</a>
  <a id="1600" class="Symbol">→</a> <a id="1602" href="Types.html#1191" class="Function">Values</a>              <a id="1622" class="Comment">-- the deposits it requires from this participant</a>
  <a id="1674" class="Symbol">→</a> <a id="1676" href="Types.html#2946" class="Function">Deposits</a>            <a id="1696" class="Comment">-- the deposits it produces</a>
  <a id="1726" class="Symbol">→</a> <a id="1728" class="PrimitiveType">Set</a> <a id="1732" class="Keyword">where</a>

  <a id="1741" class="Comment">-- commit secrets to stipulate {G}C</a>
  <a id="Action.♯▷_"></a><a id="1779" href="Semantics.Actions.Types.html#1779" class="InductiveConstructor Operator">♯▷_</a> <a id="1783" class="Symbol">:</a> <a id="1785" class="Symbol">∀</a> <a id="1787" class="Symbol">{</a><a id="1788" href="Semantics.Actions.Types.html#1788" class="Bound">v</a> <a id="1790" href="Semantics.Actions.Types.html#1790" class="Bound">vsᶜ</a> <a id="1794" href="Semantics.Actions.Types.html#1794" class="Bound">vsᵛ</a> <a id="1798" href="Semantics.Actions.Types.html#1798" class="Bound">vsᵖ</a><a id="1801" class="Symbol">}</a> <a id="1803" class="Symbol">→</a> <a id="1805" class="Symbol">(</a><a id="1806" href="Semantics.Actions.Types.html#1806" class="Bound">ad</a> <a id="1809" class="Symbol">:</a> <a id="1811" href="BitML.Types.html#6467" class="Record">Advertisement</a> <a id="1825" href="Semantics.Actions.Types.html#1788" class="Bound">v</a> <a id="1827" href="Semantics.Actions.Types.html#1790" class="Bound">vsᶜ</a> <a id="1831" href="Semantics.Actions.Types.html#1794" class="Bound">vsᵛ</a> <a id="1835" href="Semantics.Actions.Types.html#1798" class="Bound">vsᵖ</a><a id="1838" class="Symbol">)</a>
      <a id="1846" class="Symbol">→</a> <a id="1848" href="Semantics.Actions.Types.html#1399" class="Datatype">Action</a> <a id="1855" href="Semantics.Actions.Types.html#1407" class="Bound">p</a> <a id="1857" href="Data.List.Base.html#4265" class="Function Operator">[</a> <a id="1859" href="Semantics.Actions.Types.html#1788" class="Bound">v</a> <a id="1861" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1863" href="Semantics.Actions.Types.html#1790" class="Bound">vsᶜ</a> <a id="1867" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1869" href="Semantics.Actions.Types.html#1794" class="Bound">vsᵛ</a> <a id="1873" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1875" href="Semantics.Actions.Types.html#1798" class="Bound">vsᵖ</a> <a id="1879" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1881" href="Semantics.Actions.Types.html#1806" class="Bound">ad</a> <a id="1884" href="Data.List.Base.html#4265" class="Function Operator">]</a> <a id="1886" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="1889" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="1892" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>

  <a id="1898" class="Comment">-- spend x to stipulate {G}C</a>
  <a id="Action._▷ˢ_"></a><a id="1929" href="Semantics.Actions.Types.html#1929" class="InductiveConstructor Operator">_▷ˢ_</a> <a id="1934" class="Symbol">:</a> <a id="1936" class="Symbol">∀</a> <a id="1938" class="Symbol">{</a><a id="1939" href="Semantics.Actions.Types.html#1939" class="Bound">v</a> <a id="1941" href="Semantics.Actions.Types.html#1941" class="Bound">vsᶜ</a> <a id="1945" href="Semantics.Actions.Types.html#1945" class="Bound">vsᵛ</a> <a id="1949" href="Semantics.Actions.Types.html#1949" class="Bound">vsᵖ</a><a id="1952" class="Symbol">}</a>
       <a id="1961" class="Symbol">→</a> <a id="1963" class="Symbol">(</a><a id="1964" href="Semantics.Actions.Types.html#1964" class="Bound">ad</a> <a id="1967" class="Symbol">:</a> <a id="1969" href="BitML.Types.html#6467" class="Record">Advertisement</a> <a id="1983" href="Semantics.Actions.Types.html#1939" class="Bound">v</a> <a id="1985" href="Semantics.Actions.Types.html#1941" class="Bound">vsᶜ</a> <a id="1989" href="Semantics.Actions.Types.html#1945" class="Bound">vsᵛ</a> <a id="1993" href="Semantics.Actions.Types.html#1949" class="Bound">vsᵖ</a><a id="1996" class="Symbol">)</a>
       <a id="2005" class="Symbol">→</a> <a id="2007" class="Symbol">(</a><a id="2008" href="Semantics.Actions.Types.html#2008" class="Bound">i</a> <a id="2010" class="Symbol">:</a> <a id="2012" href="Utilities.Lists.html#1160" class="Function">Index</a> <a id="2018" href="Semantics.Actions.Types.html#1949" class="Bound">vsᵖ</a><a id="2021" class="Symbol">)</a>
       <a id="2030" class="Symbol">→</a> <a id="2032" class="Symbol">{</a><a id="2033" href="Semantics.Actions.Types.html#2033" class="Bound">vs</a> <a id="2036" class="Symbol">:</a> <a id="2038" href="Types.html#1191" class="Function">Values</a><a id="2044" class="Symbol">}</a>
       <a id="2053" class="Symbol">→</a> <a id="2055" class="Symbol">.{</a><a id="2057" href="Semantics.Actions.Types.html#2057" class="Bound">pr</a> <a id="2060" class="Symbol">:</a> <a id="2062" href="Relation.Nullary.Decidable.html#1210" class="Function">True</a> <a id="2067" class="Symbol">(</a><a id="2068" href="Semantics.Actions.Types.html#2033" class="Bound">vs</a> <a id="2071" href="Data.Set%2527.html#1897" class="Function Operator">SETₙ.≟ₗ</a> <a id="2079" href="Data.List.Base.html#4265" class="Function Operator">[</a> <a id="2081" href="Semantics.Actions.Types.html#1949" class="Bound">vsᵖ</a> <a id="2085" href="Utilities.Lists.html#1248" class="Function Operator">‼</a> <a id="2087" href="Semantics.Actions.Types.html#2008" class="Bound">i</a> <a id="2089" href="Data.List.Base.html#4265" class="Function Operator">]</a><a id="2090" class="Symbol">)}</a>
       <a id="2100" class="Symbol">→</a> <a id="2102" href="Semantics.Actions.Types.html#1399" class="Datatype">Action</a> <a id="2109" href="Semantics.Actions.Types.html#1407" class="Bound">p</a> <a id="2111" href="Data.List.Base.html#4265" class="Function Operator">[</a> <a id="2113" href="Semantics.Actions.Types.html#1939" class="Bound">v</a> <a id="2115" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2117" href="Semantics.Actions.Types.html#1941" class="Bound">vsᶜ</a> <a id="2121" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2123" href="Semantics.Actions.Types.html#1945" class="Bound">vsᵛ</a> <a id="2127" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2129" href="Semantics.Actions.Types.html#1949" class="Bound">vsᵖ</a> <a id="2133" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2135" href="Semantics.Actions.Types.html#1964" class="Bound">ad</a> <a id="2138" href="Data.List.Base.html#4265" class="Function Operator">]</a> <a id="2140" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="2143" href="Semantics.Actions.Types.html#2033" class="Bound">vs</a> <a id="2146" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>

  <a id="2152" class="Comment">-- take branch</a>
  <a id="Action._▷ᵇ_"></a><a id="2169" href="Semantics.Actions.Types.html#2169" class="InductiveConstructor Operator">_▷ᵇ_</a> <a id="2174" class="Symbol">:</a> <a id="2176" class="Symbol">∀</a> <a id="2178" class="Symbol">{</a><a id="2179" href="Semantics.Actions.Types.html#2179" class="Bound">v</a> <a id="2181" href="Semantics.Actions.Types.html#2181" class="Bound">vs</a><a id="2183" class="Symbol">}</a>
      <a id="2191" class="Symbol">→</a> <a id="2193" class="Symbol">(</a><a id="2194" href="Semantics.Actions.Types.html#2194" class="Bound">c</a> <a id="2196" class="Symbol">:</a> <a id="2198" href="BitML.Types.html#4216" class="Function">Contracts</a> <a id="2208" href="Semantics.Actions.Types.html#2179" class="Bound">v</a> <a id="2210" href="Semantics.Actions.Types.html#2181" class="Bound">vs</a><a id="2212" class="Symbol">)</a>
      <a id="2220" class="Symbol">→</a> <a id="2222" class="Symbol">(</a><a id="2223" href="Semantics.Actions.Types.html#2223" class="Bound">i</a> <a id="2225" class="Symbol">:</a> <a id="2227" href="Utilities.Lists.html#1160" class="Function">Index</a> <a id="2233" href="Semantics.Actions.Types.html#2194" class="Bound">c</a><a id="2234" class="Symbol">)</a>
      <a id="2242" class="Symbol">→</a> <a id="2244" href="Semantics.Actions.Types.html#1399" class="Datatype">Action</a> <a id="2251" href="Semantics.Actions.Types.html#1407" class="Bound">p</a> <a id="2253" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="2256" href="Data.List.Base.html#4265" class="Function Operator">[</a> <a id="2258" href="Semantics.Actions.Types.html#2179" class="Bound">v</a> <a id="2260" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2262" href="Semantics.Actions.Types.html#2181" class="Bound">vs</a> <a id="2265" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2267" href="Semantics.Actions.Types.html#2194" class="Bound">c</a> <a id="2269" href="Data.List.Base.html#4265" class="Function Operator">]</a> <a id="2271" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="2274" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>

  <a id="2280" class="Comment">-- join deposits</a>
  <a id="Action._↔_"></a><a id="2299" href="Semantics.Actions.Types.html#2299" class="InductiveConstructor Operator">_↔_</a> <a id="2303" class="Symbol">:</a> <a id="2305" class="Symbol">∀</a> <a id="2307" class="Symbol">{</a><a id="2308" href="Semantics.Actions.Types.html#2308" class="Bound">vs</a><a id="2310" class="Symbol">}</a>
      <a id="2318" class="Symbol">→</a> <a id="2320" class="Symbol">(</a><a id="2321" href="Semantics.Actions.Types.html#2321" class="Bound">x</a> <a id="2323" class="Symbol">:</a> <a id="2325" href="Utilities.Lists.html#1160" class="Function">Index</a> <a id="2331" href="Semantics.Actions.Types.html#2308" class="Bound">vs</a><a id="2333" class="Symbol">)</a>
      <a id="2341" class="Symbol">→</a> <a id="2343" class="Symbol">(</a><a id="2344" href="Semantics.Actions.Types.html#2344" class="Bound">y</a> <a id="2346" class="Symbol">:</a> <a id="2348" href="Utilities.Lists.html#1160" class="Function">Index</a> <a id="2354" href="Semantics.Actions.Types.html#2308" class="Bound">vs</a><a id="2356" class="Symbol">)</a>
      <a id="2364" class="Symbol">→</a> <a id="2366" class="Symbol">{</a><a id="2367" href="Semantics.Actions.Types.html#2367" class="Bound">ds</a> <a id="2370" class="Symbol">:</a> <a id="2372" href="Types.html#2946" class="Function">Deposits</a><a id="2380" class="Symbol">}</a>
      <a id="2388" class="Symbol">→</a> <a id="2390" class="Symbol">.{</a><a id="2392" href="Semantics.Actions.Types.html#2392" class="Bound">pr₁</a> <a id="2396" class="Symbol">:</a> <a id="2398" href="Relation.Nullary.Decidable.html#1247" class="Function">False</a> <a id="2404" class="Symbol">(</a><a id="2405" href="Semantics.Actions.Types.html#2321" class="Bound">x</a> <a id="2407" href="Data.Fin.Properties.html#1730" class="Function Operator">≟ᶠ</a> <a id="2410" href="Semantics.Actions.Types.html#2344" class="Bound">y</a><a id="2411" class="Symbol">)}</a>
      <a id="2420" class="Symbol">→</a> <a id="2422" class="Symbol">.{</a><a id="2424" href="Semantics.Actions.Types.html#2424" class="Bound">pr₂</a> <a id="2428" class="Symbol">:</a> <a id="2430" href="Relation.Nullary.Decidable.html#1210" class="Function">True</a> <a id="2435" class="Symbol">(</a><a id="2436" href="Semantics.Actions.Types.html#2367" class="Bound">ds</a> <a id="2439" href="Data.Set%2527.html#1897" class="Function Operator">SETₑ.≟ₗ</a> <a id="2447" class="Symbol">((</a><a id="2449" href="Semantics.Actions.Types.html#1407" class="Bound">p</a> <a id="2451" href="Types.html#2857" class="InductiveConstructor Operator">has_</a><a id="2455" class="Symbol">)</a> <a id="2457" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="2461" href="Semantics.Actions.Types.html#2308" class="Bound">vs</a> <a id="2464" href="Utilities.Lists.html#1788" class="Function Operator">at</a> <a id="2467" href="Semantics.Actions.Types.html#2321" class="Bound">x</a> <a id="2469" href="Utilities.Lists.html#1788" class="Function Operator">⟨</a> <a id="2471" class="Symbol">(</a><a id="2472" href="Semantics.Actions.Types.html#2308" class="Bound">vs</a> <a id="2475" href="Utilities.Lists.html#1248" class="Function Operator">‼</a> <a id="2477" href="Semantics.Actions.Types.html#2321" class="Bound">x</a><a id="2478" class="Symbol">)</a> <a id="2480" href="Agda.Builtin.Nat.html#298" class="Primitive Operator">+</a> <a id="2482" class="Symbol">(</a><a id="2483" href="Semantics.Actions.Types.html#2308" class="Bound">vs</a> <a id="2486" href="Utilities.Lists.html#1248" class="Function Operator">‼</a> <a id="2488" href="Semantics.Actions.Types.html#2344" class="Bound">y</a><a id="2489" class="Symbol">)</a> <a id="2491" href="Utilities.Lists.html#1788" class="Function Operator">⟩remove</a> <a id="2499" href="Semantics.Actions.Types.html#2344" class="Bound">y</a><a id="2500" class="Symbol">))}</a>
      <a id="2510" class="Symbol">→</a> <a id="2512" href="Semantics.Actions.Types.html#1399" class="Datatype">Action</a> <a id="2519" href="Semantics.Actions.Types.html#1407" class="Bound">p</a> <a id="2521" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="2524" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="2527" href="Semantics.Actions.Types.html#2308" class="Bound">vs</a> <a id="2530" href="Semantics.Actions.Types.html#2367" class="Bound">ds</a>

  <a id="2536" class="Comment">-- divide a deposit</a>
  <a id="Action._▷_,_"></a><a id="2558" href="Semantics.Actions.Types.html#2558" class="InductiveConstructor Operator">_▷_,_</a> <a id="2564" class="Symbol">:</a> <a id="2566" class="Symbol">∀</a> <a id="2568" class="Symbol">{</a><a id="2569" href="Semantics.Actions.Types.html#2569" class="Bound">vs</a><a id="2571" class="Symbol">}</a>
    <a id="2577" class="Symbol">→</a> <a id="2579" class="Symbol">(</a><a id="2580" href="Semantics.Actions.Types.html#2580" class="Bound">i</a> <a id="2582" class="Symbol">:</a> <a id="2584" href="Utilities.Lists.html#1160" class="Function">Index</a> <a id="2590" href="Semantics.Actions.Types.html#2569" class="Bound">vs</a><a id="2592" class="Symbol">)</a>
    <a id="2598" class="Symbol">→</a> <a id="2600" class="Symbol">(</a><a id="2601" href="Semantics.Actions.Types.html#2601" class="Bound">v₁</a> <a id="2604" class="Symbol">:</a> <a id="2606" href="Types.html#1168" class="Function">Value</a><a id="2611" class="Symbol">)</a>
    <a id="2617" class="Symbol">→</a> <a id="2619" class="Symbol">(</a><a id="2620" href="Semantics.Actions.Types.html#2620" class="Bound">v₂</a> <a id="2623" class="Symbol">:</a> <a id="2625" href="Types.html#1168" class="Function">Value</a><a id="2630" class="Symbol">)</a>
    <a id="2636" class="Symbol">→</a> <a id="2638" class="Symbol">{</a><a id="2639" href="Semantics.Actions.Types.html#2639" class="Bound">ds</a> <a id="2642" class="Symbol">:</a> <a id="2644" href="Types.html#2946" class="Function">Deposits</a><a id="2652" class="Symbol">}</a>
    <a id="2658" class="Symbol">→</a> <a id="2660" class="Symbol">.{</a><a id="2662" href="Semantics.Actions.Types.html#2662" class="Bound">pr₁</a> <a id="2666" class="Symbol">:</a> <a id="2668" href="Relation.Nullary.Decidable.html#1210" class="Function">True</a> <a id="2673" class="Symbol">((</a><a id="2675" href="Semantics.Actions.Types.html#2569" class="Bound">vs</a> <a id="2678" href="Utilities.Lists.html#1248" class="Function Operator">‼</a> <a id="2680" href="Semantics.Actions.Types.html#2580" class="Bound">i</a><a id="2681" class="Symbol">)</a> <a id="2683" href="Data.Nat.Properties.html#2208" class="Function Operator">≟</a> <a id="2685" class="Symbol">(</a><a id="2686" href="Semantics.Actions.Types.html#2601" class="Bound">v₁</a> <a id="2689" href="Agda.Builtin.Nat.html#298" class="Primitive Operator">+</a> <a id="2691" href="Semantics.Actions.Types.html#2620" class="Bound">v₂</a><a id="2693" class="Symbol">))}</a>
    <a id="2701" class="Symbol">→</a> <a id="2703" class="Symbol">.{</a><a id="2705" href="Semantics.Actions.Types.html#2705" class="Bound">pr₂</a> <a id="2709" class="Symbol">:</a> <a id="2711" href="Relation.Nullary.Decidable.html#1210" class="Function">True</a> <a id="2716" class="Symbol">(</a><a id="2717" href="Semantics.Actions.Types.html#2639" class="Bound">ds</a> <a id="2720" href="Data.Set%2527.html#1897" class="Function Operator">SETₑ.≟ₗ</a> <a id="2728" class="Symbol">((</a><a id="2730" href="Semantics.Actions.Types.html#1407" class="Bound">p</a> <a id="2732" href="Types.html#2857" class="InductiveConstructor Operator">has_</a><a id="2736" class="Symbol">)</a> <a id="2738" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="2742" class="Symbol">(</a><a id="2743" href="Semantics.Actions.Types.html#2569" class="Bound">vs</a> <a id="2746" href="Utilities.Lists.html#1613" class="Function Operator">at</a> <a id="2749" href="Semantics.Actions.Types.html#2580" class="Bound">i</a> <a id="2751" href="Utilities.Lists.html#1613" class="Function Operator">⟨</a> <a id="2753" href="Semantics.Actions.Types.html#2601" class="Bound">v₁</a> <a id="2756" href="Utilities.Lists.html#1613" class="Function Operator">⟩</a> <a id="2758" href="Data.List.Base.html#1570" class="Function Operator">++</a> <a id="2761" href="Data.List.Base.html#4265" class="Function Operator">[</a> <a id="2763" href="Semantics.Actions.Types.html#2620" class="Bound">v₂</a> <a id="2766" href="Data.List.Base.html#4265" class="Function Operator">]</a><a id="2767" class="Symbol">)))}</a>
    <a id="2776" class="Symbol">→</a> <a id="2778" href="Semantics.Actions.Types.html#1399" class="Datatype">Action</a> <a id="2785" href="Semantics.Actions.Types.html#1407" class="Bound">p</a> <a id="2787" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="2790" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="2793" href="Semantics.Actions.Types.html#2569" class="Bound">vs</a> <a id="2796" href="Semantics.Actions.Types.html#2639" class="Bound">ds</a>

  <a id="2802" class="Comment">-- donate deposit to participant</a>
  <a id="Action._▷ᵈ_"></a><a id="2837" href="Semantics.Actions.Types.html#2837" class="InductiveConstructor Operator">_▷ᵈ_</a> <a id="2842" class="Symbol">:</a> <a id="2844" class="Symbol">∀</a> <a id="2846" class="Symbol">{</a><a id="2847" href="Semantics.Actions.Types.html#2847" class="Bound">vs</a><a id="2849" class="Symbol">}</a>
      <a id="2857" class="Symbol">→</a> <a id="2859" class="Symbol">(</a><a id="2860" href="Semantics.Actions.Types.html#2860" class="Bound">i</a> <a id="2862" class="Symbol">:</a> <a id="2864" href="Utilities.Lists.html#1160" class="Function">Index</a> <a id="2870" href="Semantics.Actions.Types.html#2847" class="Bound">vs</a><a id="2872" class="Symbol">)</a>
      <a id="2880" class="Symbol">→</a> <a id="2882" class="Symbol">(</a><a id="2883" href="Semantics.Actions.Types.html#2883" class="Bound">p′</a> <a id="2886" class="Symbol">:</a> <a id="2888" href="Semantics.Actions.Types.html#933" class="Bound">Participant</a><a id="2899" class="Symbol">)</a>
      <a id="2907" class="Symbol">→</a> <a id="2909" class="Symbol">{</a><a id="2910" href="Semantics.Actions.Types.html#2910" class="Bound">ds</a> <a id="2913" class="Symbol">:</a> <a id="2915" href="Types.html#2946" class="Function">Deposits</a><a id="2923" class="Symbol">}</a>
      <a id="2931" class="Symbol">→</a> <a id="2933" class="Symbol">.{</a><a id="2935" href="Semantics.Actions.Types.html#2935" class="Bound">pr</a> <a id="2938" class="Symbol">:</a> <a id="2940" href="Relation.Nullary.Decidable.html#1210" class="Function">True</a> <a id="2945" class="Symbol">(</a><a id="2946" href="Semantics.Actions.Types.html#2910" class="Bound">ds</a> <a id="2949" href="Data.Set%2527.html#1897" class="Function Operator">SETₑ.≟ₗ</a> <a id="2957" href="Data.List.Base.html#4265" class="Function Operator">[</a> <a id="2959" href="Semantics.Actions.Types.html#2883" class="Bound">p′</a> <a id="2962" href="Types.html#2857" class="InductiveConstructor Operator">has</a> <a id="2966" class="Symbol">(</a><a id="2967" href="Semantics.Actions.Types.html#2847" class="Bound">vs</a> <a id="2970" href="Utilities.Lists.html#1248" class="Function Operator">‼</a> <a id="2972" href="Semantics.Actions.Types.html#2860" class="Bound">i</a><a id="2973" class="Symbol">)</a> <a id="2975" href="Data.List.Base.html#4265" class="Function Operator">]</a><a id="2976" class="Symbol">)}</a>
      <a id="2985" class="Symbol">→</a> <a id="2987" href="Semantics.Actions.Types.html#1399" class="Datatype">Action</a> <a id="2994" href="Semantics.Actions.Types.html#1407" class="Bound">p</a> <a id="2996" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="2999" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="3002" href="Semantics.Actions.Types.html#2847" class="Bound">vs</a> <a id="3005" href="Semantics.Actions.Types.html#2910" class="Bound">ds</a>

  <a id="3011" class="Comment">-- destroy deposit</a>
  <a id="Action.destroy"></a><a id="3032" href="Semantics.Actions.Types.html#3032" class="InductiveConstructor">destroy</a> <a id="3040" class="Symbol">:</a> <a id="3042" class="Symbol">∀</a> <a id="3044" class="Symbol">{</a><a id="3045" href="Semantics.Actions.Types.html#3045" class="Bound">vs</a><a id="3047" class="Symbol">}</a>
        <a id="3057" class="Symbol">→</a> <a id="3059" class="Symbol">(</a><a id="3060" href="Semantics.Actions.Types.html#3060" class="Bound">i</a> <a id="3062" class="Symbol">:</a> <a id="3064" href="Utilities.Lists.html#1160" class="Function">Index</a> <a id="3070" href="Semantics.Actions.Types.html#3045" class="Bound">vs</a><a id="3072" class="Symbol">)</a>
        <a id="3082" class="Symbol">→</a> <a id="3084" class="Symbol">{</a><a id="3085" href="Semantics.Actions.Types.html#3085" class="Bound">ds</a> <a id="3088" class="Symbol">:</a> <a id="3090" href="Types.html#2946" class="Function">Deposits</a><a id="3098" class="Symbol">}</a>
        <a id="3108" class="Symbol">→</a> <a id="3110" class="Symbol">.{</a><a id="3112" href="Semantics.Actions.Types.html#3112" class="Bound">pr</a> <a id="3115" class="Symbol">:</a> <a id="3117" href="Relation.Nullary.Decidable.html#1210" class="Function">True</a> <a id="3122" class="Symbol">(</a><a id="3123" href="Semantics.Actions.Types.html#3085" class="Bound">ds</a> <a id="3126" href="Data.Set%2527.html#1897" class="Function Operator">SETₑ.≟ₗ</a> <a id="3134" class="Symbol">(</a><a id="3135" href="Semantics.Actions.Types.html#1407" class="Bound">p</a> <a id="3137" href="Types.html#2857" class="InductiveConstructor Operator">has_</a> <a id="3142" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="3146" href="Utilities.Lists.html#1463" class="Function">remove</a> <a id="3153" href="Semantics.Actions.Types.html#3045" class="Bound">vs</a> <a id="3156" href="Semantics.Actions.Types.html#3060" class="Bound">i</a><a id="3157" class="Symbol">))}</a>
        <a id="3169" class="Symbol">→</a> <a id="3171" href="Semantics.Actions.Types.html#1399" class="Datatype">Action</a> <a id="3178" href="Semantics.Actions.Types.html#1407" class="Bound">p</a> <a id="3180" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="3183" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="3186" href="Semantics.Actions.Types.html#3045" class="Bound">vs</a> <a id="3189" href="Semantics.Actions.Types.html#3085" class="Bound">ds</a>

<a id="∃Action"></a><a id="3193" href="Semantics.Actions.Types.html#3193" class="Function">∃Action</a> <a id="3201" class="Symbol">:</a> <a id="3203" class="PrimitiveType">Set</a>
<a id="3207" href="Semantics.Actions.Types.html#3193" class="Function">∃Action</a> <a id="3215" class="Symbol">=</a> <a id="3217" href="Data.Product.html#1783" class="Function">∃[</a> <a id="3220" href="Semantics.Actions.Types.html#3220" class="Bound">p</a> <a id="3222" href="Data.Product.html#1783" class="Function">]</a> <a id="3224" href="Data.Product.html#1783" class="Function">∃[</a> <a id="3227" href="Semantics.Actions.Types.html#3227" class="Bound">ads</a> <a id="3231" href="Data.Product.html#1783" class="Function">]</a> <a id="3233" href="Data.Product.html#1783" class="Function">∃[</a> <a id="3236" href="Semantics.Actions.Types.html#3236" class="Bound">cs</a> <a id="3239" href="Data.Product.html#1783" class="Function">]</a> <a id="3241" href="Data.Product.html#1783" class="Function">∃[</a> <a id="3244" href="Semantics.Actions.Types.html#3244" class="Bound">vs</a> <a id="3247" href="Data.Product.html#1783" class="Function">]</a> <a id="3249" href="Data.Product.html#1783" class="Function">∃[</a> <a id="3252" href="Semantics.Actions.Types.html#3252" class="Bound">ds</a> <a id="3255" href="Data.Product.html#1783" class="Function">]</a> <a id="3257" href="Semantics.Actions.Types.html#1399" class="Datatype">Action</a> <a id="3264" href="Semantics.Actions.Types.html#3220" class="Bound">p</a> <a id="3266" href="Semantics.Actions.Types.html#3227" class="Bound">ads</a> <a id="3270" href="Semantics.Actions.Types.html#3236" class="Bound">cs</a> <a id="3273" href="Semantics.Actions.Types.html#3244" class="Bound">vs</a> <a id="3276" href="Semantics.Actions.Types.html#3252" class="Bound">ds</a>
</pre></body></html>