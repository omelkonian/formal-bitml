<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>BitML.Contracts.Induction</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--allow-unsolved-metas</a> <a id="36" class="Symbol">#-}</a>
<a id="40" class="Keyword">open</a> <a id="45" class="Keyword">import</a> <a id="52" href="Induction.html" class="Module">Induction</a> <a id="62" class="Keyword">using</a> <a id="68" class="Symbol">(</a><a id="69" href="Induction.html#1149" class="Function">Recursor</a><a id="77" class="Symbol">)</a>
<a id="79" class="Keyword">open</a> <a id="84" class="Keyword">import</a> <a id="91" href="Data.List.Membership.Propositional.Properties.html" class="Module">Data.List.Membership.Propositional.Properties</a>

<a id="138" class="Keyword">open</a> <a id="143" class="Keyword">import</a> <a id="150" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="189" class="Keyword">open</a> <a id="194" class="Keyword">import</a> <a id="201" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="215" class="Keyword">open</a> <a id="220" class="Keyword">import</a> <a id="227" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="245" class="Keyword">open</a> <a id="250" class="Keyword">import</a> <a id="257" href="Prelude.Applicative.html" class="Module">Prelude.Applicative</a>
<a id="277" class="Keyword">open</a> <a id="282" class="Keyword">import</a> <a id="289" href="Prelude.Nary.html" class="Module">Prelude.Nary</a>
<a id="302" class="Keyword">open</a> <a id="307" class="Keyword">import</a> <a id="314" href="Prelude.Collections.html" class="Module">Prelude.Collections</a>

<a id="335" class="Keyword">module</a> <a id="342" href="BitML.Contracts.Induction.html" class="Module">BitML.Contracts.Induction</a>
  <a id="370" class="Symbol">(</a><a id="371" href="BitML.Contracts.Induction.html#371" class="Bound">Participant</a> <a id="383" class="Symbol">:</a> <a id="385" class="PrimitiveType">Set</a><a id="388" class="Symbol">)</a>
  <a id="392" class="Symbol">{{</a><a id="394" href="BitML.Contracts.Induction.html#394" class="Bound">_</a> <a id="396" class="Symbol">:</a> <a id="398" href="Prelude.DecEq.html#494" class="Record">DecEq</a> <a id="404" href="BitML.Contracts.Induction.html#371" class="Bound">Participant</a><a id="415" class="Symbol">}}</a>
  <a id="420" class="Symbol">(</a><a id="421" href="BitML.Contracts.Induction.html#421" class="Bound">Honest</a> <a id="428" class="Symbol">:</a> <a id="430" href="Data.List.NonEmpty.html#1318" class="Record">List⁺</a> <a id="436" href="BitML.Contracts.Induction.html#371" class="Bound">Participant</a><a id="447" class="Symbol">)</a>
  <a id="451" class="Keyword">where</a>

<a id="458" class="Keyword">open</a> <a id="463" class="Keyword">import</a> <a id="470" href="BitML.BasicTypes.html" class="Module">BitML.BasicTypes</a>
<a id="487" class="Keyword">open</a> <a id="492" class="Keyword">import</a> <a id="499" href="BitML.Predicate.html" class="Module">BitML.Predicate</a>
<a id="515" class="Keyword">open</a> <a id="520" class="Keyword">import</a> <a id="527" href="BitML.Contracts.Types.html" class="Module">BitML.Contracts.Types</a> <a id="549" href="BitML.Contracts.Induction.html#371" class="Bound">Participant</a> <a id="561" href="BitML.Contracts.Induction.html#421" class="Bound">Honest</a> <a id="568" class="Keyword">hiding</a> <a id="575" class="Symbol">(</a>C<a id="577" class="Symbol">)</a>
<a id="579" class="Keyword">open</a> <a id="584" class="Keyword">import</a> <a id="591" href="BitML.Contracts.Helpers.html" class="Module">BitML.Contracts.Helpers</a> <a id="615" href="BitML.Contracts.Induction.html#371" class="Bound">Participant</a> <a id="627" href="BitML.Contracts.Induction.html#421" class="Bound">Honest</a>


<a id="636" class="Comment">{-
validContract? : Advertisement → Bool
validContract? (⟨ g ⟩ cs) = all (λ c → go c (persistents , volatiles)) cs
  where
    persistents : Value
    persistents = sum $ map (proj₁ ∘ proj₂) (persistentDeposits g)

    volatiles : namesʳ c ↦ Value
    volatiles = {!!}

    go : ∀ c → Value × (namesʳ c ↦ Value) → Bool
    go c (v , f) with c
    ... | _ ⇒ d
        = go d (v , f)
    ... | after _ ⇒ d
        = go d (v , f)
    ... | split vcs
        = ⌊ sum (map proj₁ vcs) ≤? v ⌋
        ∧ all (λ{ (v′ , cs) → all (λ c′ → go c′ (v′ , {!!})) cs }) vcs
    ... | put xs &amp;reveal _ if _ ⇒ cs
        = all (λ c′ → go c′ (v + sum (mapWith∈ cs (f ∘ {!names∈!})) , {!!})) cs
 -- (mapWith∈ (? ∘ names∈) xs) , ?)) cs
      where
        names∈ : ∀ {x} → x ∈ xs → x ∈ namesʳ c
        names∈ = {!!} -- ∈-++⁺ˡ ∘ ∈-mapMaybe⁺ ? ?
    ... | withdraw _
        = true
-}</a>

<a id="1499" class="Keyword">data</a> <a id="ℂ"></a><a id="1504" href="BitML.Contracts.Induction.html#1504" class="Datatype">ℂ</a> <a id="1506" class="Symbol">:</a> <a id="1508" class="PrimitiveType">Set</a> <a id="1512" class="Keyword">where</a>
  <a id="ℂ.C"></a><a id="1520" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a>   <a id="1524" class="Symbol">:</a> <a id="1526" href="BitML.Contracts.Types.html#634" class="Datatype">Contract</a> <a id="1535" class="Symbol">→</a> <a id="1537" href="BitML.Contracts.Induction.html#1504" class="Datatype">ℂ</a>
  <a id="ℂ.CS"></a><a id="1541" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a>  <a id="1545" class="Symbol">:</a> <a id="1547" href="BitML.Contracts.Types.html#649" class="Function">Contracts</a> <a id="1557" class="Symbol">→</a> <a id="1559" href="BitML.Contracts.Induction.html#1504" class="Datatype">ℂ</a>
  <a id="ℂ.VCS"></a><a id="1563" href="BitML.Contracts.Induction.html#1563" class="InductiveConstructor">VCS</a> <a id="1567" class="Symbol">:</a> <a id="1569" href="BitML.Contracts.Types.html#675" class="Function">VContracts</a> <a id="1580" class="Symbol">→</a> <a id="1582" href="BitML.Contracts.Induction.html#1504" class="Datatype">ℂ</a>
  <a id="1586" class="Comment">-- AD  : Advertisement → ℂ</a>

<a id="subterms"></a><a id="1614" href="BitML.Contracts.Induction.html#1614" class="Function">subterms</a> <a id="subterms⁺"></a><a id="1623" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="1633" class="Symbol">:</a> <a id="1635" href="BitML.Contracts.Induction.html#1504" class="Datatype">ℂ</a> <a id="1637" class="Symbol">→</a> <a id="1639" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1644" href="BitML.Contracts.Types.html#634" class="Datatype">Contract</a>

<a id="1654" href="BitML.Contracts.Induction.html#1614" class="Function">subterms</a> <a id="1663" href="BitML.Contracts.Induction.html#1663" class="Bound">c</a><a id="1664" class="Symbol">@(</a><a id="1666" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="1668" class="Symbol">_)</a>   <a id="1673" class="Symbol">=</a> <a id="1675" href="Data.List.Base.html#6771" class="Function">drop</a> <a id="1680" class="Number">1</a> <a id="1682" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="1684" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="1694" href="BitML.Contracts.Induction.html#1663" class="Bound">c</a>
<a id="1696" href="BitML.Contracts.Induction.html#1614" class="Function">subterms</a> <a id="1705" href="BitML.Contracts.Induction.html#1705" class="Bound">c</a><a id="1706" class="Symbol">@(</a><a id="1708" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="1711" class="Symbol">_)</a>  <a id="1715" class="Symbol">=</a> <a id="1717" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="1727" href="BitML.Contracts.Induction.html#1705" class="Bound">c</a>
<a id="1729" href="BitML.Contracts.Induction.html#1614" class="Function">subterms</a> <a id="1738" href="BitML.Contracts.Induction.html#1738" class="Bound">c</a><a id="1739" class="Symbol">@(</a><a id="1741" href="BitML.Contracts.Induction.html#1563" class="InductiveConstructor">VCS</a> <a id="1745" class="Symbol">_)</a> <a id="1748" class="Symbol">=</a> <a id="1750" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="1760" href="BitML.Contracts.Induction.html#1738" class="Bound">c</a>
<a id="1762" class="Comment">-- subterms c@(AD _)  = subterms⁺ c</a>

<a id="1799" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="1809" class="Symbol">(</a><a id="1810" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="1812" href="BitML.Contracts.Induction.html#1812" class="Bound">c</a><a id="1813" class="Symbol">)</a> <a id="1815" class="Keyword">with</a> <a id="1820" href="BitML.Contracts.Induction.html#1812" class="Bound">c</a>
<a id="1822" class="Symbol">...</a> <a id="1826" class="Symbol">|</a> <a id="1828" class="Symbol">_</a> <a id="1830" href="BitML.Contracts.Types.html#1021" class="InductiveConstructor Operator">⇒</a> <a id="1832" href="BitML.Contracts.Induction.html#1832" class="Bound">d</a>                      <a id="1855" class="Symbol">=</a> <a id="1857" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="1867" class="Symbol">(</a><a id="1868" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="1870" href="BitML.Contracts.Induction.html#1832" class="Bound">d</a><a id="1871" class="Symbol">)</a>
<a id="1873" class="Symbol">...</a> <a id="1877" class="Symbol">|</a> <a id="1879" href="BitML.Contracts.Types.html#1094" class="InductiveConstructor Operator">after</a> <a id="1885" class="Symbol">_</a> <a id="1887" href="BitML.Contracts.Types.html#1094" class="InductiveConstructor Operator">⇒</a> <a id="1889" href="BitML.Contracts.Induction.html#1889" class="Bound">d</a>                <a id="1906" class="Symbol">=</a> <a id="1908" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="1918" class="Symbol">(</a><a id="1919" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="1921" href="BitML.Contracts.Induction.html#1889" class="Bound">d</a><a id="1922" class="Symbol">)</a>
<a id="1924" class="Symbol">...</a> <a id="1928" class="Symbol">|</a> <a id="1930" href="BitML.Contracts.Types.html#946" class="InductiveConstructor">split</a> <a id="1936" href="BitML.Contracts.Induction.html#1936" class="Bound">vcs</a>                  <a id="1957" class="Symbol">=</a> <a id="1959" class="Bound">c</a> <a id="1961" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1963" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="1973" class="Symbol">(</a><a id="1974" href="BitML.Contracts.Induction.html#1563" class="InductiveConstructor">VCS</a> <a id="1978" href="BitML.Contracts.Induction.html#1936" class="Bound">vcs</a><a id="1981" class="Symbol">)</a>
<a id="1983" class="Symbol">...</a> <a id="1987" class="Symbol">|</a> <a id="1989" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">put</a> <a id="1993" class="Symbol">_</a> <a id="1995" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">&amp;reveal</a> <a id="2003" class="Symbol">_</a> <a id="2005" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">if</a> <a id="2008" class="Symbol">_</a> <a id="2010" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">⇒</a> <a id="2012" href="BitML.Contracts.Induction.html#2012" class="Bound">cs</a>  <a id="2016" class="Symbol">=</a> <a id="2018" class="Bound">c</a> <a id="2020" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2022" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="2032" class="Symbol">(</a><a id="2033" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="2036" href="BitML.Contracts.Induction.html#2012" class="Bound">cs</a><a id="2038" class="Symbol">)</a>
<a id="2040" class="Symbol">...</a> <a id="2044" class="Symbol">|</a> <a id="2046" href="BitML.Contracts.Types.html#886" class="InductiveConstructor">withdraw</a> <a id="2055" class="Symbol">_</a>                 <a id="2073" class="Symbol">=</a> <a id="2075" class="Bound">c</a> <a id="2077" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2079" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
<a id="2082" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="2092" class="Symbol">(</a><a id="2093" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="2096" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2098" class="Symbol">)</a>                <a id="2115" class="Symbol">=</a> <a id="2117" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
<a id="2120" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="2130" class="Symbol">(</a><a id="2131" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="2134" class="Symbol">(</a><a id="2135" href="BitML.Contracts.Induction.html#2135" class="Bound">c</a> <a id="2137" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2139" href="BitML.Contracts.Induction.html#2139" class="Bound">cs</a><a id="2141" class="Symbol">))</a>          <a id="2153" class="Symbol">=</a> <a id="2155" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="2165" class="Symbol">(</a><a id="2166" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="2168" href="BitML.Contracts.Induction.html#2135" class="Bound">c</a><a id="2169" class="Symbol">)</a> <a id="2171" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="2174" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="2184" class="Symbol">(</a><a id="2185" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="2188" href="BitML.Contracts.Induction.html#2139" class="Bound">cs</a><a id="2190" class="Symbol">)</a>
<a id="2192" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="2202" class="Symbol">(</a><a id="2203" href="BitML.Contracts.Induction.html#1563" class="InductiveConstructor">VCS</a> <a id="2207" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2209" class="Symbol">)</a>               <a id="2225" class="Symbol">=</a> <a id="2227" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
<a id="2230" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="2240" class="Symbol">(</a><a id="2241" href="BitML.Contracts.Induction.html#1563" class="InductiveConstructor">VCS</a> <a id="2245" class="Symbol">((_</a> <a id="2249" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2251" href="BitML.Contracts.Induction.html#2251" class="Bound">cs</a><a id="2253" class="Symbol">)</a> <a id="2255" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2257" href="BitML.Contracts.Induction.html#2257" class="Bound">vcs</a><a id="2260" class="Symbol">))</a> <a id="2263" class="Symbol">=</a> <a id="2265" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="2275" class="Symbol">(</a><a id="2276" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="2279" href="BitML.Contracts.Induction.html#2251" class="Bound">cs</a><a id="2281" class="Symbol">)</a> <a id="2283" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="2286" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="2296" class="Symbol">(</a><a id="2297" href="BitML.Contracts.Induction.html#1563" class="InductiveConstructor">VCS</a> <a id="2301" href="BitML.Contracts.Induction.html#2257" class="Bound">vcs</a><a id="2304" class="Symbol">)</a>
<a id="2306" class="Comment">-- subterms⁺ (AD (⟨ _ ⟩ cs))        = subterms⁺ (CS cs)</a>

<a id="subterms′"></a><a id="2363" href="BitML.Contracts.Induction.html#2363" class="Function">subterms′</a> <a id="subterms⁺′"></a><a id="2373" href="BitML.Contracts.Induction.html#2373" class="Function">subterms⁺′</a> <a id="2384" class="Symbol">:</a> <a id="2386" href="BitML.Contracts.Induction.html#1504" class="Datatype">ℂ</a> <a id="2388" class="Symbol">→</a> <a id="2390" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2395" href="BitML.Contracts.Types.html#634" class="Datatype">Contract</a>
<a id="2404" href="BitML.Contracts.Induction.html#2363" class="Function">subterms′</a> <a id="2414" href="BitML.Contracts.Induction.html#2414" class="Bound">c</a><a id="2415" class="Symbol">@(</a><a id="2417" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="2419" class="Symbol">_)</a>   <a id="2424" class="Symbol">=</a> <a id="2426" href="Data.List.Base.html#6771" class="Function">drop</a> <a id="2431" class="Number">1</a> <a id="2433" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="2435" href="BitML.Contracts.Induction.html#2373" class="Function">subterms⁺′</a> <a id="2446" href="BitML.Contracts.Induction.html#2414" class="Bound">c</a>
<a id="2448" href="BitML.Contracts.Induction.html#2363" class="Function">subterms′</a> <a id="2458" href="BitML.Contracts.Induction.html#2458" class="Bound">c</a><a id="2459" class="Symbol">@(</a><a id="2461" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="2464" class="Symbol">_)</a>  <a id="2468" class="Symbol">=</a> <a id="2470" href="BitML.Contracts.Induction.html#2373" class="Function">subterms⁺′</a> <a id="2481" href="BitML.Contracts.Induction.html#2458" class="Bound">c</a>
<a id="2483" href="BitML.Contracts.Induction.html#2363" class="Function">subterms′</a> <a id="2493" href="BitML.Contracts.Induction.html#2493" class="Bound">c</a><a id="2494" class="Symbol">@(</a><a id="2496" href="BitML.Contracts.Induction.html#1563" class="InductiveConstructor">VCS</a> <a id="2500" class="Symbol">_)</a> <a id="2503" class="Symbol">=</a> <a id="2505" href="BitML.Contracts.Induction.html#2373" class="Function">subterms⁺′</a> <a id="2516" href="BitML.Contracts.Induction.html#2493" class="Bound">c</a>

<a id="2519" href="BitML.Contracts.Induction.html#2373" class="Function">subterms⁺′</a> <a id="2530" class="Symbol">(</a><a id="2531" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="2533" href="BitML.Contracts.Induction.html#2533" class="Bound">c</a><a id="2534" class="Symbol">)</a> <a id="2536" class="Keyword">with</a> <a id="2541" href="BitML.Contracts.Induction.html#2533" class="Bound">c</a>
<a id="2543" class="Symbol">...</a> <a id="2547" class="Symbol">|</a> <a id="2549" class="Symbol">_</a> <a id="2551" href="BitML.Contracts.Types.html#1021" class="InductiveConstructor Operator">⇒</a> <a id="2553" href="BitML.Contracts.Induction.html#2553" class="Bound">d</a>                      <a id="2576" class="Symbol">=</a> <a id="2578" href="BitML.Contracts.Induction.html#2373" class="Function">subterms⁺′</a> <a id="2589" class="Symbol">(</a><a id="2590" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="2592" href="BitML.Contracts.Induction.html#2553" class="Bound">d</a><a id="2593" class="Symbol">)</a>
<a id="2595" class="Symbol">...</a> <a id="2599" class="Symbol">|</a> <a id="2601" href="BitML.Contracts.Types.html#1094" class="InductiveConstructor Operator">after</a> <a id="2607" class="Symbol">_</a> <a id="2609" href="BitML.Contracts.Types.html#1094" class="InductiveConstructor Operator">⇒</a> <a id="2611" href="BitML.Contracts.Induction.html#2611" class="Bound">d</a>                <a id="2628" class="Symbol">=</a> <a id="2630" href="BitML.Contracts.Induction.html#2373" class="Function">subterms⁺′</a> <a id="2641" class="Symbol">(</a><a id="2642" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="2644" href="BitML.Contracts.Induction.html#2611" class="Bound">d</a><a id="2645" class="Symbol">)</a>
<a id="2647" class="Symbol">...</a> <a id="2651" class="Symbol">|</a> <a id="2653" href="BitML.Contracts.Types.html#946" class="InductiveConstructor">split</a> <a id="2659" href="BitML.Contracts.Induction.html#2659" class="Bound">vcs</a>                  <a id="2680" class="Symbol">=</a> <a id="2682" href="BitML.Contracts.Induction.html#2373" class="Function">subterms⁺′</a> <a id="2693" class="Symbol">(</a><a id="2694" href="BitML.Contracts.Induction.html#1563" class="InductiveConstructor">VCS</a> <a id="2698" href="BitML.Contracts.Induction.html#2659" class="Bound">vcs</a><a id="2701" class="Symbol">)</a>
<a id="2703" class="Symbol">...</a> <a id="2707" class="Symbol">|</a> <a id="2709" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">put</a> <a id="2713" class="Symbol">_</a> <a id="2715" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">&amp;reveal</a> <a id="2723" class="Symbol">_</a> <a id="2725" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">if</a> <a id="2728" class="Symbol">_</a> <a id="2730" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">⇒</a> <a id="2732" href="BitML.Contracts.Induction.html#2732" class="Bound">cs</a>  <a id="2736" class="Symbol">=</a> <a id="2738" href="BitML.Contracts.Induction.html#2373" class="Function">subterms⁺′</a> <a id="2749" class="Symbol">(</a><a id="2750" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="2753" href="BitML.Contracts.Induction.html#2732" class="Bound">cs</a><a id="2755" class="Symbol">)</a>
<a id="2757" class="Symbol">...</a> <a id="2761" class="Symbol">|</a> <a id="2763" href="BitML.Contracts.Types.html#886" class="InductiveConstructor">withdraw</a> <a id="2772" class="Symbol">_</a>                 <a id="2790" class="Symbol">=</a> <a id="2792" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
<a id="2795" href="BitML.Contracts.Induction.html#2373" class="Function">subterms⁺′</a> <a id="2806" class="Symbol">(</a><a id="2807" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="2810" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2812" class="Symbol">)</a>                <a id="2829" class="Symbol">=</a> <a id="2831" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
<a id="2834" href="BitML.Contracts.Induction.html#2373" class="Function">subterms⁺′</a> <a id="2845" class="Symbol">(</a><a id="2846" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="2849" class="Symbol">(</a><a id="2850" href="BitML.Contracts.Induction.html#2850" class="Bound">c</a> <a id="2852" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2854" href="BitML.Contracts.Induction.html#2854" class="Bound">cs</a><a id="2856" class="Symbol">))</a>          <a id="2868" class="Symbol">=</a> <a id="2870" href="BitML.Contracts.Induction.html#2850" class="Bound">c</a> <a id="2872" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2874" href="BitML.Contracts.Induction.html#2373" class="Function">subterms⁺′</a> <a id="2885" class="Symbol">(</a><a id="2886" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="2888" href="BitML.Contracts.Induction.html#2850" class="Bound">c</a><a id="2889" class="Symbol">)</a> <a id="2891" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="2894" href="BitML.Contracts.Induction.html#2373" class="Function">subterms⁺′</a> <a id="2905" class="Symbol">(</a><a id="2906" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="2909" href="BitML.Contracts.Induction.html#2854" class="Bound">cs</a><a id="2911" class="Symbol">)</a>
<a id="2913" href="BitML.Contracts.Induction.html#2373" class="Function">subterms⁺′</a> <a id="2924" class="Symbol">(</a><a id="2925" href="BitML.Contracts.Induction.html#1563" class="InductiveConstructor">VCS</a> <a id="2929" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2931" class="Symbol">)</a>               <a id="2947" class="Symbol">=</a> <a id="2949" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
<a id="2952" href="BitML.Contracts.Induction.html#2373" class="Function">subterms⁺′</a> <a id="2963" class="Symbol">(</a><a id="2964" href="BitML.Contracts.Induction.html#1563" class="InductiveConstructor">VCS</a> <a id="2968" class="Symbol">((_</a> <a id="2972" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2974" href="BitML.Contracts.Induction.html#2974" class="Bound">cs</a><a id="2976" class="Symbol">)</a> <a id="2978" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2980" href="BitML.Contracts.Induction.html#2980" class="Bound">vcs</a><a id="2983" class="Symbol">))</a> <a id="2986" class="Symbol">=</a> <a id="2988" href="BitML.Contracts.Induction.html#2373" class="Function">subterms⁺′</a> <a id="2999" class="Symbol">(</a><a id="3000" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="3003" href="BitML.Contracts.Induction.html#2974" class="Bound">cs</a><a id="3005" class="Symbol">)</a> <a id="3007" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="3010" href="BitML.Contracts.Induction.html#2373" class="Function">subterms⁺′</a> <a id="3021" class="Symbol">(</a><a id="3022" href="BitML.Contracts.Induction.html#1563" class="InductiveConstructor">VCS</a> <a id="3026" href="BitML.Contracts.Induction.html#2980" class="Bound">vcs</a><a id="3029" class="Symbol">)</a>

<a id="subterms′-names⊆"></a><a id="3032" href="BitML.Contracts.Induction.html#3032" class="Function">subterms′-names⊆</a> <a id="3049" class="Symbol">:</a> <a id="3051" href="BitML.Contracts.Types.html#1243" class="Generalizable">d</a> <a id="3053" href="Data.List.Membership.Setoid.html#882" class="Function Operator">∈</a> <a id="3055" href="BitML.Contracts.Induction.html#2363" class="Function">subterms′</a> <a id="3065" class="Symbol">(</a><a id="3066" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="3069" href="BitML.Contracts.Types.html#1261" class="Generalizable">ds</a><a id="3071" class="Symbol">)</a> <a id="3073" class="Symbol">→</a> <a id="3075" href="BitML.Contracts.Helpers.html#743" class="Function">names</a> <a id="3081" href="BitML.Contracts.Types.html#1243" class="Generalizable">d</a> <a id="3083" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="3085" href="BitML.Contracts.Helpers.html#743" class="Function">names</a> <a id="3091" href="BitML.Contracts.Types.html#1261" class="Generalizable">ds</a>
<a id="3094" href="BitML.Contracts.Induction.html#3032" class="Function">subterms′-names⊆</a> <a id="3111" href="BitML.Contracts.Induction.html#3111" class="Bound">d∈</a> <a id="3114" class="Symbol">=</a> <a id="3116" class="Symbol">?</a>

<a id="subterms′-putComponents⊆"></a><a id="3119" href="BitML.Contracts.Induction.html#3119" class="Function">subterms′-putComponents⊆</a> <a id="3144" class="Symbol">:</a> <a id="3146" href="BitML.Contracts.Types.html#1243" class="Generalizable">d</a> <a id="3148" href="Data.List.Membership.Setoid.html#882" class="Function Operator">∈</a> <a id="3150" href="BitML.Contracts.Induction.html#2363" class="Function">subterms′</a> <a id="3160" class="Symbol">(</a><a id="3161" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="3164" href="BitML.Contracts.Types.html#1261" class="Generalizable">ds</a><a id="3166" class="Symbol">)</a> <a id="3168" class="Symbol">→</a> <a id="3170" href="BitML.Contracts.Helpers.html#1209" class="Function">putComponents</a> <a id="3184" href="BitML.Contracts.Types.html#1243" class="Generalizable">d</a> <a id="3186" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="3188" href="BitML.Contracts.Helpers.html#1209" class="Function">putComponents</a> <a id="3202" href="BitML.Contracts.Types.html#1261" class="Generalizable">ds</a>
<a id="3205" href="BitML.Contracts.Induction.html#3119" class="Function">subterms′-putComponents⊆</a> <a id="3230" href="BitML.Contracts.Induction.html#3230" class="Bound">d∈</a> <a id="3233" class="Symbol">=</a> <a id="3235" class="Symbol">?</a>


<a id="3239" class="Keyword">data</a> <a id="_≺_"></a><a id="3244" href="BitML.Contracts.Induction.html#3244" class="Datatype Operator">_≺_</a> <a id="3248" class="Symbol">:</a> <a id="3250" href="Relation.Binary.Core.html#845" class="Function">Rel</a> <a id="3254" href="BitML.Contracts.Induction.html#1504" class="Datatype">ℂ</a> <a id="3256" href="Level.html#512" class="Function">0ℓ</a> <a id="3259" class="Keyword">where</a>

  <a id="_≺_.≺-∈"></a><a id="3268" href="BitML.Contracts.Induction.html#3268" class="InductiveConstructor">≺-∈</a>  <a id="3273" class="Symbol">:</a> <a id="3275" href="BitML.Contracts.Types.html#1243" class="Generalizable">d</a> <a id="3277" href="Data.List.Membership.Setoid.html#882" class="Function Operator">∈</a> <a id="3279" href="BitML.Contracts.Types.html#1261" class="Generalizable">ds</a> <a id="3282" class="Symbol">→</a> <a id="3284" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="3286" href="BitML.Contracts.Types.html#1243" class="Generalizable">d</a> <a id="3288" href="BitML.Contracts.Induction.html#3244" class="Datatype Operator">≺</a> <a id="3290" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="3293" href="BitML.Contracts.Types.html#1261" class="Generalizable">ds</a>
  <a id="_≺_.≺-∈ᵛ"></a><a id="3298" href="BitML.Contracts.Induction.html#3298" class="InductiveConstructor">≺-∈ᵛ</a> <a id="3303" class="Symbol">:</a> <a id="3305" href="BitML.Contracts.Types.html#1261" class="Generalizable">ds</a> <a id="3308" href="Data.List.Membership.Setoid.html#882" class="Function Operator">∈</a> <a id="3310" href="Data.List.Base.html#1497" class="Function">map</a> <a id="3314" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="3320" href="BitML.Contracts.Types.html#1287" class="Generalizable">vcs</a> <a id="3324" class="Symbol">→</a> <a id="3326" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="3329" href="BitML.Contracts.Types.html#1261" class="Generalizable">ds</a> <a id="3332" href="BitML.Contracts.Induction.html#3244" class="Datatype Operator">≺</a> <a id="3334" href="BitML.Contracts.Induction.html#1563" class="InductiveConstructor">VCS</a> <a id="3338" href="BitML.Contracts.Types.html#1287" class="Generalizable">vcs</a>
  <a id="3344" class="Keyword">instance</a>
    <a id="_≺_.≺-put"></a><a id="3357" href="BitML.Contracts.Induction.html#3357" class="InductiveConstructor">≺-put</a>   <a id="3365" class="Symbol">:</a> <a id="3367" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="3370" href="BitML.Contracts.Types.html#1261" class="Generalizable">ds</a> <a id="3373" href="BitML.Contracts.Induction.html#3244" class="Datatype Operator">≺</a> <a id="3375" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="3377" class="Symbol">(</a><a id="3378" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">put</a> <a id="3382" href="BitML.BasicTypes.html#504" class="Generalizable">xs</a> <a id="3385" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">&amp;reveal</a> <a id="3393" href="BitML.BasicTypes.html#462" class="Generalizable">as</a> <a id="3396" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">if</a> <a id="3399" href="BitML.Predicate.html#949" class="Generalizable">p</a> <a id="3401" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">⇒</a> <a id="3403" href="BitML.Contracts.Types.html#1261" class="Generalizable">ds</a><a id="3405" class="Symbol">)</a>
    <a id="_≺_.≺-auth"></a><a id="3411" href="BitML.Contracts.Induction.html#3411" class="InductiveConstructor">≺-auth</a>  <a id="3419" class="Symbol">:</a> <a id="3421" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="3423" href="BitML.Contracts.Types.html#1243" class="Generalizable">d</a> <a id="3425" href="BitML.Contracts.Induction.html#3244" class="Datatype Operator">≺</a> <a id="3427" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="3429" class="Symbol">(</a><a id="3430" href="BitML.Contracts.Types.html#517" class="Generalizable">A</a> <a id="3432" href="BitML.Contracts.Types.html#1021" class="InductiveConstructor Operator">⇒</a> <a id="3434" href="BitML.Contracts.Types.html#1243" class="Generalizable">d</a><a id="3435" class="Symbol">)</a>
    <a id="_≺_.≺-after"></a><a id="3441" href="BitML.Contracts.Induction.html#3441" class="InductiveConstructor">≺-after</a> <a id="3449" class="Symbol">:</a> <a id="3451" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="3453" href="BitML.Contracts.Types.html#1243" class="Generalizable">d</a> <a id="3455" href="BitML.Contracts.Induction.html#3244" class="Datatype Operator">≺</a> <a id="3457" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="3459" class="Symbol">(</a><a id="3460" href="BitML.Contracts.Types.html#1094" class="InductiveConstructor Operator">after</a> <a id="3466" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="3468" href="BitML.Contracts.Types.html#1094" class="InductiveConstructor Operator">⇒</a> <a id="3470" href="BitML.Contracts.Types.html#1243" class="Generalizable">d</a><a id="3471" class="Symbol">)</a>
    <a id="_≺_.≺-split"></a><a id="3477" href="BitML.Contracts.Induction.html#3477" class="InductiveConstructor">≺-split</a> <a id="3485" class="Symbol">:</a> <a id="3487" href="BitML.Contracts.Induction.html#1563" class="InductiveConstructor">VCS</a> <a id="3491" href="BitML.Contracts.Types.html#1287" class="Generalizable">vcs</a> <a id="3495" href="BitML.Contracts.Induction.html#3244" class="Datatype Operator">≺</a> <a id="3497" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="3499" class="Symbol">(</a><a id="3500" href="BitML.Contracts.Types.html#946" class="InductiveConstructor">split</a> <a id="3506" href="BitML.Contracts.Types.html#1287" class="Generalizable">vcs</a><a id="3509" class="Symbol">)</a>
    <a id="3515" class="Comment">-- ≺-ad    : CS ds ≺ AD (⟨ g ⟩ ds)</a>

<a id="≺-wf"></a><a id="3551" href="BitML.Contracts.Induction.html#3551" class="Function">≺-wf</a> <a id="3556" class="Symbol">:</a> <a id="3558" href="Induction.WellFounded.html#1387" class="Function">WellFounded</a> <a id="3570" href="BitML.Contracts.Induction.html#3244" class="Datatype Operator">_≺_</a>
<a id="3574" href="BitML.Contracts.Induction.html#3551" class="Function">≺-wf</a> <a id="3579" class="Symbol">=</a> <a id="3581" href="Induction.WellFounded.html#1062" class="InductiveConstructor">acc</a> <a id="3585" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3587" href="BitML.Contracts.Induction.html#3603" class="Function Operator">_≻_</a>
  <a id="3593" class="Keyword">where</a>
    <a id="3603" href="BitML.Contracts.Induction.html#3603" class="Function Operator">_≻_</a> <a id="3607" class="Symbol">:</a> <a id="3609" class="Symbol">∀</a> <a id="3611" href="BitML.Contracts.Induction.html#3611" class="Bound">c</a> <a id="3613" href="BitML.Contracts.Induction.html#3613" class="Bound">c′</a> <a id="3616" class="Symbol">→</a> <a id="3618" href="BitML.Contracts.Induction.html#3613" class="Bound">c′</a> <a id="3621" href="BitML.Contracts.Induction.html#3244" class="Datatype Operator">≺</a> <a id="3623" href="BitML.Contracts.Induction.html#3611" class="Bound">c</a> <a id="3625" class="Symbol">→</a> <a id="3627" href="Induction.WellFounded.html#1000" class="Datatype">Acc</a> <a id="3631" href="BitML.Contracts.Induction.html#3244" class="Datatype Operator">_≺_</a> <a id="3635" href="BitML.Contracts.Induction.html#3613" class="Bound">c′</a>
    <a id="3642" class="Symbol">(</a><a id="3643" class="DottedPattern Symbol">.(</a><a id="3645" href="BitML.Contracts.Induction.html#1541" class="DottedPattern InductiveConstructor">CS</a> <a id="3648" class="DottedPattern Symbol">(_</a> <a id="3651" href="Agda.Builtin.List.html#200" class="DottedPattern InductiveConstructor Operator">∷</a> <a id="3653" class="DottedPattern Symbol">_))</a>  <a id="3658" href="BitML.Contracts.Induction.html#3603" class="Function Operator">≻</a> <a id="3660" class="DottedPattern Symbol">.(</a><a id="3662" href="BitML.Contracts.Induction.html#1520" class="DottedPattern InductiveConstructor">C</a> <a id="3664" class="DottedPattern Symbol">_)</a><a id="3666" class="Symbol">)</a>  <a id="3669" class="Symbol">(</a><a id="3670" href="BitML.Contracts.Induction.html#3268" class="InductiveConstructor">≺-∈</a>                <a id="3689" class="Symbol">(</a><a id="3690" href="Data.List.Relation.Unary.Any.html#1174" class="InductiveConstructor">here</a> <a id="3695" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="3699" class="Symbol">))</a> <a id="3702" class="Symbol">=</a> <a id="3704" href="Induction.WellFounded.html#1062" class="InductiveConstructor">acc</a> <a id="3708" class="Symbol">(_</a> <a id="3711" href="BitML.Contracts.Induction.html#3603" class="Function Operator">≻_</a><a id="3713" class="Symbol">)</a>
    <a id="3719" class="Symbol">(</a><a id="3720" class="DottedPattern Symbol">.(</a><a id="3722" href="BitML.Contracts.Induction.html#1541" class="DottedPattern InductiveConstructor">CS</a> <a id="3725" class="DottedPattern Symbol">(_</a> <a id="3728" href="Agda.Builtin.List.html#200" class="DottedPattern InductiveConstructor Operator">∷</a> <a id="3730" class="DottedPattern Symbol">_))</a>  <a id="3735" href="BitML.Contracts.Induction.html#3603" class="Function Operator">≻</a> <a id="3737" class="DottedPattern Symbol">.(</a><a id="3739" href="BitML.Contracts.Induction.html#1520" class="DottedPattern InductiveConstructor">C</a> <a id="3741" class="DottedPattern Symbol">_)</a><a id="3743" class="Symbol">)</a>  <a id="3746" class="Symbol">(</a><a id="3747" href="BitML.Contracts.Induction.html#3268" class="InductiveConstructor">≺-∈</a>                <a id="3766" class="Symbol">(</a><a id="3767" href="Data.List.Relation.Unary.Any.html#1227" class="InductiveConstructor">there</a> <a id="3773" href="BitML.Contracts.Induction.html#3773" class="Bound">p</a><a id="3774" class="Symbol">))</a>   <a id="3779" class="Symbol">=</a> <a id="3781" class="Symbol">(_</a> <a id="3784" href="BitML.Contracts.Induction.html#3603" class="Function Operator">≻</a> <a id="3786" class="Symbol">_)</a> <a id="3789" class="Symbol">(</a><a id="3790" href="BitML.Contracts.Induction.html#3268" class="InductiveConstructor">≺-∈</a> <a id="3794" href="BitML.Contracts.Induction.html#3773" class="Bound">p</a><a id="3795" class="Symbol">)</a>
    <a id="3801" class="Symbol">(</a><a id="3802" class="DottedPattern Symbol">.(</a><a id="3804" href="BitML.Contracts.Induction.html#1563" class="DottedPattern InductiveConstructor">VCS</a> <a id="3808" class="DottedPattern Symbol">(_</a> <a id="3811" href="Agda.Builtin.List.html#200" class="DottedPattern InductiveConstructor Operator">∷</a> <a id="3813" class="DottedPattern Symbol">_))</a> <a id="3817" href="BitML.Contracts.Induction.html#3603" class="Function Operator">≻</a> <a id="3819" class="DottedPattern Symbol">.(</a><a id="3821" href="BitML.Contracts.Induction.html#1541" class="DottedPattern InductiveConstructor">CS</a> <a id="3824" class="DottedPattern Symbol">_)</a><a id="3826" class="Symbol">)</a> <a id="3828" class="Symbol">(</a><a id="3829" href="BitML.Contracts.Induction.html#3298" class="InductiveConstructor">≺-∈ᵛ</a> <a id="3834" class="Symbol">{</a><a id="3835" class="Argument">vcs</a> <a id="3839" class="Symbol">=</a> <a id="3841" class="Symbol">_</a> <a id="3843" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3845" class="Symbol">_}</a> <a id="3848" class="Symbol">(</a><a id="3849" href="Data.List.Relation.Unary.Any.html#1174" class="InductiveConstructor">here</a> <a id="3854" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="3858" class="Symbol">))</a> <a id="3861" class="Symbol">=</a> <a id="3863" href="Induction.WellFounded.html#1062" class="InductiveConstructor">acc</a> <a id="3867" class="Symbol">(_</a> <a id="3870" href="BitML.Contracts.Induction.html#3603" class="Function Operator">≻_</a><a id="3872" class="Symbol">)</a>
    <a id="3878" class="Symbol">(</a><a id="3879" class="DottedPattern Symbol">.(</a><a id="3881" href="BitML.Contracts.Induction.html#1563" class="DottedPattern InductiveConstructor">VCS</a> <a id="3885" class="DottedPattern Symbol">(_</a> <a id="3888" href="Agda.Builtin.List.html#200" class="DottedPattern InductiveConstructor Operator">∷</a> <a id="3890" class="DottedPattern Symbol">_))</a> <a id="3894" href="BitML.Contracts.Induction.html#3603" class="Function Operator">≻</a> <a id="3896" class="DottedPattern Symbol">.(</a><a id="3898" href="BitML.Contracts.Induction.html#1541" class="DottedPattern InductiveConstructor">CS</a> <a id="3901" class="DottedPattern Symbol">_)</a><a id="3903" class="Symbol">)</a> <a id="3905" class="Symbol">(</a><a id="3906" href="BitML.Contracts.Induction.html#3298" class="InductiveConstructor">≺-∈ᵛ</a> <a id="3911" class="Symbol">{</a><a id="3912" class="Argument">vcs</a> <a id="3916" class="Symbol">=</a> <a id="3918" class="Symbol">_</a> <a id="3920" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3922" class="Symbol">_}</a> <a id="3925" class="Symbol">(</a><a id="3926" href="Data.List.Relation.Unary.Any.html#1227" class="InductiveConstructor">there</a> <a id="3932" href="BitML.Contracts.Induction.html#3932" class="Bound">p</a><a id="3933" class="Symbol">))</a>   <a id="3938" class="Symbol">=</a> <a id="3940" class="Symbol">(_</a> <a id="3943" href="BitML.Contracts.Induction.html#3603" class="Function Operator">≻</a> <a id="3945" class="Symbol">_)</a> <a id="3948" class="Symbol">(</a><a id="3949" href="BitML.Contracts.Induction.html#3298" class="InductiveConstructor">≺-∈ᵛ</a> <a id="3954" href="BitML.Contracts.Induction.html#3932" class="Bound">p</a><a id="3955" class="Symbol">)</a>

    <a id="3962" class="Symbol">(</a><a id="3963" class="DottedPattern Symbol">.(</a><a id="3965" href="BitML.Contracts.Induction.html#1520" class="DottedPattern InductiveConstructor">C</a> <a id="3967" class="DottedPattern Symbol">(</a><a id="3968" href="BitML.Contracts.Types.html#771" class="DottedPattern InductiveConstructor Operator">put</a> <a id="3972" class="DottedPattern Symbol">_</a> <a id="3974" href="BitML.Contracts.Types.html#771" class="DottedPattern InductiveConstructor Operator">&amp;reveal</a> <a id="3982" class="DottedPattern Symbol">_</a> <a id="3984" href="BitML.Contracts.Types.html#771" class="DottedPattern InductiveConstructor Operator">if</a> <a id="3987" class="DottedPattern Symbol">_</a> <a id="3989" href="BitML.Contracts.Types.html#771" class="DottedPattern InductiveConstructor Operator">⇒</a> <a id="3991" class="DottedPattern Symbol">_))</a> <a id="3995" href="BitML.Contracts.Induction.html#3603" class="Function Operator">≻</a> <a id="3997" class="DottedPattern Symbol">.(</a><a id="3999" href="BitML.Contracts.Induction.html#1541" class="DottedPattern InductiveConstructor">CS</a> <a id="4002" class="DottedPattern Symbol">_)</a><a id="4004" class="Symbol">)</a>  <a id="4007" href="BitML.Contracts.Induction.html#3357" class="InductiveConstructor">≺-put</a>   <a id="4015" class="Symbol">=</a> <a id="4017" href="Induction.WellFounded.html#1062" class="InductiveConstructor">acc</a> <a id="4021" class="Symbol">(_</a> <a id="4024" href="BitML.Contracts.Induction.html#3603" class="Function Operator">≻_</a><a id="4026" class="Symbol">)</a>
    <a id="4032" class="Symbol">(</a><a id="4033" class="DottedPattern Symbol">.(</a><a id="4035" href="BitML.Contracts.Induction.html#1520" class="DottedPattern InductiveConstructor">C</a> <a id="4037" class="DottedPattern Symbol">(_</a> <a id="4040" href="BitML.Contracts.Types.html#1021" class="DottedPattern InductiveConstructor Operator">⇒</a> <a id="4042" class="DottedPattern Symbol">_))</a>                    <a id="4065" href="BitML.Contracts.Induction.html#3603" class="Function Operator">≻</a> <a id="4067" class="DottedPattern Symbol">.(</a><a id="4069" href="BitML.Contracts.Induction.html#1520" class="DottedPattern InductiveConstructor">C</a> <a id="4071" class="DottedPattern Symbol">_)</a><a id="4073" class="Symbol">)</a>   <a id="4077" href="BitML.Contracts.Induction.html#3411" class="InductiveConstructor">≺-auth</a>  <a id="4085" class="Symbol">=</a> <a id="4087" href="Induction.WellFounded.html#1062" class="InductiveConstructor">acc</a> <a id="4091" class="Symbol">(_</a> <a id="4094" href="BitML.Contracts.Induction.html#3603" class="Function Operator">≻_</a><a id="4096" class="Symbol">)</a>
    <a id="4102" class="Symbol">(</a><a id="4103" class="DottedPattern Symbol">.(</a><a id="4105" href="BitML.Contracts.Induction.html#1520" class="DottedPattern InductiveConstructor">C</a> <a id="4107" class="DottedPattern Symbol">(</a><a id="4108" href="BitML.Contracts.Types.html#1094" class="DottedPattern InductiveConstructor Operator">after</a> <a id="4114" class="DottedPattern Symbol">_</a> <a id="4116" href="BitML.Contracts.Types.html#1094" class="DottedPattern InductiveConstructor Operator">⇒</a> <a id="4118" class="DottedPattern Symbol">_))</a>              <a id="4135" href="BitML.Contracts.Induction.html#3603" class="Function Operator">≻</a> <a id="4137" class="DottedPattern Symbol">.(</a><a id="4139" href="BitML.Contracts.Induction.html#1520" class="DottedPattern InductiveConstructor">C</a> <a id="4141" class="DottedPattern Symbol">_)</a><a id="4143" class="Symbol">)</a>   <a id="4147" href="BitML.Contracts.Induction.html#3441" class="InductiveConstructor">≺-after</a> <a id="4155" class="Symbol">=</a> <a id="4157" href="Induction.WellFounded.html#1062" class="InductiveConstructor">acc</a> <a id="4161" class="Symbol">(_</a> <a id="4164" href="BitML.Contracts.Induction.html#3603" class="Function Operator">≻_</a><a id="4166" class="Symbol">)</a>
    <a id="4172" class="Symbol">(</a><a id="4173" class="DottedPattern Symbol">.(</a><a id="4175" href="BitML.Contracts.Induction.html#1520" class="DottedPattern InductiveConstructor">C</a> <a id="4177" class="DottedPattern Symbol">(</a><a id="4178" href="BitML.Contracts.Types.html#946" class="DottedPattern InductiveConstructor">split</a> <a id="4184" class="DottedPattern Symbol">_))</a>                  <a id="4205" href="BitML.Contracts.Induction.html#3603" class="Function Operator">≻</a> <a id="4207" class="DottedPattern Symbol">.(</a><a id="4209" href="BitML.Contracts.Induction.html#1563" class="DottedPattern InductiveConstructor">VCS</a> <a id="4213" class="DottedPattern Symbol">_)</a><a id="4215" class="Symbol">)</a> <a id="4217" href="BitML.Contracts.Induction.html#3477" class="InductiveConstructor">≺-split</a> <a id="4225" class="Symbol">=</a> <a id="4227" href="Induction.WellFounded.html#1062" class="InductiveConstructor">acc</a> <a id="4231" class="Symbol">(_</a> <a id="4234" href="BitML.Contracts.Induction.html#3603" class="Function Operator">≻_</a><a id="4236" class="Symbol">)</a>
    <a id="4242" class="Comment">-- (.(AD (⟨ _ ⟩ _)                  ≻ .(CS _))  ≺-ad    = acc (_ ≻_)</a>

<a id="≺-rec"></a><a id="4312" href="BitML.Contracts.Induction.html#4312" class="Function">≺-rec</a> <a id="4318" class="Symbol">:</a> <a id="4320" href="Induction.html#1149" class="Function">Recursor</a> <a id="4329" class="Symbol">(</a><a id="4330" href="Induction.WellFounded.html#794" class="Function">WF.WfRec</a> <a id="4339" href="BitML.Contracts.Induction.html#3244" class="Datatype Operator">_≺_</a><a id="4342" class="Symbol">)</a>
<a id="4344" href="BitML.Contracts.Induction.html#4312" class="Function">≺-rec</a> <a id="4350" class="Symbol">=</a> <a id="4352" href="Induction.WellFounded.html#2999" class="Function">WF.All.wfRec</a> <a id="4365" href="BitML.Contracts.Induction.html#3551" class="Function">≺-wf</a> <a id="4370" href="Level.html#512" class="Function">0ℓ</a>

<a id="4374" class="Keyword">record</a> <a id="Toℂ"></a><a id="4381" href="BitML.Contracts.Induction.html#4381" class="Record">Toℂ</a> <a id="4385" class="Symbol">(</a><a id="4386" href="BitML.Contracts.Induction.html#4386" class="Bound">A</a> <a id="4388" class="Symbol">:</a> <a id="4390" class="PrimitiveType">Set</a><a id="4393" class="Symbol">)</a> <a id="4395" class="Symbol">:</a> <a id="4397" class="PrimitiveType">Set</a> <a id="4401" class="Keyword">where</a>
  <a id="4409" class="Keyword">field</a>
    <a id="Toℂ.toℂ"></a><a id="4419" href="BitML.Contracts.Induction.html#4419" class="Field">toℂ</a> <a id="4423" class="Symbol">:</a> <a id="4425" href="BitML.Contracts.Induction.html#4386" class="Bound">A</a> <a id="4427" class="Symbol">→</a> <a id="4429" href="BitML.Contracts.Induction.html#1504" class="Datatype">ℂ</a>

  <a id="4434" class="Comment">-- subterms′ : A → List Contract</a>
  <a id="4469" class="Comment">-- subterms′ = subterms ∘ toℂ</a>
<a id="4499" class="Keyword">open</a> <a id="4504" href="BitML.Contracts.Induction.html#4381" class="Module">Toℂ</a> <a id="4508" class="Symbol">{{...}}</a> <a id="4516" class="Keyword">public</a>

<a id="4524" class="Keyword">instance</a>
  <a id="Toℂᶜ"></a><a id="4535" href="BitML.Contracts.Induction.html#4535" class="Function">Toℂᶜ</a> <a id="4540" class="Symbol">:</a> <a id="4542" href="BitML.Contracts.Induction.html#4381" class="Record">Toℂ</a> <a id="4546" href="BitML.Contracts.Types.html#634" class="Datatype">Contract</a>
  <a id="4557" href="BitML.Contracts.Induction.html#4535" class="Function">Toℂᶜ</a> <a id="4562" class="Symbol">.</a><a id="4563" href="BitML.Contracts.Induction.html#4419" class="Field">toℂ</a> <a id="4567" class="Symbol">=</a> <a id="4569" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a>

  <a id="Toℂᶜˢ"></a><a id="4574" href="BitML.Contracts.Induction.html#4574" class="Function">Toℂᶜˢ</a> <a id="4580" class="Symbol">:</a> <a id="4582" href="BitML.Contracts.Induction.html#4381" class="Record">Toℂ</a> <a id="4586" href="BitML.Contracts.Types.html#649" class="Function">Contracts</a>
  <a id="4598" href="BitML.Contracts.Induction.html#4574" class="Function">Toℂᶜˢ</a> <a id="4604" class="Symbol">.</a><a id="4605" href="BitML.Contracts.Induction.html#4419" class="Field">toℂ</a> <a id="4609" class="Symbol">=</a> <a id="4611" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a>

  <a id="Toℂᵛᶜˢ"></a><a id="4617" href="BitML.Contracts.Induction.html#4617" class="Function">Toℂᵛᶜˢ</a> <a id="4624" class="Symbol">:</a> <a id="4626" href="BitML.Contracts.Induction.html#4381" class="Record">Toℂ</a> <a id="4630" href="BitML.Contracts.Types.html#675" class="Function">VContracts</a>
  <a id="4643" href="BitML.Contracts.Induction.html#4617" class="Function">Toℂᵛᶜˢ</a> <a id="4650" class="Symbol">.</a><a id="4651" href="BitML.Contracts.Induction.html#4419" class="Field">toℂ</a> <a id="4655" class="Symbol">=</a> <a id="4657" href="BitML.Contracts.Induction.html#1563" class="InductiveConstructor">VCS</a>

  <a id="4664" class="Comment">-- Toℂᵃᵈ : Toℂ Advertisement</a>
  <a id="4695" class="Comment">-- Toℂᵃᵈ .toℂ = AD</a>

<a id="_≺ℂ_"></a><a id="4715" href="BitML.Contracts.Induction.html#4715" class="Function Operator">_≺ℂ_</a> <a id="4720" class="Symbol">:</a> <a id="4722" class="Symbol">∀</a> <a id="4724" class="Symbol">{</a><a id="4725" href="BitML.Contracts.Induction.html#4725" class="Bound">A</a> <a id="4727" href="BitML.Contracts.Induction.html#4727" class="Bound">B</a> <a id="4729" class="Symbol">:</a> <a id="4731" class="PrimitiveType">Set</a><a id="4734" class="Symbol">}</a> <a id="4736" class="Symbol">{{</a><a id="4738" href="BitML.Contracts.Induction.html#4738" class="Bound">_</a> <a id="4740" class="Symbol">:</a> <a id="4742" href="BitML.Contracts.Induction.html#4381" class="Record">Toℂ</a> <a id="4746" href="BitML.Contracts.Induction.html#4725" class="Bound">A</a><a id="4747" class="Symbol">}}</a> <a id="4750" class="Symbol">{{</a><a id="4752" href="BitML.Contracts.Induction.html#4752" class="Bound">_</a> <a id="4754" class="Symbol">:</a> <a id="4756" href="BitML.Contracts.Induction.html#4381" class="Record">Toℂ</a> <a id="4760" href="BitML.Contracts.Induction.html#4727" class="Bound">B</a><a id="4761" class="Symbol">}}</a> <a id="4764" class="Symbol">→</a> <a id="4766" href="BitML.Contracts.Induction.html#4725" class="Bound">A</a> <a id="4768" class="Symbol">→</a> <a id="4770" href="BitML.Contracts.Induction.html#4727" class="Bound">B</a> <a id="4772" class="Symbol">→</a> <a id="4774" class="PrimitiveType">Set</a>
<a id="4778" href="BitML.Contracts.Induction.html#4778" class="Bound">x</a> <a id="4780" href="BitML.Contracts.Induction.html#4715" class="Function Operator">≺ℂ</a> <a id="4783" href="BitML.Contracts.Induction.html#4783" class="Bound">y</a> <a id="4785" class="Symbol">=</a> <a id="4787" href="BitML.Contracts.Induction.html#4419" class="Field">toℂ</a> <a id="4791" href="BitML.Contracts.Induction.html#4778" class="Bound">x</a> <a id="4793" href="BitML.Contracts.Induction.html#3244" class="Datatype Operator">≺</a> <a id="4795" href="BitML.Contracts.Induction.html#4419" class="Field">toℂ</a> <a id="4799" href="BitML.Contracts.Induction.html#4783" class="Bound">y</a>

<a id="4802" class="Comment">-- Helpers.</a>
<a id="↦-∈"></a><a id="4814" href="BitML.Contracts.Induction.html#4814" class="Function">↦-∈</a> <a id="4818" class="Symbol">:</a> <a id="4820" class="Symbol">∀</a> <a id="4822" class="Symbol">{</a><a id="4823" href="BitML.Contracts.Induction.html#4823" class="Bound">R</a> <a id="4825" class="Symbol">:</a> <a id="4827" class="PrimitiveType">Set</a><a id="4830" class="Symbol">}</a>
  <a id="4834" class="Symbol">→</a> <a id="4836" class="Symbol">(∀</a> <a id="4839" class="Symbol">{</a><a id="4840" href="BitML.Contracts.Induction.html#4840" class="Bound">d</a><a id="4841" class="Symbol">}</a> <a id="4843" class="Symbol">→</a> <a id="4845" href="BitML.Contracts.Induction.html#4840" class="Bound">d</a> <a id="4847" href="Data.List.Membership.Setoid.html#882" class="Function Operator">∈</a> <a id="4849" href="BitML.Contracts.Types.html#1261" class="Generalizable">ds</a> <a id="4852" class="Symbol">→</a> <a id="4854" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="4864" class="Symbol">(</a><a id="4865" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="4867" href="BitML.Contracts.Induction.html#4840" class="Bound">d</a><a id="4868" class="Symbol">)</a> <a id="4870" href="Prelude.Lists.html#10280" class="Function Operator">↦</a> <a id="4872" href="BitML.Contracts.Induction.html#4823" class="Bound">R</a><a id="4873" class="Symbol">)</a>
  <a id="4877" class="Symbol">→</a> <a id="4879" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="4889" class="Symbol">(</a><a id="4890" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="4893" href="BitML.Contracts.Types.html#1261" class="Generalizable">ds</a><a id="4895" class="Symbol">)</a> <a id="4897" href="Prelude.Lists.html#10280" class="Function Operator">↦</a> <a id="4899" href="BitML.Contracts.Induction.html#4823" class="Bound">R</a>
<a id="4901" href="BitML.Contracts.Induction.html#4814" class="Function">↦-∈</a> <a id="4905" class="Symbol">{</a><a id="4906" class="Argument">ds</a> <a id="4909" class="Symbol">=</a> <a id="4911" href="BitML.Contracts.Induction.html#4911" class="Bound">c</a> <a id="4913" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4915" href="BitML.Contracts.Induction.html#4915" class="Bound">cs</a><a id="4917" class="Symbol">}</a> <a id="4919" href="BitML.Contracts.Induction.html#4919" class="Bound">f</a> <a id="4921" href="BitML.Contracts.Induction.html#4921" class="Bound">x∈</a>
  <a id="4926" class="Keyword">with</a> <a id="4931" href="Data.List.Membership.Propositional.Properties.html#4081" class="Function">∈-++⁻</a> <a id="4937" class="Symbol">(</a><a id="4938" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="4948" class="Symbol">(</a><a id="4949" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="4951" href="BitML.Contracts.Induction.html#4911" class="Bound">c</a><a id="4952" class="Symbol">))</a> <a id="4955" href="BitML.Contracts.Induction.html#4921" class="Bound">x∈</a>
<a id="4958" class="Symbol">...</a> <a id="4962" class="Symbol">|</a> <a id="4964" href="Data.Sum.Base.html#778" class="InductiveConstructor">inj₁</a> <a id="4969" href="BitML.Contracts.Induction.html#4969" class="Bound">x∈ˡ</a> <a id="4973" class="Symbol">=</a> <a id="4975" class="Bound">f</a> <a id="4977" class="Symbol">(</a><a id="4978" href="Data.List.Relation.Unary.Any.html#1174" class="InductiveConstructor">here</a> <a id="4983" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="4987" class="Symbol">)</a> <a id="4989" href="BitML.Contracts.Induction.html#4969" class="Bound">x∈ˡ</a>
<a id="4993" class="Symbol">...</a> <a id="4997" class="Symbol">|</a> <a id="4999" href="Data.Sum.Base.html#803" class="InductiveConstructor">inj₂</a> <a id="5004" href="BitML.Contracts.Induction.html#5004" class="Bound">x∈ʳ</a> <a id="5008" class="Symbol">=</a> <a id="5010" href="BitML.Contracts.Induction.html#4814" class="Function">↦-∈</a> <a id="5014" class="Symbol">(</a><a id="5015" class="Bound">f</a> <a id="5017" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5019" href="Data.List.Relation.Unary.Any.html#1227" class="InductiveConstructor">there</a><a id="5024" class="Symbol">)</a> <a id="5026" href="BitML.Contracts.Induction.html#5004" class="Bound">x∈ʳ</a>

<a id="↦-∈ᵛ"></a><a id="5031" href="BitML.Contracts.Induction.html#5031" class="Function">↦-∈ᵛ</a> <a id="5036" class="Symbol">:</a> <a id="5038" class="Symbol">∀</a> <a id="5040" class="Symbol">{</a><a id="5041" href="BitML.Contracts.Induction.html#5041" class="Bound">R</a> <a id="5043" class="Symbol">:</a> <a id="5045" class="PrimitiveType">Set</a><a id="5048" class="Symbol">}</a>
  <a id="5052" class="Symbol">→</a> <a id="5054" class="Symbol">(∀</a> <a id="5057" class="Symbol">{</a><a id="5058" href="BitML.Contracts.Induction.html#5058" class="Bound">cs</a><a id="5060" class="Symbol">}</a> <a id="5062" class="Symbol">→</a> <a id="5064" href="BitML.Contracts.Induction.html#5058" class="Bound">cs</a> <a id="5067" href="Data.List.Membership.Setoid.html#882" class="Function Operator">∈</a> <a id="5069" href="Data.List.Base.html#1497" class="Function">map</a> <a id="5073" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="5079" href="BitML.Contracts.Types.html#1287" class="Generalizable">vcs</a> <a id="5083" class="Symbol">→</a> <a id="5085" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="5095" class="Symbol">(</a><a id="5096" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="5099" href="BitML.Contracts.Induction.html#5058" class="Bound">cs</a><a id="5101" class="Symbol">)</a> <a id="5103" href="Prelude.Lists.html#10280" class="Function Operator">↦</a> <a id="5105" href="BitML.Contracts.Induction.html#5041" class="Bound">R</a><a id="5106" class="Symbol">)</a>
  <a id="5110" class="Symbol">→</a> <a id="5112" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="5122" class="Symbol">(</a><a id="5123" href="BitML.Contracts.Induction.html#1563" class="InductiveConstructor">VCS</a> <a id="5127" href="BitML.Contracts.Types.html#1287" class="Generalizable">vcs</a><a id="5130" class="Symbol">)</a> <a id="5132" href="Prelude.Lists.html#10280" class="Function Operator">↦</a> <a id="5134" href="BitML.Contracts.Induction.html#5041" class="Bound">R</a>
<a id="5136" href="BitML.Contracts.Induction.html#5031" class="Function">↦-∈ᵛ</a> <a id="5141" class="Symbol">{</a><a id="5142" class="Argument">vcs</a> <a id="5146" class="Symbol">=</a> <a id="5148" class="Symbol">(_</a> <a id="5151" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5153" href="BitML.Contracts.Induction.html#5153" class="Bound">cs</a><a id="5155" class="Symbol">)</a> <a id="5157" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5159" href="BitML.Contracts.Induction.html#5159" class="Bound">vcs</a><a id="5162" class="Symbol">}</a> <a id="5164" href="BitML.Contracts.Induction.html#5164" class="Bound">f</a> <a id="5166" href="BitML.Contracts.Induction.html#5166" class="Bound">x∈</a>
  <a id="5171" class="Keyword">with</a> <a id="5176" href="Data.List.Membership.Propositional.Properties.html#4081" class="Function">∈-++⁻</a> <a id="5182" class="Symbol">(</a><a id="5183" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="5193" class="Symbol">(</a><a id="5194" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="5197" href="BitML.Contracts.Induction.html#5153" class="Bound">cs</a><a id="5199" class="Symbol">))</a> <a id="5202" href="BitML.Contracts.Induction.html#5166" class="Bound">x∈</a>
<a id="5205" class="Symbol">...</a> <a id="5209" class="Symbol">|</a> <a id="5211" href="Data.Sum.Base.html#778" class="InductiveConstructor">inj₁</a> <a id="5216" href="BitML.Contracts.Induction.html#5216" class="Bound">x∈ˡ</a> <a id="5220" class="Symbol">=</a> <a id="5222" class="Bound">f</a> <a id="5224" class="Symbol">(</a><a id="5225" href="Data.List.Relation.Unary.Any.html#1174" class="InductiveConstructor">here</a> <a id="5230" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="5234" class="Symbol">)</a> <a id="5236" href="BitML.Contracts.Induction.html#5216" class="Bound">x∈ˡ</a>
<a id="5240" class="Symbol">...</a> <a id="5244" class="Symbol">|</a> <a id="5246" href="Data.Sum.Base.html#803" class="InductiveConstructor">inj₂</a> <a id="5251" href="BitML.Contracts.Induction.html#5251" class="Bound">x∈ʳ</a> <a id="5255" class="Symbol">=</a> <a id="5257" href="BitML.Contracts.Induction.html#5031" class="Function">↦-∈ᵛ</a> <a id="5262" class="Symbol">(</a><a id="5263" class="Bound">f</a> <a id="5265" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5267" href="Data.List.Relation.Unary.Any.html#1227" class="InductiveConstructor">there</a><a id="5272" class="Symbol">)</a> <a id="5274" href="BitML.Contracts.Induction.html#5251" class="Bound">x∈ʳ</a>


<a id="5280" class="Comment">-- Example well-founded recursion on contracts.</a>
<a id="5328" class="Keyword">private</a>

  <a id="State"></a><a id="5339" href="BitML.Contracts.Induction.html#5339" class="Function">State</a> <a id="5345" class="Symbol">:</a> <a id="5347" href="BitML.Contracts.Induction.html#1504" class="Datatype">ℂ</a> <a id="5349" class="Symbol">→</a> <a id="5351" class="PrimitiveType">Set</a>
  <a id="5357" href="BitML.Contracts.Induction.html#5339" class="Function">State</a> <a id="5363" href="BitML.Contracts.Induction.html#5363" class="Bound">c</a> <a id="5365" class="Symbol">=</a> <a id="5367" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

  <a id="Return"></a><a id="5372" href="BitML.Contracts.Induction.html#5372" class="Function">Return</a> <a id="5379" class="Symbol">:</a> <a id="5381" href="BitML.Contracts.Induction.html#1504" class="Datatype">ℂ</a> <a id="5383" class="Symbol">→</a> <a id="5385" class="PrimitiveType">Set</a>
  <a id="5391" href="BitML.Contracts.Induction.html#5372" class="Function">Return</a> <a id="5398" href="BitML.Contracts.Induction.html#5398" class="Bound">c</a> <a id="5400" class="Symbol">=</a> <a id="5402" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="5412" href="BitML.Contracts.Induction.html#5398" class="Bound">c</a> <a id="5414" href="Prelude.Lists.html#10280" class="Function Operator">↦</a> <a id="5416" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

  <a id="count-decorations"></a><a id="5421" href="BitML.Contracts.Induction.html#5421" class="Function">count-decorations</a> <a id="5439" class="Symbol">:</a> <a id="5441" class="Symbol">∀</a> <a id="5443" href="BitML.Contracts.Induction.html#5443" class="Bound">c</a> <a id="5445" class="Symbol">→</a> <a id="5447" href="BitML.Contracts.Induction.html#5372" class="Function">Return</a> <a id="5454" href="BitML.Contracts.Induction.html#5443" class="Bound">c</a>
  <a id="5458" href="BitML.Contracts.Induction.html#5421" class="Function">count-decorations</a> <a id="5476" href="BitML.Contracts.Induction.html#5476" class="Bound">c</a> <a id="5478" class="Symbol">=</a> <a id="5480" class="Symbol">(</a><a id="5481" href="BitML.Contracts.Induction.html#4312" class="Function">≺-rec</a> <a id="5487" class="Symbol">_</a> <a id="5489" href="BitML.Contracts.Induction.html#5660" class="Function">go</a><a id="5491" class="Symbol">)</a> <a id="5493" href="BitML.Contracts.Induction.html#5476" class="Bound">c</a> <a id="5495" class="Number">0</a>
    <a id="5501" class="Keyword">where</a>
      <a id="5513" class="Comment">-- ** AGDA BUG **</a>
      <a id="5537" class="Comment">-- cannot use `it` in the proofs ≺-put,≺-split,etc..</a>
      <a id="5596" class="Comment">-- although it type-checks, they examples stop computing...</a>
    <a id="5660" href="BitML.Contracts.Induction.html#5660" class="Function">go</a> <a id="5663" class="Symbol">:</a> <a id="5665" class="Symbol">∀</a> <a id="5667" href="BitML.Contracts.Induction.html#5667" class="Bound">c</a> <a id="5669" class="Symbol">→</a> <a id="5671" class="Symbol">(∀</a> <a id="5674" href="BitML.Contracts.Induction.html#5674" class="Bound">c′</a> <a id="5677" class="Symbol">→</a> <a id="5679" href="BitML.Contracts.Induction.html#5674" class="Bound">c′</a> <a id="5682" href="BitML.Contracts.Induction.html#3244" class="Datatype Operator">≺</a> <a id="5684" href="BitML.Contracts.Induction.html#5667" class="Bound">c</a> <a id="5686" class="Symbol">→</a> <a id="5688" href="BitML.Contracts.Induction.html#5339" class="Function">State</a> <a id="5694" href="BitML.Contracts.Induction.html#5674" class="Bound">c′</a> <a id="5697" class="Symbol">→</a> <a id="5699" href="BitML.Contracts.Induction.html#5372" class="Function">Return</a> <a id="5706" href="BitML.Contracts.Induction.html#5674" class="Bound">c′</a><a id="5708" class="Symbol">)</a> <a id="5710" class="Symbol">→</a> <a id="5712" href="BitML.Contracts.Induction.html#5339" class="Function">State</a> <a id="5718" href="BitML.Contracts.Induction.html#5667" class="Bound">c</a> <a id="5720" class="Symbol">→</a> <a id="5722" href="BitML.Contracts.Induction.html#5372" class="Function">Return</a> <a id="5729" href="BitML.Contracts.Induction.html#5667" class="Bound">c</a>
    <a id="5735" href="BitML.Contracts.Induction.html#5660" class="Function">go</a> <a id="5738" class="Symbol">(</a><a id="5739" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="5741" class="Symbol">(</a><a id="5742" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">put</a> <a id="5746" class="Symbol">_</a> <a id="5748" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">&amp;reveal</a> <a id="5756" class="Symbol">_</a> <a id="5758" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">if</a> <a id="5761" class="Symbol">_</a> <a id="5763" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">⇒</a> <a id="5765" href="BitML.Contracts.Induction.html#5765" class="Bound">cs</a><a id="5767" class="Symbol">))</a> <a id="5770" href="BitML.Contracts.Induction.html#5770" class="Bound">f</a> <a id="5772" href="BitML.Contracts.Induction.html#5772" class="Bound">st</a> <a id="5775" class="Symbol">(</a><a id="5776" href="Data.List.Relation.Unary.Any.html#1174" class="InductiveConstructor">here</a> <a id="5781" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="5785" class="Symbol">)</a> <a id="5787" class="Symbol">=</a> <a id="5789" href="BitML.Contracts.Induction.html#5772" class="Bound">st</a>
    <a id="5796" href="BitML.Contracts.Induction.html#5660" class="Function">go</a> <a id="5799" class="Symbol">(</a><a id="5800" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="5802" class="Symbol">(</a><a id="5803" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">put</a> <a id="5807" class="Symbol">_</a> <a id="5809" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">&amp;reveal</a> <a id="5817" class="Symbol">_</a> <a id="5819" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">if</a> <a id="5822" class="Symbol">_</a> <a id="5824" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">⇒</a> <a id="5826" href="BitML.Contracts.Induction.html#5826" class="Bound">cs</a><a id="5828" class="Symbol">))</a> <a id="5831" href="BitML.Contracts.Induction.html#5831" class="Bound">f</a> <a id="5833" href="BitML.Contracts.Induction.html#5833" class="Bound">st</a> <a id="5836" class="Symbol">(</a><a id="5837" href="Data.List.Relation.Unary.Any.html#1227" class="InductiveConstructor">there</a> <a id="5843" href="BitML.Contracts.Induction.html#5843" class="Bound">x∈</a><a id="5845" class="Symbol">)</a>  <a id="5848" class="Symbol">=</a> <a id="5850" href="BitML.Contracts.Induction.html#5831" class="Bound">f</a> <a id="5852" class="Symbol">(</a><a id="5853" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="5856" href="BitML.Contracts.Induction.html#5826" class="Bound">cs</a><a id="5858" class="Symbol">)</a> <a id="5860" href="BitML.Contracts.Induction.html#3357" class="InductiveConstructor">≺-put</a> <a id="5866" href="BitML.Contracts.Induction.html#5833" class="Bound">st</a> <a id="5869" href="BitML.Contracts.Induction.html#5843" class="Bound">x∈</a>
    <a id="5876" href="BitML.Contracts.Induction.html#5660" class="Function">go</a> <a id="5879" class="Symbol">(</a><a id="5880" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="5882" class="Symbol">(</a><a id="5883" href="BitML.Contracts.Types.html#946" class="InductiveConstructor">split</a> <a id="5889" href="BitML.Contracts.Induction.html#5889" class="Bound">vcs</a><a id="5892" class="Symbol">))</a>                 <a id="5911" href="BitML.Contracts.Induction.html#5911" class="Bound">f</a> <a id="5913" href="BitML.Contracts.Induction.html#5913" class="Bound">st</a> <a id="5916" class="Symbol">(</a><a id="5917" href="Data.List.Relation.Unary.Any.html#1174" class="InductiveConstructor">here</a> <a id="5922" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="5926" class="Symbol">)</a> <a id="5928" class="Symbol">=</a> <a id="5930" href="BitML.Contracts.Induction.html#5913" class="Bound">st</a>
    <a id="5937" href="BitML.Contracts.Induction.html#5660" class="Function">go</a> <a id="5940" class="Symbol">(</a><a id="5941" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="5943" class="Symbol">(</a><a id="5944" href="BitML.Contracts.Types.html#946" class="InductiveConstructor">split</a> <a id="5950" href="BitML.Contracts.Induction.html#5950" class="Bound">vcs</a><a id="5953" class="Symbol">))</a>                 <a id="5972" href="BitML.Contracts.Induction.html#5972" class="Bound">f</a> <a id="5974" href="BitML.Contracts.Induction.html#5974" class="Bound">st</a> <a id="5977" class="Symbol">(</a><a id="5978" href="Data.List.Relation.Unary.Any.html#1227" class="InductiveConstructor">there</a> <a id="5984" href="BitML.Contracts.Induction.html#5984" class="Bound">x∈</a><a id="5986" class="Symbol">)</a>  <a id="5989" class="Symbol">=</a> <a id="5991" href="BitML.Contracts.Induction.html#5972" class="Bound">f</a> <a id="5993" class="Symbol">(</a><a id="5994" href="BitML.Contracts.Induction.html#1563" class="InductiveConstructor">VCS</a> <a id="5998" href="BitML.Contracts.Induction.html#5950" class="Bound">vcs</a><a id="6001" class="Symbol">)</a> <a id="6003" href="BitML.Contracts.Induction.html#3477" class="InductiveConstructor">≺-split</a> <a id="6011" href="BitML.Contracts.Induction.html#5974" class="Bound">st</a> <a id="6014" href="BitML.Contracts.Induction.html#5984" class="Bound">x∈</a>
    <a id="6021" href="BitML.Contracts.Induction.html#5660" class="Function">go</a> <a id="6024" class="Symbol">(</a><a id="6025" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="6027" class="Symbol">(_</a> <a id="6030" href="BitML.Contracts.Types.html#1021" class="InductiveConstructor Operator">⇒</a> <a id="6032" href="BitML.Contracts.Induction.html#6032" class="Bound">c</a><a id="6033" class="Symbol">))</a>                     <a id="6056" href="BitML.Contracts.Induction.html#6056" class="Bound">f</a> <a id="6058" class="Symbol">=</a> <a id="6060" href="BitML.Contracts.Induction.html#6056" class="Bound">f</a> <a id="6062" class="Symbol">(</a><a id="6063" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="6065" href="BitML.Contracts.Induction.html#6032" class="Bound">c</a><a id="6066" class="Symbol">)</a> <a id="6068" href="BitML.Contracts.Induction.html#3411" class="InductiveConstructor">≺-auth</a> <a id="6075" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="6077" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a>
    <a id="6085" href="BitML.Contracts.Induction.html#5660" class="Function">go</a> <a id="6088" class="Symbol">(</a><a id="6089" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="6091" class="Symbol">(</a><a id="6092" href="BitML.Contracts.Types.html#1094" class="InductiveConstructor Operator">after</a> <a id="6098" class="Symbol">_</a> <a id="6100" href="BitML.Contracts.Types.html#1094" class="InductiveConstructor Operator">⇒</a> <a id="6102" href="BitML.Contracts.Induction.html#6102" class="Bound">c</a><a id="6103" class="Symbol">))</a>               <a id="6120" href="BitML.Contracts.Induction.html#6120" class="Bound">f</a> <a id="6122" class="Symbol">=</a> <a id="6124" href="BitML.Contracts.Induction.html#6120" class="Bound">f</a> <a id="6126" class="Symbol">(</a><a id="6127" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="6129" href="BitML.Contracts.Induction.html#6102" class="Bound">c</a><a id="6130" class="Symbol">)</a> <a id="6132" href="BitML.Contracts.Induction.html#3441" class="InductiveConstructor">≺-after</a> <a id="6140" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="6142" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a>
    <a id="6150" href="BitML.Contracts.Induction.html#5660" class="Function">go</a> <a id="6153" class="Symbol">(</a><a id="6154" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="6156" class="Symbol">(</a><a id="6157" href="BitML.Contracts.Types.html#886" class="InductiveConstructor">withdraw</a> <a id="6166" class="Symbol">_))</a>                <a id="6185" class="Symbol">_</a> <a id="6187" href="BitML.Contracts.Induction.html#6187" class="Bound">st</a> <a id="6190" class="Symbol">(</a><a id="6191" href="Data.List.Relation.Unary.Any.html#1174" class="InductiveConstructor">here</a> <a id="6196" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="6200" class="Symbol">)</a> <a id="6202" class="Symbol">=</a> <a id="6204" href="BitML.Contracts.Induction.html#6187" class="Bound">st</a>
    <a id="6211" href="BitML.Contracts.Induction.html#5660" class="Function">go</a> <a id="6214" class="Symbol">(</a><a id="6215" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="6218" href="BitML.Contracts.Induction.html#6218" class="Bound">cs</a><a id="6220" class="Symbol">)</a>   <a id="6224" href="BitML.Contracts.Induction.html#6224" class="Bound">f</a> <a id="6226" href="BitML.Contracts.Induction.html#6226" class="Bound">st</a> <a id="6229" class="Symbol">=</a> <a id="6231" href="BitML.Contracts.Induction.html#4814" class="Function">↦-∈</a> <a id="6235" class="Symbol">λ</a> <a id="6237" class="Symbol">{</a><a id="6238" href="BitML.Contracts.Induction.html#6238" class="Bound">d</a><a id="6239" class="Symbol">}</a> <a id="6241" href="BitML.Contracts.Induction.html#6241" class="Bound">d∈</a> <a id="6244" class="Symbol">→</a> <a id="6246" href="BitML.Contracts.Induction.html#6224" class="Bound">f</a> <a id="6248" class="Symbol">(</a><a id="6249" href="BitML.Contracts.Induction.html#1520" class="InductiveConstructor">C</a> <a id="6251" href="BitML.Contracts.Induction.html#6238" class="Bound">d</a><a id="6252" class="Symbol">)</a> <a id="6254" class="Symbol">(</a><a id="6255" href="BitML.Contracts.Induction.html#3268" class="InductiveConstructor">≺-∈</a> <a id="6259" href="BitML.Contracts.Induction.html#6241" class="Bound">d∈</a><a id="6261" class="Symbol">)</a> <a id="6263" href="BitML.Contracts.Induction.html#6226" class="Bound">st</a>
    <a id="6270" href="BitML.Contracts.Induction.html#5660" class="Function">go</a> <a id="6273" class="Symbol">(</a><a id="6274" href="BitML.Contracts.Induction.html#1563" class="InductiveConstructor">VCS</a> <a id="6278" href="BitML.Contracts.Induction.html#6278" class="Bound">vcs</a><a id="6281" class="Symbol">)</a> <a id="6283" href="BitML.Contracts.Induction.html#6283" class="Bound">f</a> <a id="6285" href="BitML.Contracts.Induction.html#6285" class="Bound">st</a> <a id="6288" class="Symbol">=</a> <a id="6290" href="BitML.Contracts.Induction.html#5031" class="Function">↦-∈ᵛ</a> <a id="6295" class="Symbol">λ</a> <a id="6297" class="Symbol">{</a><a id="6298" href="BitML.Contracts.Induction.html#6298" class="Bound">cs</a><a id="6300" class="Symbol">}</a> <a id="6302" href="BitML.Contracts.Induction.html#6302" class="Bound">cs∈</a> <a id="6306" class="Symbol">→</a> <a id="6308" href="BitML.Contracts.Induction.html#6283" class="Bound">f</a> <a id="6310" class="Symbol">(</a><a id="6311" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="6314" href="BitML.Contracts.Induction.html#6298" class="Bound">cs</a><a id="6316" class="Symbol">)</a> <a id="6318" class="Symbol">(</a><a id="6319" href="BitML.Contracts.Induction.html#3298" class="InductiveConstructor">≺-∈ᵛ</a> <a id="6324" href="BitML.Contracts.Induction.html#6302" class="Bound">cs∈</a><a id="6327" class="Symbol">)</a> <a id="6329" href="BitML.Contracts.Induction.html#6285" class="Bound">st</a>

  <a id="6335" class="Keyword">module</a> <a id="Ex"></a><a id="6342" href="BitML.Contracts.Induction.html#6342" class="Module">Ex</a> <a id="6345" class="Symbol">(</a><a id="6346" href="BitML.Contracts.Induction.html#6346" class="Bound">A</a> <a id="6348" href="BitML.Contracts.Induction.html#6348" class="Bound">B</a> <a id="6350" class="Symbol">:</a> <a id="6352" href="BitML.Contracts.Induction.html#371" class="Bound">Participant</a><a id="6363" class="Symbol">)</a> <a id="6365" class="Keyword">where</a>

    <a id="Ex.vcs&#39;"></a><a id="6376" href="BitML.Contracts.Induction.html#6376" class="Function">vcs&#39;</a> <a id="6381" class="Symbol">:</a> <a id="6383" href="BitML.Contracts.Types.html#675" class="Function">VContracts</a>
    <a id="6398" href="BitML.Contracts.Induction.html#6376" class="Function">vcs&#39;</a> <a id="6403" class="Symbol">=</a> <a id="6405" class="Number">2</a> <a id="6407" href="BitML.Contracts.Types.html#1401" class="Function Operator">⊸</a> <a id="6409" class="Symbol">(</a><a id="6410" href="BitML.Contracts.Types.html#886" class="InductiveConstructor">withdraw</a> <a id="6419" href="BitML.Contracts.Induction.html#6346" class="Bound">A</a> <a id="6421" href="BitML.Contracts.Types.html#1361" class="Function Operator">∙</a><a id="6422" class="Symbol">)</a>
         <a id="6433" href="BitML.Contracts.Types.html#1310" class="Function Operator">⊕</a> <a id="6435" class="Number">3</a> <a id="6437" href="BitML.Contracts.Types.html#1401" class="Function Operator">⊸</a> <a id="6439" class="Symbol">(</a><a id="6440" href="BitML.Contracts.Types.html#1094" class="InductiveConstructor Operator">after</a> <a id="6446" class="Number">100</a> <a id="6450" href="BitML.Contracts.Types.html#1094" class="InductiveConstructor Operator">⇒</a> <a id="6452" href="BitML.Contracts.Types.html#886" class="InductiveConstructor">withdraw</a> <a id="6461" href="BitML.Contracts.Induction.html#6348" class="Bound">B</a> <a id="6463" href="BitML.Contracts.Types.html#1361" class="Function Operator">∙</a><a id="6464" class="Symbol">)</a>
         <a id="6475" href="BitML.Contracts.Types.html#1361" class="Function Operator">∙</a>

    <a id="Ex.cs"></a><a id="6482" href="BitML.Contracts.Induction.html#6482" class="Function">cs</a> <a id="6485" class="Symbol">:</a> <a id="6487" href="BitML.Contracts.Types.html#649" class="Function">Contracts</a>
    <a id="6501" href="BitML.Contracts.Induction.html#6482" class="Function">cs</a> <a id="6504" class="Symbol">=</a> <a id="6506" href="BitML.Contracts.Induction.html#6346" class="Bound">A</a> <a id="6508" href="BitML.Contracts.Types.html#1021" class="InductiveConstructor Operator">⇒</a> <a id="6510" href="BitML.Contracts.Types.html#886" class="InductiveConstructor">withdraw</a> <a id="6519" href="BitML.Contracts.Induction.html#6348" class="Bound">B</a>
       <a id="6528" href="BitML.Contracts.Types.html#1310" class="Function Operator">⊕</a> <a id="6530" href="BitML.Contracts.Induction.html#6348" class="Bound">B</a> <a id="6532" href="BitML.Contracts.Types.html#1021" class="InductiveConstructor Operator">⇒</a> <a id="6534" href="BitML.Contracts.Types.html#946" class="InductiveConstructor">split</a> <a id="6540" href="BitML.Contracts.Induction.html#6376" class="Function">vcs&#39;</a>
       <a id="6552" href="BitML.Contracts.Types.html#1361" class="Function Operator">∙</a>

    <a id="6559" href="BitML.Contracts.Induction.html#6559" class="Function">_</a> <a id="6561" class="Symbol">:</a> <a id="6563" href="BitML.Contracts.Induction.html#1623" class="Function">subterms⁺</a> <a id="6573" class="Symbol">(</a><a id="6574" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="6577" href="BitML.Contracts.Induction.html#6482" class="Function">cs</a><a id="6579" class="Symbol">)</a> <a id="6581" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6583" href="Prelude.Nary.html#158" class="Function Operator">⟦</a> <a id="6585" href="BitML.Contracts.Types.html#886" class="InductiveConstructor">withdraw</a> <a id="6594" href="BitML.Contracts.Induction.html#6348" class="Bound">B</a> <a id="6596" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6598" href="BitML.Contracts.Types.html#946" class="InductiveConstructor">split</a> <a id="6604" href="BitML.Contracts.Induction.html#6376" class="Function">vcs&#39;</a> <a id="6609" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6611" href="BitML.Contracts.Types.html#886" class="InductiveConstructor">withdraw</a> <a id="6620" href="BitML.Contracts.Induction.html#6346" class="Bound">A</a> <a id="6622" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6624" href="BitML.Contracts.Types.html#886" class="InductiveConstructor">withdraw</a> <a id="6633" href="BitML.Contracts.Induction.html#6348" class="Bound">B</a> <a id="6635" href="Prelude.Nary.html#158" class="Function Operator">⟧</a>
    <a id="6641" class="Symbol">_</a> <a id="6643" class="Symbol">=</a> <a id="6645" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

    <a id="6655" href="BitML.Contracts.Induction.html#6655" class="Function">_</a> <a id="6657" class="Symbol">:</a> <a id="6659" href="Prelude.Lists.html#10396" class="Function">codom</a> <a id="6665" class="Symbol">(</a><a id="6666" href="BitML.Contracts.Induction.html#5421" class="Function">count-decorations</a> <a id="6684" class="Symbol">(</a><a id="6685" href="BitML.Contracts.Induction.html#1541" class="InductiveConstructor">CS</a> <a id="6688" href="BitML.Contracts.Induction.html#6482" class="Function">cs</a><a id="6690" class="Symbol">))</a> <a id="6693" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6695" href="Prelude.Nary.html#158" class="Function Operator">⟦</a> <a id="6697" class="Number">1</a> <a id="6699" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6701" class="Number">1</a> <a id="6703" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6705" class="Number">1</a> <a id="6707" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6709" class="Number">2</a> <a id="6711" href="Prelude.Nary.html#158" class="Function Operator">⟧</a>
    <a id="6717" class="Symbol">_</a> <a id="6719" class="Symbol">=</a> <a id="6721" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="6727" class="Comment">{-
  collect : ∀ c → subterms⁺ c ↦ ℕ → List ℕ
  collect (C (put _ &amp;reveal _ if _ ⇒ cs)) f = f (here refl) ∷ collect (CS cs) (f ∘ there)
  collect (C (split vcs))                 f = f (here refl) ∷ collect (VCS vcs) (f ∘ there)
  collect (C (withdraw _))                f = [ f (here refl) ]
  collect (C (_ ⇒ c))       = collect (C c)
  collect (C (after _ ⇒ c)) = collect (C c)
  collect (CS [])       _ = []
  collect (CS (c ∷ cs)) f = collect (C c) (f ∘ ∈-++⁺ˡ) ++ collect (CS cs) (f ∘ ∈-++⁺ʳ _)
  collect (VCS [])               _ = []
  collect (VCS ((_ , cs) ∷ vcs)) f = collect (CS cs) (f ∘ ∈-++⁺ˡ) ++ collect (VCS vcs) (f ∘ ∈-++⁺ʳ _)
-}</a>

<a id="7373" class="Comment">{-
record RecState : Set where
  field
    Dₚ,T,o : Contract × HashId × N
    v : Value
    P,t : List Participant × Time


rec : ∀ {X : Set} {{_ : Semigroup X}}

  → (c : ℂ)

  -- → (f-withdraw : Participant → X)
  -- → ()

    --------------
  → subterms c ↦ X
rec {X = X} c = goo _ (≺-wf c)
  where
    goo : (c : ℂ) → Acc _≺_ c → subterms c ↦ X
    goo c (acc a) = {!!}

-}</a>

<a id="7752" class="Comment">{-
data _≺_ : Rel ℂ 0ℓ where

  ≺-∈ :
      d ∈ ds
      -----------
    → C d ≺ CS ds

  ≺-∈ᵛ :
      ds ∈ map proj₂ vcs
      ------------------
    → CS ds ≺ VCS vcs

  ≺-put :
      ---------------------------------------
      CS ds ≺ C (put xs &amp;reveal as if p ⇒ ds)

  ≺-auth :
      ---------------
      C d ≺ C (A ⇒ d)

  ≺-after :
      ---------------------
      C d ≺ C (after t ⇒ d)

  ≺-split :
      -----------------------
      VCS vcs ≺ C (split vcs)

  ≺-trans : ∀ {c c′ c″ }
    → c ≺ c′
    → c′ ≺ c″
      -------
    → c ≺ c″

step-≺ : ∀ c {c′ c″} → c ≺ c′ → c′ ≺ c″ → c ≺ c″
step-≺ _ = ≺-trans

stop-≺ : ∀ c {c′} → c ≺ c′ → c ≺ c′
stop-≺ _ x = x

infixr 2 step-≺
infix  3 stop-≺
syntax step-≺ x x&lt;y y∼z = x ≺⟨ x&lt;y ⟩ y∼z
syntax stop-≺ x x&lt;y = x ≺⟨ x&lt;y ⟩∎

module Ex (A B : Participant) where

  cs : Contracts
  cs = A ⇒ withdraw B
     ⊕ B ⇒ split ( 2 ⊸ (withdraw A ∙)
                 ⊕ 3 ⊸ (after 100 ⇒ withdraw B ∙)
                 ⊕ 0 ⊸ (put [ &quot;y&quot; ] ⇒ (A ⇒ withdraw B ∙) ∙)
                 ∙)
     ∙

  _ : C (withdraw B) ≺ CS cs
  _ =
      C (withdraw B)
    ≺⟨ ≺-after ⟩
      C (after 100 ⇒ withdraw B)
    ≺⟨ ≺-∈ (here refl) ⟩
      CS (after 100 ⇒ withdraw B ∙)
    ≺⟨ ≺-∈ᵛ (there (here refl)) ⟩
      VCS ( 2 ⊸ (withdraw A ∙)
          ⊕ 3 ⊸ (after 100 ⇒ withdraw B ∙)
          ⊕ 0 ⊸ (put [ &quot;y&quot; ] ⇒ (A ⇒ withdraw B ∙) ∙)
          ∙)
    ≺⟨ ≺-split ⟩
      C (split ( 2 ⊸ (withdraw A ∙)
               ⊕ 3 ⊸ (after 100 ⇒ withdraw B ∙)
               ⊕ 0 ⊸ (put [ &quot;y&quot; ] ⇒ (A ⇒ withdraw B ∙) ∙)
               ∙))
    ≺⟨ ≺-auth ⟩
      C (B ⇒ split ( 2 ⊸ (withdraw A ∙)
                   ⊕ 3 ⊸ (after 100 ⇒ withdraw B ∙)
                   ⊕ 0 ⊸ (put [ &quot;y&quot; ] ⇒ (A ⇒ withdraw B ∙) ∙)
                   ∙))
    ≺⟨ ≺-∈ (there (here refl)) ⟩∎

  _ : C (withdraw B) ≺ CS cs
  _ = {!!}
-}</a>


<a id="9576" class="Comment">{-
get-v : ∀ {c′ : ℂ}
  → c′ ≺ CS c
  → Value
get-v = ?

rec′ : ∀ {X : Set} {{_ : Monoid X}}

  → ValidAdvertisement (⟨ g ⟩ c)

  → (f-withdraw : Participant → X)
  → ()
    -----------------------
  → (∀ c′ → c′ ≺ CS c → X)
rec′ {g = g} {c = c} vad f-withdraw
  with c
... |

rec : ∀ {X : Set} {{_ : Monoid X}}
    ...
    -----------------------
  → X
rec ... = fold ∘ rec′ ....
-}</a>

<a id="9961" class="Comment">{-

_∈ℂ_ : Rel ℂ 0ℓ
C c   ∈ℂ CS cs   = c ∈ cs
C c   ∈ℂ VCS vcs = ∃ λ cs → (C c ∈ℂ CS cs) × (CS cs ∈ℂ VCS vcs)
CS cs ∈ℂ VCS vcs = cs ∈ map proj₂ vcs
_     ∈ℂ _       = ⊥

_≺_ : Rel ℂ 0ℓ
CS cs   ≺ C (put _ &amp;reveal _ if _ ⇒ cs′) = cs ≡ cs′
VCS vcs ≺ C (split vcs′)                 = vcs ≡ vcs′
C c     ≺ C (_ ⇒ c′)                     = c ≡ c′
C c     ≺ C (after _ ⇒ c′)               = c ≡ c′
c       ≺ c′                             = c ∈ℂ c′
-}</a>

<a id="10407" class="Comment">{-
≺-wf : WellFounded _≺_
≺-wf = acc ∘ flip _≻_
  where
    _≻_ : ∀ c′ c → c′ ≺ c → Acc _≺_ c′
    (CS cs   ≻ C (put _ &amp;reveal _ if _ ⇒ .cs) ) refl = acc (_≻ CS cs)
    (VCS vcs ≻ C (split .vcs)  )                refl = acc (_≻ VCS vcs)
    (C c     ≻ C (_ ⇒ .c)      )                refl = acc (_≻ C c)
    (C c     ≻ C (after _ ⇒ .c))                refl = acc (_≻ C c)

    (C c ≻ CS (.c ∷ _)) (here refl) = acc (_≻ C c)
    (C c ≻ CS (_ ∷ cs)) (there c∈)  = (C c ≻ CS cs) c∈

    (C c ≻ VCS ((v , .cs) ∷ vcs)) (cs , c∈ , here refl) = (C c ≻ CS cs) c∈
    (C c ≻ VCS (_ ∷ vcs))         (cs , c∈ , there cs∈) = (C c ≻ VCS vcs) (cs , c∈ , cs∈)

    (CS cs ≻ VCS ((v , .cs) ∷ vcs)) (here refl) = acc (_≻ CS cs)
    (CS cs ≻ VCS ((v , _)   ∷ vcs)) (there cs∈) = (CS cs ≻ VCS vcs) cs∈
-}</a>
</pre></body></html>