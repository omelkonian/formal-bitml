<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>BitML.Example.Contracts</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-bitml/tree/master/BitML/Example/Contracts.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Examples of BitML contracts/advertisements.</a>
<a id="121" class="Comment">------------------------------------------------------------------------</a>

<a id="195" class="Keyword">module</a> <a id="202" href="BitML.Example.Contracts.html" class="Module">BitML.Example.Contracts</a> <a id="226" class="Keyword">where</a>

<a id="233" class="Keyword">open</a> <a id="238" class="Keyword">import</a> <a id="245" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="255" class="Keyword">using</a> <a id="261" class="Symbol">(</a><a id="262" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="264" class="Symbol">)</a>
<a id="266" class="Keyword">open</a> <a id="271" class="Keyword">import</a> <a id="278" href="Data.List.html" class="Module">Data.List</a> <a id="288" class="Keyword">using</a> <a id="294" class="Symbol">(</a><a id="295" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="299" class="Symbol">;</a> <a id="301" href="Data.List.Base.html#10383" class="InductiveConstructor">[]</a><a id="303" class="Symbol">;</a> <a id="305" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="308" class="Symbol">;</a> <a id="310" href="Data.List.Base.html#5025" class="Function Operator">[_]</a><a id="313" class="Symbol">)</a>
<a id="315" class="Keyword">open</a> <a id="320" class="Keyword">import</a> <a id="327" href="Data.List.Relation.Unary.Any.html" class="Module">Data.List.Relation.Unary.Any</a> <a id="356" class="Keyword">using</a> <a id="362" class="Symbol">(</a><a id="363" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a><a id="367" class="Symbol">;</a> <a id="369" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a><a id="374" class="Symbol">)</a>

<a id="377" class="Keyword">open</a> <a id="382" class="Keyword">import</a> <a id="389" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="427" class="Keyword">using</a> <a id="433" class="Symbol">(</a><a id="434" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="437" class="Symbol">;</a> <a id="439" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="443" class="Symbol">)</a>
<a id="445" class="Keyword">import</a> <a id="452" href="Data.List.Relation.Binary.Sublist.Heterogeneous.html" class="Module">Data.List.Relation.Binary.Sublist.Heterogeneous</a> <a id="500" class="Symbol">as</a> <a id="503" class="Module">SB</a>

<a id="507" class="Comment">--------------------------------------------------------------------------------</a>

<a id="589" class="Keyword">open</a> <a id="594" class="Keyword">import</a> <a id="601" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>

<a id="616" class="Keyword">open</a> <a id="621" class="Keyword">import</a> <a id="628" href="BitML.Example.Setup.html" class="Module">BitML.Example.Setup</a>

<a id="649" class="Keyword">open</a> <a id="654" class="Keyword">import</a> <a id="661" href="BitML.BasicTypes.html" class="Module">BitML.BasicTypes</a>
<a id="678" class="Keyword">open</a> <a id="683" class="Keyword">import</a> <a id="690" href="BitML.Predicate.html" class="Module">BitML.Predicate</a>
<a id="706" class="Keyword">open</a> <a id="711" class="Keyword">import</a> <a id="718" href="BitML.Contracts.Types.html" class="Module">BitML.Contracts.Types</a> <a id="740" href="BitML.Example.Setup.html#208" class="Datatype">Participant</a> <a id="752" href="BitML.Example.Setup.html#318" class="Function">Honest</a> <a id="759" class="Keyword">hiding</a> <a id="766" class="Symbol">(</a><a id="767" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a><a id="768" class="Symbol">;</a> <a id="770" href="BitML.Contracts.Types.html#517" class="Generalizable">B</a><a id="771" class="Symbol">)</a>

<a id="774" class="Comment">--------------------------------------------------------------------------------</a>

<a id="ex-contracts₁"></a><a id="856" href="BitML.Example.Contracts.html#856" class="Function">ex-contracts₁</a> <a id="870" class="Symbol">:</a> <a id="872" href="BitML.Contracts.Types.html#647" class="Function">Contracts</a>
<a id="882" href="BitML.Example.Contracts.html#856" class="Function">ex-contracts₁</a> <a id="896" class="Symbol">=</a> <a id="898" href="BitML.Contracts.Types.html#884" class="InductiveConstructor">withdraw</a> <a id="907" href="BitML.Example.Setup.html#234" class="InductiveConstructor">A</a> <a id="909" href="BitML.Contracts.Types.html#1452" class="Function Operator">∙</a>

<a id="ex-contracts₂"></a><a id="912" href="BitML.Example.Contracts.html#912" class="Function">ex-contracts₂</a> <a id="926" class="Symbol">:</a> <a id="928" href="BitML.Contracts.Types.html#647" class="Function">Contracts</a>
<a id="938" href="BitML.Example.Contracts.html#912" class="Function">ex-contracts₂</a> <a id="952" class="Symbol">=</a> <a id="954" href="BitML.Example.Setup.html#234" class="InductiveConstructor">A</a> <a id="956" href="BitML.Contracts.Types.html#1097" class="InductiveConstructor Operator">⇒</a> <a id="958" href="BitML.Contracts.Types.html#884" class="InductiveConstructor">withdraw</a> <a id="967" href="BitML.Example.Setup.html#234" class="InductiveConstructor">A</a>
              <a id="983" href="BitML.Contracts.Types.html#1401" class="Function Operator">⊕</a> <a id="985" href="BitML.Contracts.Types.html#1619" class="InductiveConstructor Operator">put</a> <a id="989" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="992" href="BitML.Contracts.Types.html#1619" class="InductiveConstructor Operator">⇒</a> <a id="994" class="Symbol">(</a><a id="995" href="BitML.Contracts.Types.html#884" class="InductiveConstructor">withdraw</a> <a id="1004" href="BitML.Example.Setup.html#234" class="InductiveConstructor">A</a> <a id="1006" href="BitML.Contracts.Types.html#1452" class="Function Operator">∙</a><a id="1007" class="Symbol">)</a>
              <a id="1023" href="BitML.Contracts.Types.html#1452" class="Function Operator">∙</a>

<a id="ex-contracts₃"></a><a id="1026" href="BitML.Example.Contracts.html#1026" class="Function">ex-contracts₃</a> <a id="1040" class="Symbol">:</a> <a id="1042" href="BitML.Contracts.Types.html#647" class="Function">Contracts</a>
<a id="1052" href="BitML.Example.Contracts.html#1026" class="Function">ex-contracts₃</a> <a id="1066" class="Symbol">=</a> <a id="1068" href="BitML.Contracts.Types.html#1619" class="InductiveConstructor Operator">put</a> <a id="1072" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1074" class="String">&quot;x&quot;</a> <a id="1078" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="1080" href="BitML.Contracts.Types.html#1619" class="InductiveConstructor Operator">⇒</a> <a id="1082" class="Symbol">(</a><a id="1083" href="BitML.Contracts.Types.html#884" class="InductiveConstructor">withdraw</a> <a id="1092" href="BitML.Example.Setup.html#234" class="InductiveConstructor">A</a> <a id="1094" href="BitML.Contracts.Types.html#1452" class="Function Operator">∙</a><a id="1095" class="Symbol">)</a>
              <a id="1111" href="BitML.Contracts.Types.html#1452" class="Function Operator">∙</a>

<a id="ex-contracts₄"></a><a id="1114" href="BitML.Example.Contracts.html#1114" class="Function">ex-contracts₄</a> <a id="1128" class="Symbol">:</a> <a id="1130" href="BitML.Contracts.Types.html#647" class="Function">Contracts</a>
<a id="1140" href="BitML.Example.Contracts.html#1114" class="Function">ex-contracts₄</a> <a id="1154" class="Symbol">=</a> <a id="1156" href="BitML.Example.Setup.html#234" class="InductiveConstructor">A</a> <a id="1158" href="BitML.Contracts.Types.html#1097" class="InductiveConstructor Operator">⇒</a> <a id="1160" href="BitML.Contracts.Types.html#884" class="InductiveConstructor">withdraw</a> <a id="1169" href="BitML.Example.Setup.html#236" class="InductiveConstructor">B</a>
              <a id="1185" href="BitML.Contracts.Types.html#1401" class="Function Operator">⊕</a> <a id="1187" href="BitML.Example.Setup.html#236" class="InductiveConstructor">B</a> <a id="1189" href="BitML.Contracts.Types.html#1097" class="InductiveConstructor Operator">⇒</a> <a id="1191" href="BitML.Contracts.Types.html#1022" class="InductiveConstructor">split</a> <a id="1197" class="Symbol">(</a> <a id="1199" class="Number">2</a> <a id="1201" href="BitML.Contracts.Types.html#1492" class="Function Operator">⊸</a> <a id="1203" class="Symbol">(</a><a id="1204" href="BitML.Contracts.Types.html#884" class="InductiveConstructor">withdraw</a> <a id="1213" href="BitML.Example.Setup.html#234" class="InductiveConstructor">A</a> <a id="1215" href="BitML.Contracts.Types.html#1452" class="Function Operator">∙</a><a id="1216" class="Symbol">)</a>
                          <a id="1244" href="BitML.Contracts.Types.html#1401" class="Function Operator">⊕</a> <a id="1246" class="Number">3</a> <a id="1248" href="BitML.Contracts.Types.html#1492" class="Function Operator">⊸</a> <a id="1250" class="Symbol">(</a><a id="1251" href="BitML.Contracts.Types.html#1170" class="InductiveConstructor Operator">after</a> <a id="1257" class="Number">100</a> <a id="1261" href="BitML.Contracts.Types.html#1170" class="InductiveConstructor Operator">⇒</a> <a id="1263" href="BitML.Contracts.Types.html#884" class="InductiveConstructor">withdraw</a> <a id="1272" href="BitML.Example.Setup.html#236" class="InductiveConstructor">B</a> <a id="1274" href="BitML.Contracts.Types.html#1452" class="Function Operator">∙</a><a id="1275" class="Symbol">)</a>
                          <a id="1303" href="BitML.Contracts.Types.html#1401" class="Function Operator">⊕</a> <a id="1305" class="Number">0</a> <a id="1307" href="BitML.Contracts.Types.html#1492" class="Function Operator">⊸</a> <a id="1309" class="Symbol">(</a><a id="1310" href="BitML.Contracts.Types.html#1619" class="InductiveConstructor Operator">put</a> <a id="1314" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1316" class="String">&quot;y&quot;</a> <a id="1320" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="1322" href="BitML.Contracts.Types.html#1619" class="InductiveConstructor Operator">⇒</a> <a id="1324" class="Symbol">(</a><a id="1325" href="BitML.Example.Setup.html#234" class="InductiveConstructor">A</a> <a id="1327" href="BitML.Contracts.Types.html#1097" class="InductiveConstructor Operator">⇒</a> <a id="1329" href="BitML.Contracts.Types.html#884" class="InductiveConstructor">withdraw</a> <a id="1338" href="BitML.Example.Setup.html#236" class="InductiveConstructor">B</a> <a id="1340" href="BitML.Contracts.Types.html#1452" class="Function Operator">∙</a><a id="1341" class="Symbol">)</a> <a id="1343" href="BitML.Contracts.Types.html#1452" class="Function Operator">∙</a><a id="1344" class="Symbol">)</a>
                          <a id="1372" href="BitML.Contracts.Types.html#1452" class="Function Operator">∙</a><a id="1373" class="Symbol">)</a>
              <a id="1389" href="BitML.Contracts.Types.html#1452" class="Function Operator">∙</a>


<a id="1393" class="Comment">-- see BitML paper, Section 2</a>
<a id="pay-or-refund"></a><a id="1423" href="BitML.Example.Contracts.html#1423" class="Function">pay-or-refund</a> <a id="1437" class="Symbol">:</a> <a id="1439" href="BitML.Contracts.Types.html#2400" class="Record">Advertisement</a>
<a id="1453" href="BitML.Example.Contracts.html#1423" class="Function">pay-or-refund</a> <a id="1467" class="Symbol">=</a> <a id="1469" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟨</a> <a id="1471" href="BitML.Example.Setup.html#234" class="InductiveConstructor">A</a> <a id="1473" href="BitML.Contracts.Types.html#1950" class="InductiveConstructor Operator">:!</a> <a id="1476" class="Number">1</a> <a id="1478" href="BitML.Contracts.Types.html#1950" class="InductiveConstructor Operator">at</a> <a id="1481" class="String">&quot;x&quot;</a> <a id="1485" href="BitML.Contracts.Types.html#2125" class="InductiveConstructor Operator">∣∣</a> <a id="1488" href="BitML.Example.Setup.html#236" class="InductiveConstructor">B</a> <a id="1490" href="BitML.Contracts.Types.html#1950" class="InductiveConstructor Operator">:!</a> <a id="1493" class="Number">0</a> <a id="1495" href="BitML.Contracts.Types.html#1950" class="InductiveConstructor Operator">at</a> <a id="1498" class="String">&quot;y&quot;</a> <a id="1502" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟩</a>
                <a id="1520" class="Symbol">(</a> <a id="1522" href="BitML.Example.Setup.html#234" class="InductiveConstructor">A</a> <a id="1524" href="BitML.Contracts.Types.html#1097" class="InductiveConstructor Operator">⇒</a> <a id="1526" href="BitML.Contracts.Types.html#884" class="InductiveConstructor">withdraw</a> <a id="1535" href="BitML.Example.Setup.html#236" class="InductiveConstructor">B</a>
                <a id="1553" href="BitML.Contracts.Types.html#1401" class="Function Operator">⊕</a> <a id="1555" href="BitML.Example.Setup.html#236" class="InductiveConstructor">B</a> <a id="1557" href="BitML.Contracts.Types.html#1097" class="InductiveConstructor Operator">⇒</a> <a id="1559" href="BitML.Contracts.Types.html#884" class="InductiveConstructor">withdraw</a> <a id="1568" href="BitML.Example.Setup.html#234" class="InductiveConstructor">A</a>
                <a id="1586" href="BitML.Contracts.Types.html#1452" class="Function Operator">∙</a><a id="1587" class="Symbol">)</a>


<a id="ex-ad"></a><a id="1591" href="BitML.Example.Contracts.html#1591" class="Function">ex-ad</a> <a id="1597" class="Symbol">:</a> <a id="1599" href="BitML.Contracts.Types.html#2400" class="Record">Advertisement</a>
<a id="1613" href="BitML.Example.Contracts.html#1591" class="Function">ex-ad</a> <a id="1619" class="Symbol">=</a> <a id="1621" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟨</a> <a id="1623" href="BitML.Example.Setup.html#236" class="InductiveConstructor">B</a> <a id="1625" href="BitML.Contracts.Types.html#1950" class="InductiveConstructor Operator">:!</a> <a id="1628" class="Number">2</a> <a id="1630" href="BitML.Contracts.Types.html#1950" class="InductiveConstructor Operator">at</a> <a id="1633" class="String">&quot;x&quot;</a> <a id="1637" href="BitML.Contracts.Types.html#2125" class="InductiveConstructor Operator">∣∣</a> <a id="1640" href="BitML.Example.Setup.html#234" class="InductiveConstructor">A</a> <a id="1642" href="BitML.Contracts.Types.html#1950" class="InductiveConstructor Operator">:!</a> <a id="1645" class="Number">3</a> <a id="1647" href="BitML.Contracts.Types.html#1950" class="InductiveConstructor Operator">at</a> <a id="1650" class="String">&quot;y&quot;</a> <a id="1654" href="BitML.Contracts.Types.html#2125" class="InductiveConstructor Operator">∣∣</a> <a id="1657" href="BitML.Example.Setup.html#234" class="InductiveConstructor">A</a> <a id="1659" href="BitML.Contracts.Types.html#1873" class="InductiveConstructor Operator">:?</a> <a id="1662" class="Number">100</a> <a id="1666" href="BitML.Contracts.Types.html#1873" class="InductiveConstructor Operator">at</a> <a id="1669" class="String">&quot;z&quot;</a> <a id="1673" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟩</a> <a id="1675" href="BitML.Example.Contracts.html#1026" class="Function">ex-contracts₃</a>
</pre></body></html>