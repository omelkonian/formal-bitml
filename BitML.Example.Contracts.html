<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>BitML.Example.Contracts</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-bitml/tree/master/BitML/Example/Contracts.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Examples of BitML contracts/advertisements.</a>
<a id="121" class="Comment">------------------------------------------------------------------------</a>

<a id="195" class="Keyword">module</a> <a id="202" href="BitML.Example.Contracts.html" class="Module">BitML.Example.Contracts</a> <a id="226" class="Keyword">where</a>

<a id="233" class="Keyword">open</a> <a id="238" class="Keyword">import</a> <a id="245" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="255" class="Keyword">using</a> <a id="261" class="Symbol">(</a><a id="262" href="Agda.Builtin.Unit.html#195" class="InductiveConstructor">tt</a><a id="264" class="Symbol">)</a>
<a id="266" class="Keyword">open</a> <a id="271" class="Keyword">import</a> <a id="278" href="Data.List.html" class="Module">Data.List</a> <a id="288" class="Keyword">using</a> <a id="294" class="Symbol">(</a><a id="295" href="Agda.Builtin.List.html#130" class="Datatype">List</a><a id="299" class="Symbol">;</a> <a id="301" href="Data.List.Base.html#10392" class="InductiveConstructor">[]</a><a id="303" class="Symbol">;</a> <a id="305" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">_∷_</a><a id="308" class="Symbol">;</a> <a id="310" href="Data.List.Base.html#5034" class="Function Operator">[_]</a><a id="313" class="Symbol">)</a>
<a id="315" class="Keyword">open</a> <a id="320" class="Keyword">import</a> <a id="327" href="Data.List.Relation.Unary.Any.html" class="Module">Data.List.Relation.Unary.Any</a> <a id="356" class="Keyword">using</a> <a id="362" class="Symbol">(</a><a id="363" href="Data.List.Relation.Unary.Any.html#1228" class="InductiveConstructor">here</a><a id="367" class="Symbol">;</a> <a id="369" href="Data.List.Relation.Unary.Any.html#1281" class="InductiveConstructor">there</a><a id="374" class="Symbol">)</a>

<a id="377" class="Keyword">open</a> <a id="382" class="Keyword">import</a> <a id="389" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="427" class="Keyword">using</a> <a id="433" class="Symbol">(</a><a id="434" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a><a id="437" class="Symbol">;</a> <a id="439" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="443" class="Symbol">)</a>
<a id="445" class="Keyword">import</a> <a id="452" href="Data.List.Relation.Binary.Sublist.Heterogeneous.html" class="Module">Data.List.Relation.Binary.Sublist.Heterogeneous</a> <a id="500" class="Symbol">as</a> <a id="503" class="Module">SB</a>

<a id="507" class="Comment">--------------------------------------------------------------------------------</a>

<a id="589" class="Keyword">open</a> <a id="594" class="Keyword">import</a> <a id="601" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>

<a id="616" class="Keyword">open</a> <a id="621" class="Keyword">import</a> <a id="628" href="BitML.Example.Setup.html" class="Module">BitML.Example.Setup</a>

<a id="649" class="Keyword">open</a> <a id="654" class="Keyword">import</a> <a id="661" href="BitML.BasicTypes.html" class="Module">BitML.BasicTypes</a>
<a id="678" class="Keyword">open</a> <a id="683" class="Keyword">import</a> <a id="690" href="BitML.Predicate.html" class="Module">BitML.Predicate</a>
<a id="706" class="Keyword">open</a> <a id="711" class="Keyword">import</a> <a id="718" href="BitML.Contracts.Types.html" class="Module">BitML.Contracts.Types</a> <a id="740" href="BitML.Example.Setup.html#108" class="Datatype">Participant</a> <a id="752" href="BitML.Example.Setup.html#219" class="Function">Honest</a> <a id="759" class="Keyword">hiding</a> <a id="766" class="Symbol">(</a><a id="767" href="BitML.Contracts.Types.html#532" class="Generalizable">A</a><a id="768" class="Symbol">;</a> <a id="770" href="BitML.Contracts.Types.html#534" class="Generalizable">B</a><a id="771" class="Symbol">)</a>

<a id="774" class="Comment">--------------------------------------------------------------------------------</a>

<a id="ex-contracts₁"></a><a id="856" href="BitML.Example.Contracts.html#856" class="Function">ex-contracts₁</a> <a id="870" class="Symbol">:</a> <a id="872" href="BitML.Contracts.Types.html#663" class="Function">Contract</a>
<a id="881" href="BitML.Example.Contracts.html#856" class="Function">ex-contracts₁</a> <a id="895" class="Symbol">=</a> <a id="897" href="BitML.Contracts.Types.html#966" class="InductiveConstructor">withdraw</a> <a id="906" href="BitML.Example.Setup.html#135" class="InductiveConstructor">A</a> <a id="908" href="BitML.Contracts.Types.html#1539" class="Function Operator">∙</a>

<a id="ex-contracts₂"></a><a id="911" href="BitML.Example.Contracts.html#911" class="Function">ex-contracts₂</a> <a id="925" class="Symbol">:</a> <a id="927" href="BitML.Contracts.Types.html#663" class="Function">Contract</a>
<a id="936" href="BitML.Example.Contracts.html#911" class="Function">ex-contracts₂</a> <a id="950" class="Symbol">=</a> <a id="952" href="BitML.Example.Setup.html#135" class="InductiveConstructor">A</a> <a id="954" href="BitML.Contracts.Types.html#1175" class="InductiveConstructor Operator">⇒</a> <a id="956" href="BitML.Contracts.Types.html#966" class="InductiveConstructor">withdraw</a> <a id="965" href="BitML.Example.Setup.html#135" class="InductiveConstructor">A</a>
              <a id="981" href="BitML.Contracts.Types.html#1487" class="Function Operator">⊕</a> <a id="983" href="BitML.Contracts.Types.html#1705" class="InductiveConstructor Operator">put</a> <a id="987" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="990" href="BitML.Contracts.Types.html#1705" class="InductiveConstructor Operator">⇒</a> <a id="992" class="Symbol">(</a><a id="993" href="BitML.Contracts.Types.html#966" class="InductiveConstructor">withdraw</a> <a id="1002" href="BitML.Example.Setup.html#135" class="InductiveConstructor">A</a> <a id="1004" href="BitML.Contracts.Types.html#1539" class="Function Operator">∙</a><a id="1005" class="Symbol">)</a>
              <a id="1021" href="BitML.Contracts.Types.html#1539" class="Function Operator">∙</a>

<a id="ex-contracts₃"></a><a id="1024" href="BitML.Example.Contracts.html#1024" class="Function">ex-contracts₃</a> <a id="1038" class="Symbol">:</a> <a id="1040" href="BitML.Contracts.Types.html#663" class="Function">Contract</a>
<a id="1049" href="BitML.Example.Contracts.html#1024" class="Function">ex-contracts₃</a> <a id="1063" class="Symbol">=</a> <a id="1065" href="BitML.Contracts.Types.html#1705" class="InductiveConstructor Operator">put</a> <a id="1069" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1071" class="String">&quot;x&quot;</a> <a id="1075" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="1077" href="BitML.Contracts.Types.html#1705" class="InductiveConstructor Operator">⇒</a> <a id="1079" class="Symbol">(</a><a id="1080" href="BitML.Contracts.Types.html#966" class="InductiveConstructor">withdraw</a> <a id="1089" href="BitML.Example.Setup.html#135" class="InductiveConstructor">A</a> <a id="1091" href="BitML.Contracts.Types.html#1539" class="Function Operator">∙</a><a id="1092" class="Symbol">)</a>
              <a id="1108" href="BitML.Contracts.Types.html#1539" class="Function Operator">∙</a>

<a id="ex-contracts₄"></a><a id="1111" href="BitML.Example.Contracts.html#1111" class="Function">ex-contracts₄</a> <a id="1125" class="Symbol">:</a> <a id="1127" href="BitML.Contracts.Types.html#663" class="Function">Contract</a>
<a id="1136" href="BitML.Example.Contracts.html#1111" class="Function">ex-contracts₄</a> <a id="1150" class="Symbol">=</a> <a id="1152" href="BitML.Example.Setup.html#135" class="InductiveConstructor">A</a> <a id="1154" href="BitML.Contracts.Types.html#1175" class="InductiveConstructor Operator">⇒</a> <a id="1156" href="BitML.Contracts.Types.html#966" class="InductiveConstructor">withdraw</a> <a id="1165" href="BitML.Example.Setup.html#137" class="InductiveConstructor">B</a>
              <a id="1181" href="BitML.Contracts.Types.html#1487" class="Function Operator">⊕</a> <a id="1183" href="BitML.Example.Setup.html#137" class="InductiveConstructor">B</a> <a id="1185" href="BitML.Contracts.Types.html#1175" class="InductiveConstructor Operator">⇒</a> <a id="1187" href="BitML.Contracts.Types.html#1102" class="InductiveConstructor">split</a> <a id="1193" class="Symbol">(</a> <a id="1195" class="Number">2</a> <a id="1197" href="BitML.Contracts.Types.html#1580" class="Function Operator">⊸</a> <a id="1199" class="Symbol">(</a><a id="1200" href="BitML.Contracts.Types.html#966" class="InductiveConstructor">withdraw</a> <a id="1209" href="BitML.Example.Setup.html#135" class="InductiveConstructor">A</a> <a id="1211" href="BitML.Contracts.Types.html#1539" class="Function Operator">∙</a><a id="1212" class="Symbol">)</a>
                          <a id="1240" href="BitML.Contracts.Types.html#1487" class="Function Operator">⊕</a> <a id="1242" class="Number">3</a> <a id="1244" href="BitML.Contracts.Types.html#1580" class="Function Operator">⊸</a> <a id="1246" class="Symbol">(</a><a id="1247" href="BitML.Contracts.Types.html#1244" class="InductiveConstructor Operator">after</a> <a id="1253" class="Number">100</a> <a id="1257" href="BitML.Contracts.Types.html#1244" class="InductiveConstructor Operator">⇒</a> <a id="1259" href="BitML.Contracts.Types.html#966" class="InductiveConstructor">withdraw</a> <a id="1268" href="BitML.Example.Setup.html#137" class="InductiveConstructor">B</a> <a id="1270" href="BitML.Contracts.Types.html#1539" class="Function Operator">∙</a><a id="1271" class="Symbol">)</a>
                          <a id="1299" href="BitML.Contracts.Types.html#1487" class="Function Operator">⊕</a> <a id="1301" class="Number">0</a> <a id="1303" href="BitML.Contracts.Types.html#1580" class="Function Operator">⊸</a> <a id="1305" class="Symbol">(</a><a id="1306" href="BitML.Contracts.Types.html#1705" class="InductiveConstructor Operator">put</a> <a id="1310" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1312" class="String">&quot;y&quot;</a> <a id="1316" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="1318" href="BitML.Contracts.Types.html#1705" class="InductiveConstructor Operator">⇒</a> <a id="1320" class="Symbol">(</a><a id="1321" href="BitML.Example.Setup.html#135" class="InductiveConstructor">A</a> <a id="1323" href="BitML.Contracts.Types.html#1175" class="InductiveConstructor Operator">⇒</a> <a id="1325" href="BitML.Contracts.Types.html#966" class="InductiveConstructor">withdraw</a> <a id="1334" href="BitML.Example.Setup.html#137" class="InductiveConstructor">B</a> <a id="1336" href="BitML.Contracts.Types.html#1539" class="Function Operator">∙</a><a id="1337" class="Symbol">)</a> <a id="1339" href="BitML.Contracts.Types.html#1539" class="Function Operator">∙</a><a id="1340" class="Symbol">)</a>
                          <a id="1368" href="BitML.Contracts.Types.html#1539" class="Function Operator">∙</a><a id="1369" class="Symbol">)</a>
              <a id="1385" href="BitML.Contracts.Types.html#1539" class="Function Operator">∙</a>


<a id="1389" class="Comment">-- see BitML paper, Section 2</a>
<a id="pay-or-refund"></a><a id="1419" href="BitML.Example.Contracts.html#1419" class="Function">pay-or-refund</a> <a id="1433" class="Symbol">:</a> <a id="1435" href="BitML.Contracts.Types.html#2489" class="Record">Advertisement</a>
<a id="1449" href="BitML.Example.Contracts.html#1419" class="Function">pay-or-refund</a> <a id="1463" class="Symbol">=</a> <a id="1465" href="BitML.Contracts.Types.html#2530" class="InductiveConstructor Operator">⟨</a> <a id="1467" href="BitML.Example.Setup.html#135" class="InductiveConstructor">A</a> <a id="1469" href="BitML.Contracts.Types.html#2037" class="InductiveConstructor Operator">:!</a> <a id="1472" class="Number">1</a> <a id="1474" href="BitML.Contracts.Types.html#2037" class="InductiveConstructor Operator">at</a> <a id="1477" class="String">&quot;x&quot;</a> <a id="1481" href="BitML.Contracts.Types.html#2212" class="InductiveConstructor Operator">∣∣</a> <a id="1484" href="BitML.Example.Setup.html#137" class="InductiveConstructor">B</a> <a id="1486" href="BitML.Contracts.Types.html#2037" class="InductiveConstructor Operator">:!</a> <a id="1489" class="Number">0</a> <a id="1491" href="BitML.Contracts.Types.html#2037" class="InductiveConstructor Operator">at</a> <a id="1494" class="String">&quot;y&quot;</a> <a id="1498" href="BitML.Contracts.Types.html#2530" class="InductiveConstructor Operator">⟩</a>
                <a id="1516" class="Symbol">(</a> <a id="1518" href="BitML.Example.Setup.html#135" class="InductiveConstructor">A</a> <a id="1520" href="BitML.Contracts.Types.html#1175" class="InductiveConstructor Operator">⇒</a> <a id="1522" href="BitML.Contracts.Types.html#966" class="InductiveConstructor">withdraw</a> <a id="1531" href="BitML.Example.Setup.html#137" class="InductiveConstructor">B</a>
                <a id="1549" href="BitML.Contracts.Types.html#1487" class="Function Operator">⊕</a> <a id="1551" href="BitML.Example.Setup.html#137" class="InductiveConstructor">B</a> <a id="1553" href="BitML.Contracts.Types.html#1175" class="InductiveConstructor Operator">⇒</a> <a id="1555" href="BitML.Contracts.Types.html#966" class="InductiveConstructor">withdraw</a> <a id="1564" href="BitML.Example.Setup.html#135" class="InductiveConstructor">A</a>
                <a id="1582" href="BitML.Contracts.Types.html#1539" class="Function Operator">∙</a><a id="1583" class="Symbol">)</a>


<a id="ex-ad"></a><a id="1587" href="BitML.Example.Contracts.html#1587" class="Function">ex-ad</a> <a id="1593" class="Symbol">:</a> <a id="1595" href="BitML.Contracts.Types.html#2489" class="Record">Advertisement</a>
<a id="1609" href="BitML.Example.Contracts.html#1587" class="Function">ex-ad</a> <a id="1615" class="Symbol">=</a> <a id="1617" href="BitML.Contracts.Types.html#2530" class="InductiveConstructor Operator">⟨</a> <a id="1619" href="BitML.Example.Setup.html#137" class="InductiveConstructor">B</a> <a id="1621" href="BitML.Contracts.Types.html#2037" class="InductiveConstructor Operator">:!</a> <a id="1624" class="Number">2</a> <a id="1626" href="BitML.Contracts.Types.html#2037" class="InductiveConstructor Operator">at</a> <a id="1629" class="String">&quot;x&quot;</a> <a id="1633" href="BitML.Contracts.Types.html#2212" class="InductiveConstructor Operator">∣∣</a> <a id="1636" href="BitML.Example.Setup.html#135" class="InductiveConstructor">A</a> <a id="1638" href="BitML.Contracts.Types.html#2037" class="InductiveConstructor Operator">:!</a> <a id="1641" class="Number">3</a> <a id="1643" href="BitML.Contracts.Types.html#2037" class="InductiveConstructor Operator">at</a> <a id="1646" class="String">&quot;y&quot;</a> <a id="1650" href="BitML.Contracts.Types.html#2212" class="InductiveConstructor Operator">∣∣</a> <a id="1653" href="BitML.Example.Setup.html#135" class="InductiveConstructor">A</a> <a id="1655" href="BitML.Contracts.Types.html#1960" class="InductiveConstructor Operator">:?</a> <a id="1658" class="Number">100</a> <a id="1662" href="BitML.Contracts.Types.html#1960" class="InductiveConstructor Operator">at</a> <a id="1665" class="String">&quot;z&quot;</a> <a id="1669" href="BitML.Contracts.Types.html#2530" class="InductiveConstructor Operator">⟩</a> <a id="1671" href="BitML.Example.Contracts.html#1024" class="Function">ex-contracts₃</a>
</pre></body></html>