<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>BitML.Contracts.Validity</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-bitml/tree/master/BitML/Contracts/Validity.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Validity of advertisements.</a>
<a id="105" class="Comment">------------------------------------------------------------------------</a>
<a id="178" class="Keyword">open</a> <a id="183" class="Keyword">import</a> <a id="190" href="Function.html" class="Module">Function</a> <a id="199" class="Keyword">using</a> <a id="205" class="Symbol">(</a><a id="206" href="Function.Base.html#624" class="Function">id</a><a id="208" class="Symbol">)</a>

<a id="211" class="Keyword">open</a> <a id="216" class="Keyword">import</a> <a id="223" href="Prelude.Init.html" class="Module">Prelude.Init</a> <a id="236" class="Keyword">hiding</a> <a id="243" class="Symbol">(</a><a id="244" href="Data.List.Relation.Binary.Subset.Setoid.html#748" class="Function Operator">_⊆_</a><a id="247" class="Symbol">);</a> <a id="250" class="Keyword">open</a> <a id="255" href="Prelude.Init.html#504" class="Module">SetAsType</a>
<a id="265" class="Keyword">open</a> <a id="270" class="Keyword">import</a> <a id="277" href="Prelude.Lists.Subsets.html" class="Module">Prelude.Lists.Subsets</a> <a id="299" class="Keyword">renaming</a> <a id="308" class="Symbol">(</a><a id="309" href="Prelude.Lists.Subsets.html#135" class="Record Operator">_⊆′_</a> <a id="314" class="Symbol">to</a> <a id="317" class="Record Operator">_⊆_</a><a id="320" class="Symbol">)</a>
<a id="322" class="Keyword">open</a> <a id="327" class="Keyword">import</a> <a id="334" href="Prelude.Lists.Dec.html" class="Module">Prelude.Lists.Dec</a> <a id="352" class="Keyword">hiding</a> <a id="359" class="Symbol">(</a><a id="360" href="Prelude.Lists.Dec.html#1742" class="Function Operator">_⊆?_</a><a id="364" class="Symbol">)</a> <a id="366" class="Keyword">renaming</a> <a id="375" class="Symbol">(</a><a id="376" href="Prelude.Lists.Dec.html#1772" class="Function Operator">_⊆′?_</a> <a id="382" class="Symbol">to</a> <a id="385" class="Function Operator">_⊆?_</a><a id="389" class="Symbol">)</a>
<a id="391" class="Keyword">open</a> <a id="396" class="Keyword">import</a> <a id="403" href="Prelude.Lists.Sums.html" class="Module">Prelude.Lists.Sums</a>
<a id="422" class="Keyword">open</a> <a id="427" class="Keyword">import</a> <a id="434" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="448" class="Keyword">open</a> <a id="453" class="Keyword">import</a> <a id="460" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="476" class="Keyword">open</a> <a id="481" class="Keyword">import</a> <a id="488" href="Prelude.Bifunctor.html" class="Module">Prelude.Bifunctor</a>
<a id="506" class="Keyword">open</a> <a id="511" class="Keyword">import</a> <a id="518" href="Prelude.Foldable.html" class="Module">Prelude.Foldable</a>
<a id="535" class="Keyword">open</a> <a id="540" class="Keyword">import</a> <a id="547" href="Prelude.Traversable.html" class="Module">Prelude.Traversable</a>
<a id="567" class="Keyword">open</a> <a id="572" class="Keyword">import</a> <a id="579" href="Prelude.Monad.html" class="Module">Prelude.Monad</a>
<a id="593" class="Keyword">open</a> <a id="598" class="Keyword">import</a> <a id="605" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>
<a id="623" class="Keyword">open</a> <a id="628" class="Keyword">import</a> <a id="635" href="Prelude.Validity.html" class="Module">Prelude.Validity</a>

<a id="653" class="Keyword">open</a> <a id="658" class="Keyword">import</a> <a id="665" href="BitML.BasicTypes.html" class="Module">BitML.BasicTypes</a>
<a id="682" class="Keyword">open</a> <a id="687" class="Keyword">import</a> <a id="694" href="BitML.Predicate.html" class="Module">BitML.Predicate</a>

<a id="711" class="Keyword">module</a> <a id="718" href="BitML.Contracts.Validity.html" class="Module">BitML.Contracts.Validity</a> <a id="743" class="Symbol">(</a><a id="744" href="BitML.Contracts.Validity.html#744" class="Bound">⋯</a> <a id="746" class="Symbol">:</a> <a id="748" href="BitML.BasicTypes.html#631" class="Record">⋯</a><a id="749" class="Symbol">)</a> <a id="751" class="Keyword">where</a>

<a id="758" class="Keyword">open</a> <a id="763" class="Keyword">import</a> <a id="770" href="BitML.Contracts.Types.html" class="Module">BitML.Contracts.Types</a> <a id="792" href="BitML.Contracts.Validity.html#744" class="Bound">⋯</a> <a id="794" class="Keyword">hiding</a> <a id="801" class="Symbol">(</a><a id="802" href="BitML.Contracts.Types.html#373" class="Generalizable">B</a><a id="803" class="Symbol">)</a>
<a id="805" class="Keyword">open</a> <a id="810" class="Keyword">import</a> <a id="817" href="BitML.Contracts.Collections.html" class="Module">BitML.Contracts.Collections</a> <a id="845" href="BitML.Contracts.Validity.html#744" class="Bound">⋯</a>

<a id="splitsOK"></a><a id="848" href="BitML.Contracts.Validity.html#848" class="Function">splitsOK</a> <a id="857" class="Symbol">:</a> <a id="859" href="BitML.Contracts.Types.html#1748" class="Datatype">Precondition</a> <a id="872" class="Symbol">→</a> <a id="874" href="BitML.Contracts.Types.html#502" class="Function">Contract</a> <a id="883" class="Symbol">→</a> <a id="885" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="890" href="BitML.Contracts.Validity.html#848" class="Function">splitsOK</a> <a id="899" href="BitML.Contracts.Validity.html#899" class="Bound">G</a> <a id="901" href="BitML.Contracts.Validity.html#901" class="Bound">C₀</a> <a id="904" class="Symbol">=</a> <a id="906" href="BitML.Contracts.Validity.html#978" class="Function">goᶜ</a> <a id="910" href="BitML.Contracts.Validity.html#901" class="Bound">C₀</a> <a id="913" class="Symbol">(</a><a id="914" href="BitML.Contracts.Collections.html#8709" class="Function">persistentValue</a> <a id="930" href="BitML.Contracts.Validity.html#899" class="Bound">G</a><a id="931" class="Symbol">)</a>
  <a id="935" class="Keyword">where</a>
    <a id="945" href="BitML.Contracts.Validity.html#945" class="Function">goᵈ</a>  <a id="950" class="Symbol">:</a> <a id="952" href="BitML.Contracts.Types.html#488" class="Datatype">Branch</a> <a id="959" class="Symbol">→</a> <a id="961" href="BitML.BasicTypes.html#271" class="Function">Value</a> <a id="967" class="Symbol">→</a> <a id="969" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
    <a id="978" href="BitML.Contracts.Validity.html#978" class="Function">goᶜ</a>  <a id="983" class="Symbol">:</a> <a id="985" href="BitML.Contracts.Types.html#502" class="Function">Contract</a> <a id="994" class="Symbol">→</a> <a id="996" href="BitML.BasicTypes.html#271" class="Function">Value</a> <a id="1002" class="Symbol">→</a> <a id="1004" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
    <a id="1013" href="BitML.Contracts.Validity.html#1013" class="Function">goᵛᶜ</a> <a id="1018" class="Symbol">:</a> <a id="1020" href="BitML.Contracts.Types.html#556" class="Function">VContracts</a> <a id="1031" class="Symbol">→</a> <a id="1033" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>

    <a id="1043" href="BitML.Contracts.Validity.html#1013" class="Function">goᵛᶜ</a> <a id="1048" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="1051" class="Symbol">=</a> <a id="1053" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>
    <a id="1062" href="BitML.Contracts.Validity.html#1013" class="Function">goᵛᶜ</a> <a id="1067" class="Symbol">((</a><a id="1069" href="BitML.Contracts.Validity.html#1069" class="Bound">v</a> <a id="1071" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1073" href="BitML.Contracts.Validity.html#1073" class="Bound">cs</a><a id="1075" class="Symbol">)</a> <a id="1077" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1079" href="BitML.Contracts.Validity.html#1079" class="Bound">vcs</a><a id="1082" class="Symbol">)</a> <a id="1084" class="Symbol">=</a> <a id="1086" href="BitML.Contracts.Validity.html#978" class="Function">goᶜ</a> <a id="1090" href="BitML.Contracts.Validity.html#1073" class="Bound">cs</a> <a id="1093" href="BitML.Contracts.Validity.html#1069" class="Bound">v</a>

    <a id="1100" href="BitML.Contracts.Validity.html#978" class="Function">goᶜ</a> <a id="1104" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="1107" class="Symbol">_</a> <a id="1109" class="Symbol">=</a> <a id="1111" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>
    <a id="1120" href="BitML.Contracts.Validity.html#978" class="Function">goᶜ</a> <a id="1124" class="Symbol">(</a><a id="1125" href="BitML.Contracts.Validity.html#1125" class="Bound">c</a> <a id="1127" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1129" href="BitML.Contracts.Validity.html#1129" class="Bound">cs</a><a id="1131" class="Symbol">)</a> <a id="1133" href="BitML.Contracts.Validity.html#1133" class="Bound">v</a> <a id="1135" class="Symbol">=</a> <a id="1137" href="BitML.Contracts.Validity.html#945" class="Function">goᵈ</a> <a id="1141" href="BitML.Contracts.Validity.html#1125" class="Bound">c</a> <a id="1143" href="BitML.Contracts.Validity.html#1133" class="Bound">v</a> <a id="1145" href="Data.Bool.Base.html#995" class="Function Operator">∧</a> <a id="1147" href="BitML.Contracts.Validity.html#978" class="Function">goᶜ</a> <a id="1151" href="BitML.Contracts.Validity.html#1129" class="Bound">cs</a> <a id="1154" href="BitML.Contracts.Validity.html#1133" class="Bound">v</a>

    <a id="1161" href="BitML.Contracts.Validity.html#945" class="Function">goᵈ</a> <a id="1165" href="BitML.Contracts.Validity.html#1165" class="Bound">c₀</a><a id="1167" class="Symbol">@(</a><a id="1169" href="BitML.Contracts.Types.html#693" class="InductiveConstructor Operator">put</a> <a id="1173" href="BitML.Contracts.Validity.html#1173" class="Bound">xs</a> <a id="1176" href="BitML.Contracts.Types.html#693" class="InductiveConstructor Operator">&amp;reveal</a> <a id="1184" href="BitML.Contracts.Validity.html#1184" class="Bound">as</a> <a id="1187" href="BitML.Contracts.Types.html#693" class="InductiveConstructor Operator">if</a> <a id="1190" href="BitML.Contracts.Validity.html#1190" class="Bound">p</a> <a id="1192" href="BitML.Contracts.Types.html#693" class="InductiveConstructor Operator">⇒</a> <a id="1194" href="BitML.Contracts.Validity.html#1194" class="Bound">c</a><a id="1195" class="Symbol">)</a> <a id="1197" href="BitML.Contracts.Validity.html#1197" class="Bound">v</a> <a id="1199" class="Symbol">=</a>
      <a id="1207" href="Function.Base.html#4130" class="Function Operator">case</a> <a id="1212" href="Prelude.Traversable.html#637" class="Field">sequenceM</a> <a id="1222" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1224" href="Data.List.Base.html#1553" class="Function">map</a> <a id="1228" class="Symbol">(λ</a> <a id="1231" href="BitML.Contracts.Validity.html#1231" class="Bound">x</a> <a id="1233" class="Symbol">→</a> <a id="1235" href="BitML.Contracts.Collections.html#12373" class="Function">checkDeposit</a> <a id="1248" href="BitML.Contracts.Types.html#2592" class="InductiveConstructor">volatile</a> <a id="1257" href="BitML.Contracts.Validity.html#1231" class="Bound">x</a> <a id="1259" href="BitML.Contracts.Validity.html#899" class="Bound">G</a><a id="1260" class="Symbol">)</a> <a id="1262" href="BitML.Contracts.Validity.html#1173" class="Bound">xs</a> <a id="1265" href="Function.Base.html#4130" class="Function Operator">of</a> <a id="1268" class="Symbol">λ</a> <a id="1270" class="Keyword">where</a>
        <a id="1284" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>   <a id="1294" class="Symbol">→</a> <a id="1296" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a>
        <a id="1310" class="Symbol">(</a><a id="1311" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="1316" href="BitML.Contracts.Validity.html#1316" class="Bound">vs</a><a id="1318" class="Symbol">)</a> <a id="1320" class="Symbol">→</a> <a id="1322" href="BitML.Contracts.Validity.html#978" class="Function">goᶜ</a> <a id="1326" href="BitML.Contracts.Validity.html#1194" class="Bound">c</a> <a id="1328" class="Symbol">(</a><a id="1329" href="BitML.Contracts.Validity.html#1197" class="Bound">v</a> <a id="1331" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="1333" href="Prelude.Lists.Sums.html#295" class="Function">∑ℕ</a> <a id="1336" href="BitML.Contracts.Validity.html#1316" class="Bound">vs</a><a id="1338" class="Symbol">)</a>
    <a id="1344" href="BitML.Contracts.Validity.html#945" class="Function">goᵈ</a> <a id="1348" class="Symbol">(</a><a id="1349" href="BitML.Contracts.Types.html#941" class="InductiveConstructor">split</a> <a id="1355" href="BitML.Contracts.Validity.html#1355" class="Bound">vcs</a><a id="1358" class="Symbol">)</a>   <a id="1362" href="BitML.Contracts.Validity.html#1362" class="Bound">v</a> <a id="1364" class="Symbol">=</a> <a id="1366" class="Symbol">(</a><a id="1367" href="Prelude.Lists.Sums.html#361" class="Function">∑₁</a> <a id="1370" href="BitML.Contracts.Validity.html#1355" class="Bound">vcs</a> <a id="1374" href="Prelude.DecEq.Core.html#222" class="Function Operator">==</a> <a id="1377" href="BitML.Contracts.Validity.html#1362" class="Bound">v</a><a id="1378" class="Symbol">)</a> <a id="1380" href="Data.Bool.Base.html#995" class="Function Operator">∧</a> <a id="1382" href="BitML.Contracts.Validity.html#1013" class="Function">goᵛᶜ</a> <a id="1387" href="BitML.Contracts.Validity.html#1355" class="Bound">vcs</a>
    <a id="1395" href="BitML.Contracts.Validity.html#945" class="Function">goᵈ</a> <a id="1399" class="Symbol">(</a><a id="1400" href="BitML.Contracts.Types.html#1083" class="InductiveConstructor Operator">after</a> <a id="1406" class="Symbol">_</a> <a id="1408" href="BitML.Contracts.Types.html#1083" class="InductiveConstructor Operator">∶</a> <a id="1410" href="BitML.Contracts.Validity.html#1410" class="Bound">c</a><a id="1411" class="Symbol">)</a> <a id="1413" href="BitML.Contracts.Validity.html#1413" class="Bound">v</a> <a id="1415" class="Symbol">=</a> <a id="1417" href="BitML.Contracts.Validity.html#945" class="Function">goᵈ</a> <a id="1421" href="BitML.Contracts.Validity.html#1410" class="Bound">c</a> <a id="1423" href="BitML.Contracts.Validity.html#1413" class="Bound">v</a>
    <a id="1429" href="BitML.Contracts.Validity.html#945" class="Function">goᵈ</a> <a id="1433" class="Symbol">(_</a> <a id="1436" href="BitML.Contracts.Types.html#1014" class="InductiveConstructor Operator">∶</a> <a id="1438" href="BitML.Contracts.Validity.html#1438" class="Bound">c</a><a id="1439" class="Symbol">)</a>       <a id="1447" href="BitML.Contracts.Validity.html#1447" class="Bound">v</a> <a id="1449" class="Symbol">=</a> <a id="1451" href="BitML.Contracts.Validity.html#945" class="Function">goᵈ</a> <a id="1455" href="BitML.Contracts.Validity.html#1438" class="Bound">c</a> <a id="1457" href="BitML.Contracts.Validity.html#1447" class="Bound">v</a>
    <a id="1463" href="BitML.Contracts.Validity.html#945" class="Function">goᵈ</a> <a id="1467" class="Symbol">(</a><a id="1468" href="BitML.Contracts.Types.html#805" class="InductiveConstructor">withdraw</a> <a id="1477" class="Symbol">_)</a>  <a id="1481" class="Symbol">_</a> <a id="1483" class="Symbol">=</a> <a id="1485" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>

<a id="1491" class="Keyword">module</a> <a id="1498" href="BitML.Contracts.Validity.html#1498" class="Module">_</a> <a id="1500" class="Symbol">(</a><a id="1501" href="BitML.Contracts.Validity.html#1501" class="Bound">ad</a> <a id="1504" class="Symbol">:</a> <a id="1506" href="BitML.Contracts.Types.html#2283" class="Record">Ad</a><a id="1508" class="Symbol">)</a> <a id="1510" class="Symbol">(</a><a id="1511" class="Keyword">let</a> <a id="1515" href="BitML.Contracts.Types.html#2313" class="InductiveConstructor Operator">⟨</a> <a id="1517" href="BitML.Contracts.Validity.html#1517" class="Bound">G</a> <a id="1519" href="BitML.Contracts.Types.html#2313" class="InductiveConstructor Operator">⟩</a> <a id="1521" href="BitML.Contracts.Validity.html#1521" class="Bound">C</a> <a id="1523" class="Symbol">=</a> <a id="1525" href="BitML.Contracts.Validity.html#1501" class="Bound">ad</a><a id="1527" class="Symbol">)</a> <a id="1529" class="Keyword">where</a>
  <a id="1537" class="Keyword">record</a> <a id="1544" href="BitML.Contracts.Validity.html#1544" class="Record">ValidAd</a> <a id="1552" class="Symbol">:</a> <a id="1554" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="1559" class="Keyword">where</a>
    <a id="1569" class="Keyword">field</a>
      <a id="1581" class="Comment">-- (i) names in G are distinct</a>
      <a id="1618" href="BitML.Contracts.Validity.html#1618" class="Field">names-uniq</a> <a id="1629" class="Symbol">:</a>
        <a id="1639" href="Data.List.Relation.Unary.Unique.Setoid.html#728" class="Datatype">Unique</a> <a id="1646" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1648" href="BitML.Contracts.Collections.html#4018" class="Function">names</a> <a id="1654" href="BitML.Contracts.Validity.html#1517" class="Bound">G</a>

      <a id="1663" class="Comment">-- (ii) each name in C appears in G</a>
      <a id="1705" href="BitML.Contracts.Validity.html#1705" class="Field">names-⊆</a> <a id="1713" class="Symbol">:</a>
        <a id="1723" href="BitML.Contracts.Collections.html#4018" class="Function">names</a> <a id="1729" href="BitML.Contracts.Validity.html#1521" class="Bound">C</a> <a id="1731" href="BitML.Contracts.Validity.html#317" class="Record Operator">⊆</a> <a id="1733" href="BitML.Contracts.Collections.html#4018" class="Function">names</a> <a id="1739" href="BitML.Contracts.Validity.html#1517" class="Bound">G</a>

      <a id="1748" class="Comment">-- (iii) names in `put&amp;reveal` are distinct and secrets in `if` appear in `reveal`</a>
      <a id="1837" href="BitML.Contracts.Validity.html#1837" class="Field">names-put</a> <a id="1847" class="Symbol">:</a>
        <a id="1857" href="Data.List.Relation.Unary.All.html#1453" class="Datatype">All</a> <a id="1861" class="Symbol">(λ</a> <a id="1864" class="Symbol">(</a><a id="1865" href="BitML.Contracts.Validity.html#1865" class="Bound">xs</a> <a id="1868" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1870" href="BitML.Contracts.Validity.html#1870" class="Bound">as</a> <a id="1873" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1875" href="BitML.Contracts.Validity.html#1875" class="Bound">p</a><a id="1876" class="Symbol">)</a> <a id="1878" class="Symbol">→</a> <a id="1880" href="Data.List.Relation.Unary.Unique.Setoid.html#728" class="Datatype">Unique</a> <a id="1887" href="BitML.Contracts.Validity.html#1865" class="Bound">xs</a> <a id="1890" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1892" href="BitML.Contracts.Collections.html#4209" class="Function">secrets</a> <a id="1900" href="BitML.Contracts.Validity.html#1875" class="Bound">p</a> <a id="1902" href="BitML.Contracts.Validity.html#317" class="Record Operator">⊆</a> <a id="1904" href="BitML.Contracts.Validity.html#1870" class="Bound">as</a><a id="1906" class="Symbol">)</a> <a id="1908" class="Symbol">(</a><a id="1909" href="BitML.Contracts.Collections.html#5705" class="Function">putComponents</a> <a id="1923" href="BitML.Contracts.Validity.html#1521" class="Bound">C</a><a id="1924" class="Symbol">)</a>

      <a id="1933" class="Comment">-- (iv) each participant has a persistent deposit in G</a>
      <a id="1994" href="BitML.Contracts.Validity.html#1994" class="Field">parts-⊆</a> <a id="2002" class="Symbol">:</a>
        <a id="2012" href="BitML.Contracts.Collections.html#2535" class="Function">participants</a> <a id="2025" href="BitML.Contracts.Validity.html#1517" class="Bound">G</a> <a id="2027" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="2030" href="BitML.Contracts.Collections.html#2535" class="Function">participants</a> <a id="2043" href="BitML.Contracts.Validity.html#1521" class="Bound">C</a> <a id="2045" href="BitML.Contracts.Validity.html#317" class="Record Operator">⊆</a> <a id="2047" href="BitML.Contracts.Collections.html#8834" class="Function">persistentParticipants</a> <a id="2070" href="BitML.Contracts.Validity.html#1517" class="Bound">G</a>

      <a id="2079" class="Comment">-- (extra) split commands are valid</a>
      <a id="2121" href="BitML.Contracts.Validity.html#2121" class="Field">splits-OK</a> <a id="2131" class="Symbol">:</a>
        <a id="2141" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="2143" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2145" href="BitML.Contracts.Validity.html#848" class="Function">splitsOK</a> <a id="2154" href="BitML.Contracts.Validity.html#1517" class="Bound">G</a> <a id="2156" href="BitML.Contracts.Validity.html#1521" class="Bound">C</a>

    <a id="2163" href="BitML.Contracts.Validity.html#2163" class="Function Operator">_∙names-⊆</a>   <a id="2175" class="Symbol">=</a> <a id="2177" href="BitML.Contracts.Validity.html#1705" class="Field">names-⊆</a> <a id="2185" class="Symbol">.</a><a id="2186" href="Prelude.Lists.Subsets.html#198" class="Field">unmk⊆</a>
    <a id="2196" href="BitML.Contracts.Validity.html#2196" class="Function Operator">_∙names-put</a> <a id="2208" class="Symbol">=</a> <a id="2210" href="Data.List.Relation.Unary.All.html#2944" class="Function">L.All.map</a> <a id="2220" class="Symbol">(</a><a id="2221" href="Prelude.Bifunctor.html#1037" class="Function">map₂</a> <a id="2226" href="Prelude.Lists.Subsets.html#198" class="Field">unmk⊆</a><a id="2231" class="Symbol">)</a> <a id="2233" href="BitML.Contracts.Validity.html#1837" class="Field">names-put</a>
    <a id="2247" href="BitML.Contracts.Validity.html#2247" class="Function Operator">_∙parts-⊆</a>   <a id="2259" class="Symbol">=</a> <a id="2261" href="BitML.Contracts.Validity.html#1994" class="Field">parts-⊆</a> <a id="2269" class="Symbol">.</a><a id="2270" href="Prelude.Lists.Subsets.html#198" class="Field">unmk⊆</a>

<a id="2277" class="Keyword">open</a> <a id="2282" href="BitML.Contracts.Validity.html#1544" class="Module">ValidAd</a> <a id="2290" class="Keyword">public</a>

<a id="2298" class="Keyword">instance</a>
  <a id="𝕍Ad"></a><a id="2309" href="BitML.Contracts.Validity.html#2309" class="Function">𝕍Ad</a> <a id="2313" class="Symbol">:</a> <a id="2315" href="Prelude.Validity.html#284" class="Record">Validable</a> <a id="2325" href="BitML.Contracts.Types.html#2283" class="Record">Ad</a>
  <a id="2330" href="BitML.Contracts.Validity.html#2309" class="Function">𝕍Ad</a> <a id="2334" class="Symbol">.</a><a id="2335" href="Prelude.Validity.html#343" class="Field">Valid</a> <a id="2341" class="Symbol">=</a> <a id="2343" href="BitML.Contracts.Validity.html#1544" class="Record">ValidAd</a>

  <a id="Dec-𝕍Ad"></a><a id="2354" href="BitML.Contracts.Validity.html#2354" class="Function">Dec-𝕍Ad</a> <a id="2362" class="Symbol">:</a> <a id="2364" href="Prelude.Validity.html#343" class="Field">Valid</a> <a id="2370" href="Prelude.Decidable.Core.html#527" class="Function Operator">⁇¹</a>
  <a id="2375" href="BitML.Contracts.Validity.html#2354" class="Function">Dec-𝕍Ad</a> <a id="2383" class="Symbol">{</a><a id="2384" class="Argument">x</a> <a id="2386" class="Symbol">=</a> <a id="2388" href="BitML.Contracts.Types.html#2313" class="InductiveConstructor Operator">⟨</a> <a id="2390" href="BitML.Contracts.Validity.html#2390" class="Bound">G</a> <a id="2392" href="BitML.Contracts.Types.html#2313" class="InductiveConstructor Operator">⟩</a> <a id="2394" href="BitML.Contracts.Validity.html#2394" class="Bound">C</a><a id="2395" class="Symbol">}</a> <a id="2397" class="Symbol">.</a><a id="2398" href="Prelude.Decidable.Core.html#166" class="Field">dec</a>
    <a id="2406" class="Keyword">with</a> <a id="2411" href="Prelude.Lists.Dec.html#1836" class="Function">unique?</a> <a id="2419" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2421" href="BitML.Contracts.Collections.html#4018" class="Function">names</a> <a id="2427" href="BitML.Contracts.Validity.html#2390" class="Bound">G</a>
       <a id="2436" class="Symbol">|</a> <a id="2438" href="BitML.Contracts.Collections.html#4018" class="Function">names</a> <a id="2444" href="BitML.Contracts.Validity.html#2394" class="Bound">C</a> <a id="2446" href="BitML.Contracts.Validity.html#385" class="Function Operator">⊆?</a> <a id="2449" href="BitML.Contracts.Collections.html#4018" class="Function">names</a> <a id="2455" href="BitML.Contracts.Validity.html#2390" class="Bound">G</a>
       <a id="2464" class="Symbol">|</a> <a id="2466" href="Data.List.Relation.Unary.All.html#6249" class="Function">all?</a> <a id="2471" class="Symbol">(λ</a> <a id="2474" class="Symbol">(</a><a id="2475" href="BitML.Contracts.Validity.html#2475" class="Bound">xs</a> <a id="2478" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2480" href="BitML.Contracts.Validity.html#2480" class="Bound">as</a> <a id="2483" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2485" href="BitML.Contracts.Validity.html#2485" class="Bound">p</a><a id="2486" class="Symbol">)</a> <a id="2488" class="Symbol">→</a> <a id="2490" href="Prelude.Lists.Dec.html#1836" class="Function">unique?</a> <a id="2498" href="BitML.Contracts.Validity.html#2475" class="Bound">xs</a> <a id="2501" href="Relation.Nullary.Product.html#930" class="Function Operator">×-dec</a> <a id="2507" href="BitML.Contracts.Collections.html#4209" class="Function">secrets</a> <a id="2515" href="BitML.Contracts.Validity.html#2485" class="Bound">p</a> <a id="2517" href="BitML.Contracts.Validity.html#385" class="Function Operator">⊆?</a> <a id="2520" href="BitML.Contracts.Validity.html#2480" class="Bound">as</a><a id="2522" class="Symbol">)</a> <a id="2524" class="Symbol">(</a><a id="2525" href="BitML.Contracts.Collections.html#5705" class="Function">putComponents</a> <a id="2539" href="BitML.Contracts.Validity.html#2394" class="Bound">C</a><a id="2540" class="Symbol">)</a>
       <a id="2549" class="Symbol">|</a> <a id="2551" href="BitML.Contracts.Collections.html#2535" class="Function">participants</a> <a id="2564" href="BitML.Contracts.Validity.html#2390" class="Bound">G</a> <a id="2566" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="2569" href="BitML.Contracts.Collections.html#2535" class="Function">participants</a> <a id="2582" href="BitML.Contracts.Validity.html#2394" class="Bound">C</a> <a id="2584" href="BitML.Contracts.Validity.html#385" class="Function Operator">⊆?</a> <a id="2587" href="BitML.Contracts.Collections.html#8834" class="Function">persistentParticipants</a> <a id="2610" href="BitML.Contracts.Validity.html#2390" class="Bound">G</a>
       <a id="2619" class="Symbol">|</a> <a id="2621" href="Data.Bool.Properties.html#15479" class="Function">T?</a> <a id="2624" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2626" href="BitML.Contracts.Validity.html#848" class="Function">splitsOK</a> <a id="2635" href="BitML.Contracts.Validity.html#2390" class="Bound">G</a> <a id="2637" href="BitML.Contracts.Validity.html#2394" class="Bound">C</a>
  <a id="2641" class="Symbol">...</a> <a id="2645" class="Symbol">|</a> <a id="2647" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="2650" href="BitML.Contracts.Validity.html#2650" class="Bound">¬names-uniq</a> <a id="2662" class="Symbol">|</a> <a id="2664" class="Symbol">_</a> <a id="2666" class="Symbol">|</a> <a id="2668" class="Symbol">_</a> <a id="2670" class="Symbol">|</a> <a id="2672" class="Symbol">_</a> <a id="2674" class="Symbol">|</a> <a id="2676" class="Symbol">_</a>             <a id="2690" class="Symbol">=</a> <a id="2692" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="2695" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2697" href="BitML.Contracts.Validity.html#2650" class="Bound">¬names-uniq</a> <a id="2709" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2711" href="BitML.Contracts.Validity.html#1618" class="Field">names-uniq</a>
  <a id="2724" class="CatchallClause Symbol">...</a><a id="2727" class="CatchallClause"> </a><a id="2728" class="CatchallClause Symbol">|</a><a id="2729" class="CatchallClause"> </a><a id="2730" class="CatchallClause Symbol">_</a><a id="2731" class="CatchallClause"> </a><a id="2732" class="CatchallClause Symbol">|</a><a id="2733" class="CatchallClause"> </a><a id="2734" href="Relation.Nullary.html#1694" class="CatchallClause InductiveConstructor">no</a><a id="2736" class="CatchallClause"> </a><a id="2737" href="BitML.Contracts.Validity.html#2737" class="CatchallClause Bound">¬names-⊆</a><a id="2745" class="CatchallClause"> </a><a id="2746" class="CatchallClause Symbol">|</a><a id="2747" class="CatchallClause"> </a><a id="2748" class="CatchallClause Symbol">_</a><a id="2749" class="CatchallClause"> </a><a id="2750" class="CatchallClause Symbol">|</a><a id="2751" class="CatchallClause"> </a><a id="2752" class="CatchallClause Symbol">_</a><a id="2753" class="CatchallClause"> </a><a id="2754" class="CatchallClause Symbol">|</a><a id="2755" class="CatchallClause"> </a><a id="2756" class="CatchallClause Symbol">_</a>                <a id="2773" class="Symbol">=</a> <a id="2775" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="2778" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2780" href="BitML.Contracts.Validity.html#2737" class="Bound">¬names-⊆</a>    <a id="2792" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2794" href="BitML.Contracts.Validity.html#1705" class="Field">names-⊆</a>
  <a id="2804" class="CatchallClause Symbol">...</a><a id="2807" class="CatchallClause"> </a><a id="2808" class="CatchallClause Symbol">|</a><a id="2809" class="CatchallClause"> </a><a id="2810" class="CatchallClause Symbol">_</a><a id="2811" class="CatchallClause"> </a><a id="2812" class="CatchallClause Symbol">|</a><a id="2813" class="CatchallClause"> </a><a id="2814" class="CatchallClause Symbol">_</a><a id="2815" class="CatchallClause"> </a><a id="2816" class="CatchallClause Symbol">|</a><a id="2817" class="CatchallClause"> </a><a id="2818" href="Relation.Nullary.html#1694" class="CatchallClause InductiveConstructor">no</a><a id="2820" class="CatchallClause"> </a><a id="2821" href="BitML.Contracts.Validity.html#2821" class="CatchallClause Bound">¬names-put</a><a id="2831" class="CatchallClause"> </a><a id="2832" class="CatchallClause Symbol">|</a><a id="2833" class="CatchallClause"> </a><a id="2834" class="CatchallClause Symbol">_</a><a id="2835" class="CatchallClause"> </a><a id="2836" class="CatchallClause Symbol">|</a><a id="2837" class="CatchallClause"> </a><a id="2838" class="CatchallClause Symbol">_</a>              <a id="2853" class="Symbol">=</a> <a id="2855" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="2858" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2860" href="BitML.Contracts.Validity.html#2821" class="Bound">¬names-put</a>  <a id="2872" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2874" href="BitML.Contracts.Validity.html#1837" class="Field">names-put</a>
  <a id="2886" class="CatchallClause Symbol">...</a><a id="2889" class="CatchallClause"> </a><a id="2890" class="CatchallClause Symbol">|</a><a id="2891" class="CatchallClause"> </a><a id="2892" class="CatchallClause Symbol">_</a><a id="2893" class="CatchallClause"> </a><a id="2894" class="CatchallClause Symbol">|</a><a id="2895" class="CatchallClause"> </a><a id="2896" class="CatchallClause Symbol">_</a><a id="2897" class="CatchallClause"> </a><a id="2898" class="CatchallClause Symbol">|</a><a id="2899" class="CatchallClause"> </a><a id="2900" class="CatchallClause Symbol">_</a><a id="2901" class="CatchallClause"> </a><a id="2902" class="CatchallClause Symbol">|</a><a id="2903" class="CatchallClause"> </a><a id="2904" href="Relation.Nullary.html#1694" class="CatchallClause InductiveConstructor">no</a><a id="2906" class="CatchallClause"> </a><a id="2907" href="BitML.Contracts.Validity.html#2907" class="CatchallClause Bound">¬parts-⊆</a><a id="2915" class="CatchallClause"> </a><a id="2916" class="CatchallClause Symbol">|</a><a id="2917" class="CatchallClause"> </a><a id="2918" class="CatchallClause Symbol">_</a>                <a id="2935" class="Symbol">=</a> <a id="2937" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="2940" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2942" href="BitML.Contracts.Validity.html#2907" class="Bound">¬parts-⊆</a>    <a id="2954" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2956" href="BitML.Contracts.Validity.html#1994" class="Field">parts-⊆</a>
  <a id="2966" class="CatchallClause Symbol">...</a><a id="2969" class="CatchallClause"> </a><a id="2970" class="CatchallClause Symbol">|</a><a id="2971" class="CatchallClause"> </a><a id="2972" class="CatchallClause Symbol">_</a><a id="2973" class="CatchallClause"> </a><a id="2974" class="CatchallClause Symbol">|</a><a id="2975" class="CatchallClause"> </a><a id="2976" class="CatchallClause Symbol">_</a><a id="2977" class="CatchallClause"> </a><a id="2978" class="CatchallClause Symbol">|</a><a id="2979" class="CatchallClause"> </a><a id="2980" class="CatchallClause Symbol">_</a><a id="2981" class="CatchallClause"> </a><a id="2982" class="CatchallClause Symbol">|</a><a id="2983" class="CatchallClause"> </a><a id="2984" class="CatchallClause Symbol">_</a><a id="2985" class="CatchallClause"> </a><a id="2986" class="CatchallClause Symbol">|</a><a id="2987" class="CatchallClause"> </a><a id="2988" href="Relation.Nullary.html#1694" class="CatchallClause InductiveConstructor">no</a><a id="2990" class="CatchallClause"> </a><a id="2991" href="BitML.Contracts.Validity.html#2991" class="CatchallClause Bound">¬splits-OK</a>              <a id="3015" class="Symbol">=</a> <a id="3017" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="3020" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3022" href="BitML.Contracts.Validity.html#2991" class="Bound">¬splits-OK</a>  <a id="3034" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3036" href="BitML.Contracts.Validity.html#2121" class="Field">splits-OK</a>
  <a id="3048" class="Symbol">...</a> <a id="3052" class="Symbol">|</a> <a id="3054" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="3058" href="BitML.Contracts.Validity.html#3058" class="Bound">p₁</a> <a id="3061" class="Symbol">|</a> <a id="3063" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="3067" href="BitML.Contracts.Validity.html#3067" class="Bound">p₂</a> <a id="3070" class="Symbol">|</a> <a id="3072" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="3076" href="BitML.Contracts.Validity.html#3076" class="Bound">p₃</a> <a id="3079" class="Symbol">|</a> <a id="3081" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="3085" href="BitML.Contracts.Validity.html#3085" class="Bound">p₄</a> <a id="3088" class="Symbol">|</a> <a id="3090" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="3094" href="BitML.Contracts.Validity.html#3094" class="Bound">p₅</a> <a id="3097" class="Symbol">=</a> <a id="3099" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="3103" class="Symbol">λ</a> <a id="3105" class="Keyword">where</a>
    <a id="3115" class="Symbol">.</a><a id="3116" href="BitML.Contracts.Validity.html#1618" class="Field">names-uniq</a> <a id="3127" class="Symbol">→</a> <a id="3129" href="BitML.Contracts.Validity.html#3058" class="Bound">p₁</a><a id="3131" class="Symbol">;</a> <a id="3133" class="Symbol">.</a><a id="3134" href="BitML.Contracts.Validity.html#1705" class="Field">names-⊆</a> <a id="3142" class="Symbol">→</a> <a id="3144" href="BitML.Contracts.Validity.html#3067" class="Bound">p₂</a><a id="3146" class="Symbol">;</a> <a id="3148" class="Symbol">.</a><a id="3149" href="BitML.Contracts.Validity.html#1837" class="Field">names-put</a> <a id="3159" class="Symbol">→</a> <a id="3161" href="BitML.Contracts.Validity.html#3076" class="Bound">p₃</a><a id="3163" class="Symbol">;</a> <a id="3165" class="Symbol">.</a><a id="3166" href="BitML.Contracts.Validity.html#1994" class="Field">parts-⊆</a> <a id="3174" class="Symbol">→</a> <a id="3176" href="BitML.Contracts.Validity.html#3085" class="Bound">p₄</a><a id="3178" class="Symbol">;</a> <a id="3180" class="Symbol">.</a><a id="3181" href="BitML.Contracts.Validity.html#2121" class="Field">splits-OK</a> <a id="3191" class="Symbol">→</a> <a id="3193" href="BitML.Contracts.Validity.html#3094" class="Bound">p₅</a>

<a id="Valid⇒part⊆"></a><a id="3197" href="BitML.Contracts.Validity.html#3197" class="Function">Valid⇒part⊆</a> <a id="3209" class="Symbol">:</a> <a id="3211" class="Keyword">let</a> <a id="3215" href="BitML.Contracts.Types.html#2313" class="InductiveConstructor Operator">⟨</a> <a id="3217" href="BitML.Contracts.Validity.html#3217" class="Bound">G</a> <a id="3219" href="BitML.Contracts.Types.html#2313" class="InductiveConstructor Operator">⟩</a> <a id="3221" href="BitML.Contracts.Validity.html#3221" class="Bound">C</a> <a id="3223" class="Symbol">=</a> <a id="3225" href="BitML.Contracts.Types.html#2449" class="Generalizable">ad</a> <a id="3228" class="Keyword">in</a>
  <a id="3233" href="Prelude.Validity.html#343" class="Field">Valid</a> <a id="3239" href="BitML.Contracts.Types.html#2449" class="Generalizable">ad</a> <a id="3242" class="Symbol">→</a> <a id="3244" href="BitML.Contracts.Collections.html#2535" class="Function">participants</a> <a id="3257" href="BitML.Contracts.Validity.html#3221" class="Bound">C</a> <a id="3259" href="Data.List.Relation.Binary.Subset.Setoid.html#748" class="Function Operator">L.SubS.⊆</a> <a id="3268" href="BitML.Contracts.Collections.html#2535" class="Function">participants</a> <a id="3281" href="BitML.Contracts.Validity.html#3217" class="Bound">G</a>
<a id="3283" href="BitML.Contracts.Validity.html#3197" class="Function">Valid⇒part⊆</a> <a id="3295" class="Symbol">{</a><a id="3296" href="BitML.Contracts.Types.html#2313" class="InductiveConstructor Operator">⟨</a> <a id="3298" href="BitML.Contracts.Validity.html#3298" class="Bound">G</a> <a id="3300" href="BitML.Contracts.Types.html#2313" class="InductiveConstructor Operator">⟩</a> <a id="3302" href="BitML.Contracts.Validity.html#3302" class="Bound">C</a><a id="3303" class="Symbol">}</a> <a id="3305" href="BitML.Contracts.Validity.html#3305" class="Bound">vad</a>
  <a id="3311" class="Symbol">=</a> <a id="3313" href="BitML.Contracts.Collections.html#11285" class="Function">persistentParticipants⊆</a> <a id="3337" class="Symbol">{</a><a id="3338" class="Argument">g</a> <a id="3340" class="Symbol">=</a> <a id="3342" href="BitML.Contracts.Validity.html#3298" class="Bound">G</a><a id="3343" class="Symbol">}</a>
  <a id="3347" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3349" href="BitML.Contracts.Validity.html#3305" class="Bound">vad</a> <a id="3353" href="BitML.Contracts.Validity.html#2247" class="Function Operator">∙parts-⊆</a>
  <a id="3364" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3366" href="Data.List.Membership.Propositional.Properties.html#4054" class="Function">L.Mem.∈-++⁺ʳ</a> <a id="3379" class="Symbol">(</a><a id="3380" href="BitML.Contracts.Collections.html#2535" class="Function">participants</a> <a id="3393" href="BitML.Contracts.Validity.html#3298" class="Bound">G</a><a id="3394" class="Symbol">)</a>
</pre></body></html>