<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>BitML.Contracts.Validity</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-bitml/tree/sets/BitML/Contracts/Validity.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Validity of advertisements.</a>
<a id="105" class="Comment">------------------------------------------------------------------------</a>
<a id="178" class="Keyword">open</a> <a id="183" class="Keyword">import</a> <a id="190" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="203" class="Keyword">open</a> <a id="208" class="Keyword">import</a> <a id="215" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="231" class="Keyword">open</a> <a id="236" class="Keyword">import</a> <a id="243" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="257" class="Keyword">open</a> <a id="262" class="Keyword">import</a> <a id="269" href="Prelude.DecLists.html" class="Module">Prelude.DecLists</a>
<a id="286" class="Keyword">open</a> <a id="291" class="Keyword">import</a> <a id="298" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="312" class="Keyword">open</a> <a id="317" class="Keyword">import</a> <a id="324" href="Prelude.Sets.html" class="Module">Prelude.Sets</a>
<a id="337" class="Keyword">open</a> <a id="342" class="Keyword">import</a> <a id="349" href="Prelude.Measurable.html" class="Module">Prelude.Measurable</a>
<a id="368" class="Keyword">open</a> <a id="373" class="Keyword">import</a> <a id="380" href="Prelude.Collections.html" class="Module">Prelude.Collections</a>
<a id="400" class="Keyword">open</a> <a id="405" class="Keyword">import</a> <a id="412" href="Prelude.Membership.html" class="Module">Prelude.Membership</a>
<a id="431" class="Keyword">open</a> <a id="436" class="Keyword">import</a> <a id="443" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="459" class="Keyword">open</a> <a id="464" class="Keyword">import</a> <a id="471" href="Prelude.Foldable.html" class="Module">Prelude.Foldable</a>
<a id="488" class="Keyword">open</a> <a id="493" class="Keyword">import</a> <a id="500" href="Prelude.Traversable.html" class="Module">Prelude.Traversable</a>
<a id="520" class="Keyword">open</a> <a id="525" class="Keyword">import</a> <a id="532" href="Prelude.Monad.html" class="Module">Prelude.Monad</a>
<a id="546" class="Keyword">open</a> <a id="551" class="Keyword">import</a> <a id="558" href="Prelude.Validity.html" class="Module">Prelude.Validity</a>
<a id="575" class="Keyword">open</a> <a id="580" class="Keyword">import</a> <a id="587" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>

<a id="606" class="Keyword">open</a> <a id="611" class="Keyword">import</a> <a id="618" href="BitML.BasicTypes.html" class="Module">BitML.BasicTypes</a>
<a id="635" class="Keyword">open</a> <a id="640" class="Keyword">import</a> <a id="647" href="BitML.Predicate.html" class="Module">BitML.Predicate</a> <a id="663" class="Keyword">hiding</a> <a id="670" class="Symbol">(</a><a id="671" href="BitML.Predicate.html#349" class="InductiveConstructor Operator">∣_∣</a><a id="674" class="Symbol">)</a>

<a id="677" class="Keyword">module</a> <a id="684" href="BitML.Contracts.Validity.html" class="Module">BitML.Contracts.Validity</a>
  <a id="711" class="Symbol">(</a><a id="712" href="BitML.Contracts.Validity.html#712" class="Bound">Participant</a> <a id="724" class="Symbol">:</a> <a id="726" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="729" class="Symbol">)</a>
  <a id="733" class="Symbol">⦃</a> <a id="735" href="BitML.Contracts.Validity.html#735" class="Bound">_</a> <a id="737" class="Symbol">:</a> <a id="739" href="Prelude.DecEq.Core.html#114" class="Record">DecEq</a> <a id="745" href="BitML.Contracts.Validity.html#712" class="Bound">Participant</a> <a id="757" class="Symbol">⦄</a>
  <a id="761" class="Symbol">(</a><a id="762" href="BitML.Contracts.Validity.html#762" class="Bound">Honest</a> <a id="769" class="Symbol">:</a> <a id="771" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a> <a id="777" href="BitML.Contracts.Validity.html#712" class="Bound">Participant</a><a id="788" class="Symbol">)</a>
  <a id="792" class="Keyword">where</a>

<a id="799" class="Keyword">open</a> <a id="804" class="Keyword">import</a> <a id="811" href="BitML.Contracts.Types.html" class="Module">BitML.Contracts.Types</a> <a id="833" href="BitML.Contracts.Validity.html#712" class="Bound">Participant</a> <a id="845" href="BitML.Contracts.Validity.html#762" class="Bound">Honest</a> <a id="852" class="Keyword">hiding</a> <a id="859" class="Symbol">(</a><a id="860" href="BitML.Contracts.Types.html#511" class="Generalizable">B</a><a id="861" class="Symbol">)</a>
<a id="863" class="Keyword">open</a> <a id="868" class="Keyword">import</a> <a id="875" href="BitML.Contracts.Helpers.html" class="Module">BitML.Contracts.Helpers</a> <a id="899" href="BitML.Contracts.Validity.html#712" class="Bound">Participant</a> <a id="911" href="BitML.Contracts.Validity.html#762" class="Bound">Honest</a>

<a id="splitsOK"></a><a id="919" href="BitML.Contracts.Validity.html#919" class="Function">splitsOK</a> <a id="928" class="Symbol">:</a> <a id="930" href="BitML.Contracts.Types.html#1835" class="Datatype">Precondition</a> <a id="943" class="Symbol">→</a> <a id="945" href="BitML.Contracts.Types.html#641" class="Function">Contracts</a> <a id="955" class="Symbol">→</a> <a id="957" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="962" href="BitML.Contracts.Validity.html#919" class="Function">splitsOK</a> <a id="971" href="BitML.Contracts.Validity.html#971" class="Bound">G</a> <a id="973" href="BitML.Contracts.Validity.html#973" class="Bound">C₀</a> <a id="976" class="Symbol">=</a> <a id="978" href="BitML.Contracts.Validity.html#1383" class="Function">goᶜˢ</a> <a id="983" href="BitML.Contracts.Validity.html#973" class="Bound">C₀</a> <a id="986" class="Symbol">(</a><a id="987" href="BitML.Contracts.Helpers.html#12147" class="Function">persistentValue</a> <a id="1003" href="BitML.Contracts.Validity.html#971" class="Bound">G</a><a id="1004" class="Symbol">)</a>
  <a id="1008" class="Keyword">where</a> <a id="1014" class="Keyword">mutual</a>
    <a id="1025" href="BitML.Contracts.Validity.html#1025" class="Function">goᶜ</a> <a id="1029" class="Symbol">:</a> <a id="1031" href="BitML.Contracts.Types.html#626" class="Datatype">Contract</a> <a id="1040" class="Symbol">→</a> <a id="1042" href="BitML.BasicTypes.html#280" class="Function">Value</a> <a id="1048" class="Symbol">→</a> <a id="1050" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="1059" href="BitML.Contracts.Validity.html#1025" class="Function">goᶜ</a> <a id="1063" href="BitML.Contracts.Validity.html#1063" class="Bound">c₀</a><a id="1065" class="Symbol">@(</a><a id="1067" href="BitML.Contracts.Types.html#763" class="InductiveConstructor Operator">put</a> <a id="1071" href="BitML.Contracts.Validity.html#1071" class="Bound">xs</a> <a id="1074" href="BitML.Contracts.Types.html#763" class="InductiveConstructor Operator">&amp;reveal</a> <a id="1082" href="BitML.Contracts.Validity.html#1082" class="Bound">as</a> <a id="1085" href="BitML.Contracts.Types.html#763" class="InductiveConstructor Operator">if</a> <a id="1088" href="BitML.Contracts.Validity.html#1088" class="Bound">p</a> <a id="1090" href="BitML.Contracts.Types.html#763" class="InductiveConstructor Operator">⇒</a> <a id="1092" href="BitML.Contracts.Validity.html#1092" class="Bound">c</a><a id="1093" class="Symbol">)</a> <a id="1095" href="BitML.Contracts.Validity.html#1095" class="Bound">v</a>
      <a id="1103" class="Keyword">with</a> <a id="1108" href="Prelude.Sets.AsUniqueLists.Extra.html#8898" class="Function">sequenceMˢ</a> <a id="1119" class="Symbol">(</a><a id="1120" href="Prelude.Sets.AsUniqueLists.Extra.html#5680" class="Function">mapˢ</a> <a id="1125" class="Symbol">(λ</a> <a id="1128" href="BitML.Contracts.Validity.html#1128" class="Bound">x</a> <a id="1130" class="Symbol">→</a> <a id="1132" href="BitML.Contracts.Helpers.html#16983" class="Function">checkDeposit</a> <a id="1145" href="BitML.Contracts.Types.html#2932" class="InductiveConstructor">volatile</a> <a id="1154" href="BitML.Contracts.Validity.html#1128" class="Bound">x</a> <a id="1156" href="BitML.Contracts.Validity.html#971" class="Bound">G</a><a id="1157" class="Symbol">)</a> <a id="1159" href="BitML.Contracts.Validity.html#1071" class="Bound">xs</a><a id="1161" class="Symbol">)</a>
    <a id="1167" class="Symbol">...</a> <a id="1171" class="Symbol">|</a> <a id="1173" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="1181" class="Symbol">=</a> <a id="1183" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
    <a id="1193" class="Symbol">...</a> <a id="1197" class="Symbol">|</a> <a id="1199" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1204" href="BitML.Contracts.Validity.html#1204" class="Bound">vs</a> <a id="1207" class="Symbol">=</a> <a id="1209" href="BitML.Contracts.Validity.html#1383" class="Function">goᶜˢ</a> <a id="1214" class="Bound">c</a> <a id="1216" class="Symbol">(</a><a id="1217" href="Prelude.Sets.AsUniqueLists.Extra.html#16681" class="Function">sumˢ</a> <a id="1222" href="BitML.Contracts.Validity.html#1204" class="Bound">vs</a><a id="1224" class="Symbol">)</a>
    <a id="1230" href="BitML.Contracts.Validity.html#1025" class="Function">goᶜ</a> <a id="1234" class="Symbol">(</a><a id="1235" href="BitML.Contracts.Types.html#1016" class="InductiveConstructor">split</a> <a id="1241" href="BitML.Contracts.Validity.html#1241" class="Bound">vcs</a><a id="1244" class="Symbol">)</a>   <a id="1248" href="BitML.Contracts.Validity.html#1248" class="Bound">v</a> <a id="1250" class="Symbol">=</a> <a id="1252" class="Symbol">(</a><a id="1253" href="Prelude.Lists.Sums.html#349" class="Function">∑₁</a> <a id="1256" href="BitML.Contracts.Validity.html#1241" class="Bound">vcs</a> <a id="1260" href="Prelude.DecEq.Core.html#188" class="Function Operator">==</a> <a id="1263" href="BitML.Contracts.Validity.html#1248" class="Bound">v</a><a id="1264" class="Symbol">)</a> <a id="1266" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="1268" href="BitML.Contracts.Validity.html#1483" class="Function">goᵛᶜˢ</a> <a id="1274" href="BitML.Contracts.Validity.html#1241" class="Bound">vcs</a>
    <a id="1282" href="BitML.Contracts.Validity.html#1025" class="Function">goᶜ</a> <a id="1286" class="Symbol">(</a><a id="1287" href="BitML.Contracts.Types.html#1164" class="InductiveConstructor Operator">after</a> <a id="1293" class="Symbol">_</a> <a id="1295" href="BitML.Contracts.Types.html#1164" class="InductiveConstructor Operator">⇒</a> <a id="1297" href="BitML.Contracts.Validity.html#1297" class="Bound">c</a><a id="1298" class="Symbol">)</a> <a id="1300" href="BitML.Contracts.Validity.html#1300" class="Bound">v</a> <a id="1302" class="Symbol">=</a> <a id="1304" href="BitML.Contracts.Validity.html#1025" class="Function">goᶜ</a> <a id="1308" href="BitML.Contracts.Validity.html#1297" class="Bound">c</a> <a id="1310" href="BitML.Contracts.Validity.html#1300" class="Bound">v</a>
    <a id="1316" href="BitML.Contracts.Validity.html#1025" class="Function">goᶜ</a> <a id="1320" class="Symbol">(_</a> <a id="1323" href="BitML.Contracts.Types.html#1091" class="InductiveConstructor Operator">⇒</a> <a id="1325" href="BitML.Contracts.Validity.html#1325" class="Bound">c</a><a id="1326" class="Symbol">)</a>       <a id="1334" href="BitML.Contracts.Validity.html#1334" class="Bound">v</a> <a id="1336" class="Symbol">=</a> <a id="1338" href="BitML.Contracts.Validity.html#1025" class="Function">goᶜ</a> <a id="1342" href="BitML.Contracts.Validity.html#1325" class="Bound">c</a> <a id="1344" href="BitML.Contracts.Validity.html#1334" class="Bound">v</a>
    <a id="1350" href="BitML.Contracts.Validity.html#1025" class="Function">goᶜ</a> <a id="1354" class="Symbol">(</a><a id="1355" href="BitML.Contracts.Types.html#878" class="InductiveConstructor">withdraw</a> <a id="1364" class="Symbol">_)</a>  <a id="1368" class="Symbol">_</a> <a id="1370" class="Symbol">=</a> <a id="1372" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>


    <a id="1383" href="BitML.Contracts.Validity.html#1383" class="Function">goᶜˢ</a> <a id="1388" class="Symbol">:</a> <a id="1390" href="BitML.Contracts.Types.html#641" class="Function">Contracts</a> <a id="1400" class="Symbol">→</a> <a id="1402" href="BitML.BasicTypes.html#280" class="Function">Value</a> <a id="1408" class="Symbol">→</a> <a id="1410" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="1419" href="BitML.Contracts.Validity.html#1383" class="Function">goᶜˢ</a> <a id="1424" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1427" class="Symbol">_</a> <a id="1429" class="Symbol">=</a> <a id="1431" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
    <a id="1440" href="BitML.Contracts.Validity.html#1383" class="Function">goᶜˢ</a> <a id="1445" class="Symbol">(</a><a id="1446" href="BitML.Contracts.Validity.html#1446" class="Bound">c</a> <a id="1448" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1450" href="BitML.Contracts.Validity.html#1450" class="Bound">cs</a><a id="1452" class="Symbol">)</a> <a id="1454" href="BitML.Contracts.Validity.html#1454" class="Bound">v</a> <a id="1456" class="Symbol">=</a> <a id="1458" href="BitML.Contracts.Validity.html#1025" class="Function">goᶜ</a> <a id="1462" href="BitML.Contracts.Validity.html#1446" class="Bound">c</a> <a id="1464" href="BitML.Contracts.Validity.html#1454" class="Bound">v</a> <a id="1466" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="1468" href="BitML.Contracts.Validity.html#1383" class="Function">goᶜˢ</a> <a id="1473" href="BitML.Contracts.Validity.html#1450" class="Bound">cs</a> <a id="1476" href="BitML.Contracts.Validity.html#1454" class="Bound">v</a>

    <a id="1483" href="BitML.Contracts.Validity.html#1483" class="Function">goᵛᶜˢ</a> <a id="1489" class="Symbol">:</a> <a id="1491" href="BitML.Contracts.Types.html#667" class="Function">VContracts</a> <a id="1502" class="Symbol">→</a> <a id="1504" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="1513" href="BitML.Contracts.Validity.html#1483" class="Function">goᵛᶜˢ</a> <a id="1519" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1522" class="Symbol">=</a> <a id="1524" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
    <a id="1533" href="BitML.Contracts.Validity.html#1483" class="Function">goᵛᶜˢ</a> <a id="1539" class="Symbol">((</a><a id="1541" href="BitML.Contracts.Validity.html#1541" class="Bound">v</a> <a id="1543" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1545" href="BitML.Contracts.Validity.html#1545" class="Bound">cs</a><a id="1547" class="Symbol">)</a> <a id="1549" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1551" href="BitML.Contracts.Validity.html#1551" class="Bound">vcs</a><a id="1554" class="Symbol">)</a> <a id="1556" class="Symbol">=</a> <a id="1558" href="BitML.Contracts.Validity.html#1383" class="Function">goᶜˢ</a> <a id="1563" href="BitML.Contracts.Validity.html#1545" class="Bound">cs</a> <a id="1566" href="BitML.Contracts.Validity.html#1541" class="Bound">v</a>

<a id="1569" class="Keyword">record</a> <a id="ValidAdvertisement"></a><a id="1576" href="BitML.Contracts.Validity.html#1576" class="Record">ValidAdvertisement</a> <a id="1595" class="Symbol">(</a><a id="1596" href="BitML.Contracts.Validity.html#1596" class="Bound">ad</a> <a id="1599" class="Symbol">:</a> <a id="1601" href="BitML.Contracts.Types.html#2412" class="Record">Advertisement</a><a id="1614" class="Symbol">)</a> <a id="1616" class="Symbol">:</a> <a id="1618" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1622" class="Keyword">where</a>
  <a id="1630" class="Comment">-- open Advertisement ad renaming (C to c; G to g) -- ⟨ G ⟩ C = ad</a>
  <a id="1699" class="Keyword">field</a>
    <a id="1709" class="Comment">-- (i) names in G are distinct (BY CONSTRUCTION)</a>

    <a id="1763" class="Comment">-- (ii) each name in C appears in G</a>
    <a id="ValidAdvertisement.names-⊆"></a><a id="1803" href="BitML.Contracts.Validity.html#1803" class="Field">names-⊆</a> <a id="1811" class="Symbol">:</a> <a id="1813" href="BitML.Contracts.Helpers.html#6056" class="Function">names</a> <a id="1819" class="Symbol">(</a><a id="1820" href="BitML.Contracts.Types.html#2490" class="Field">C</a> <a id="1822" href="BitML.Contracts.Validity.html#1596" class="Bound">ad</a><a id="1824" class="Symbol">)</a> <a id="1826" href="Prelude.Sets.AsUniqueLists.Core.html#5258" class="Function Operator">⊆ˢ</a> <a id="1829" href="BitML.Contracts.Helpers.html#6056" class="Function">names</a> <a id="1835" class="Symbol">(</a><a id="1836" href="BitML.Contracts.Types.html#2469" class="Field">G</a> <a id="1838" href="BitML.Contracts.Validity.html#1596" class="Bound">ad</a><a id="1840" class="Symbol">)</a>

    <a id="1847" class="Comment">-- (iii) the names in put_&amp;reveal_ are distinct and secrets in `if ...` appear in `reveal ...`</a>
    <a id="ValidAdvertisement.names-put"></a><a id="1946" href="BitML.Contracts.Validity.html#1946" class="Field">names-put</a> <a id="1956" class="Symbol">:</a> <a id="1958" href="Prelude.Sets.AsUniqueLists.Core.html#1772" class="Function">Allˢ</a> <a id="1963" class="Symbol">(λ{</a> <a id="1967" class="Symbol">(</a><a id="1968" href="BitML.Contracts.Validity.html#1968" class="Bound">xs</a> <a id="1971" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1973" href="BitML.Contracts.Validity.html#1973" class="Bound">as</a> <a id="1976" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1978" href="BitML.Contracts.Validity.html#1978" class="Bound">p</a><a id="1979" class="Symbol">)</a> <a id="1981" class="Symbol">→</a> <a id="1983" href="BitML.Contracts.Helpers.html#6261" class="Function">secrets</a> <a id="1991" href="BitML.Contracts.Validity.html#1978" class="Bound">p</a> <a id="1993" href="Prelude.Sets.AsUniqueLists.Core.html#5258" class="Function Operator">⊆ˢ</a> <a id="1996" href="BitML.Contracts.Validity.html#1973" class="Bound">as</a><a id="1998" class="Symbol">})</a> <a id="2001" class="Symbol">(</a><a id="2002" href="BitML.Contracts.Helpers.html#6300" class="Function">putComponents</a> <a id="2016" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="2018" href="BitML.Contracts.Validity.html#1596" class="Bound">ad</a> <a id="2021" class="Symbol">.</a><a id="2022" href="BitML.Contracts.Types.html#2490" class="Field">C</a><a id="2023" class="Symbol">)</a>

    <a id="2030" class="Comment">-- (iv) each participant has a persistent deposit in G</a>
    <a id="ValidAdvertisement.participants-⊆"></a><a id="2089" href="BitML.Contracts.Validity.html#2089" class="Field">participants-⊆</a> <a id="2104" class="Symbol">:</a> <a id="2106" href="BitML.Contracts.Helpers.html#6573" class="Function">participants</a> <a id="2119" class="Symbol">(</a><a id="2120" href="BitML.Contracts.Validity.html#1596" class="Bound">ad</a> <a id="2123" class="Symbol">.</a><a id="2124" href="BitML.Contracts.Types.html#2469" class="Field">G</a><a id="2125" class="Symbol">)</a> <a id="2127" href="Prelude.Sets.AsUniqueLists.Core.html#3072" class="Function Operator">∪</a> <a id="2129" href="BitML.Contracts.Helpers.html#6573" class="Function">participants</a> <a id="2142" class="Symbol">(</a><a id="2143" href="BitML.Contracts.Validity.html#1596" class="Bound">ad</a> <a id="2146" class="Symbol">.</a><a id="2147" href="BitML.Contracts.Types.html#2490" class="Field">C</a><a id="2148" class="Symbol">)</a> <a id="2150" href="Prelude.Sets.AsUniqueLists.Core.html#5258" class="Function Operator">⊆ˢ</a> <a id="2153" href="BitML.Contracts.Helpers.html#12275" class="Function">persistentParticipants</a> <a id="2176" class="Symbol">(</a><a id="2177" href="BitML.Contracts.Validity.html#1596" class="Bound">ad</a> <a id="2180" class="Symbol">.</a><a id="2181" href="BitML.Contracts.Types.html#2469" class="Field">G</a><a id="2182" class="Symbol">)</a>

    <a id="2189" class="Comment">-- (extra) split commands are valid</a>
    <a id="ValidAdvertisement.splits-OK"></a><a id="2229" href="BitML.Contracts.Validity.html#2229" class="Field">splits-OK</a> <a id="2239" class="Symbol">:</a> <a id="2241" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="2243" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="2245" href="BitML.Contracts.Validity.html#919" class="Function">splitsOK</a> <a id="2254" class="Symbol">(</a><a id="2255" href="BitML.Contracts.Validity.html#1596" class="Bound">ad</a> <a id="2258" class="Symbol">.</a><a id="2259" href="BitML.Contracts.Types.html#2469" class="Field">G</a><a id="2260" class="Symbol">)</a> <a id="2262" class="Symbol">(</a><a id="2263" href="BitML.Contracts.Validity.html#1596" class="Bound">ad</a> <a id="2266" class="Symbol">.</a><a id="2267" href="BitML.Contracts.Types.html#2490" class="Field">C</a><a id="2268" class="Symbol">)</a>

<a id="2271" class="Keyword">open</a> <a id="2276" href="BitML.Contracts.Validity.html#1576" class="Module">ValidAdvertisement</a> <a id="2295" class="Keyword">public</a>

<a id="2303" class="Keyword">instance</a>
  <a id="𝕍Ad"></a><a id="2314" href="BitML.Contracts.Validity.html#2314" class="Function">𝕍Ad</a> <a id="2318" class="Symbol">:</a> <a id="2320" href="Prelude.Validity.html#263" class="Record">Validable</a> <a id="2330" href="BitML.Contracts.Types.html#2412" class="Record">Advertisement</a>
  <a id="2346" href="BitML.Contracts.Validity.html#2314" class="Function">𝕍Ad</a> <a id="2350" class="Symbol">.</a><a id="2351" href="Prelude.Validity.html#322" class="Field">Valid</a> <a id="2357" class="Symbol">=</a> <a id="2359" href="BitML.Contracts.Validity.html#1576" class="Record">ValidAdvertisement</a>

  <a id="Dec-𝕍Ad"></a><a id="2381" href="BitML.Contracts.Validity.html#2381" class="Function">Dec-𝕍Ad</a> <a id="2389" class="Symbol">:</a> <a id="2391" href="Prelude.Validity.html#322" class="Field">Valid</a> <a id="2397" href="Prelude.Decidable.Base.html#504" class="Function Operator">⁇¹</a>
  <a id="2402" href="BitML.Contracts.Validity.html#2381" class="Function">Dec-𝕍Ad</a> <a id="2410" class="Symbol">{</a><a id="2411" class="Argument">x</a> <a id="2413" class="Symbol">=</a> <a id="2415" href="BitML.Contracts.Types.html#2452" class="InductiveConstructor Operator">⟨</a> <a id="2417" href="BitML.Contracts.Validity.html#2417" class="Bound">G</a> <a id="2419" href="BitML.Contracts.Types.html#2452" class="InductiveConstructor Operator">⟩</a> <a id="2421" href="BitML.Contracts.Validity.html#2421" class="Bound">C</a><a id="2422" class="Symbol">}</a> <a id="2424" class="Symbol">.</a><a id="2425" href="Prelude.Decidable.Base.html#143" class="Field">dec</a>
    <a id="2433" class="Keyword">with</a> <a id="2438" href="BitML.Contracts.Helpers.html#6056" class="Function">names</a> <a id="2444" href="BitML.Contracts.Validity.html#2421" class="Bound">C</a> <a id="2446" href="Prelude.Sets.AsUniqueLists.Core.html#5352" class="Function Operator">⊆?ˢ</a> <a id="2450" href="BitML.Contracts.Helpers.html#6056" class="Function">names</a> <a id="2456" href="BitML.Contracts.Validity.html#2417" class="Bound">G</a>
       <a id="2465" class="Symbol">|</a> <a id="2467" href="Prelude.Sets.AsUniqueLists.Core.html#1836" class="Function">allˢ?</a> <a id="2473" class="Symbol">(λ{</a> <a id="2477" class="Symbol">(</a><a id="2478" href="BitML.Contracts.Validity.html#2478" class="Bound">xs</a> <a id="2481" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2483" href="BitML.Contracts.Validity.html#2483" class="Bound">as</a> <a id="2486" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2488" href="BitML.Contracts.Validity.html#2488" class="Bound">p</a><a id="2489" class="Symbol">)</a> <a id="2491" class="Symbol">→</a> <a id="2493" class="Symbol">(</a><a id="2494" href="BitML.Contracts.Helpers.html#6261" class="Function">secrets</a> <a id="2502" href="BitML.Contracts.Validity.html#2488" class="Bound">p</a> <a id="2504" href="Prelude.Sets.AsUniqueLists.Core.html#5352" class="Function Operator">⊆?ˢ</a> <a id="2508" href="BitML.Contracts.Validity.html#2483" class="Bound">as</a><a id="2510" class="Symbol">)})</a> <a id="2514" class="Symbol">(</a><a id="2515" href="BitML.Contracts.Helpers.html#6300" class="Function">putComponents</a> <a id="2529" href="BitML.Contracts.Validity.html#2421" class="Bound">C</a><a id="2530" class="Symbol">)</a>
       <a id="2539" class="Symbol">|</a> <a id="2541" class="Symbol">(</a><a id="2542" href="BitML.Contracts.Helpers.html#6573" class="Function">participants</a> <a id="2555" href="BitML.Contracts.Validity.html#2417" class="Bound">G</a> <a id="2557" href="Prelude.Sets.AsUniqueLists.Core.html#3072" class="Function Operator">∪</a> <a id="2559" href="BitML.Contracts.Helpers.html#6573" class="Function">participants</a> <a id="2572" href="BitML.Contracts.Validity.html#2421" class="Bound">C</a><a id="2573" class="Symbol">)</a> <a id="2575" href="Prelude.Sets.AsUniqueLists.Core.html#5352" class="Function Operator">⊆?ˢ</a> <a id="2579" href="BitML.Contracts.Helpers.html#12275" class="Function">persistentParticipants</a> <a id="2602" href="BitML.Contracts.Validity.html#2417" class="Bound">G</a>
       <a id="2611" class="Symbol">|</a> <a id="2613" href="Data.Bool.Properties.html#15470" class="Function">T?</a> <a id="2616" class="Symbol">(</a><a id="2617" href="BitML.Contracts.Validity.html#919" class="Function">splitsOK</a> <a id="2626" href="BitML.Contracts.Validity.html#2417" class="Bound">G</a> <a id="2628" href="BitML.Contracts.Validity.html#2421" class="Bound">C</a><a id="2629" class="Symbol">)</a>
  <a id="2633" class="Symbol">...</a> <a id="2637" class="Symbol">|</a> <a id="2639" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2642" href="BitML.Contracts.Validity.html#2642" class="Bound">¬names-⊆</a> <a id="2651" class="Symbol">|</a> <a id="2653" class="Symbol">_</a> <a id="2655" class="Symbol">|</a> <a id="2657" class="Symbol">_</a> <a id="2659" class="Symbol">|</a> <a id="2661" class="Symbol">_</a>        <a id="2670" class="Symbol">=</a> <a id="2672" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2675" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="2677" href="BitML.Contracts.Validity.html#2642" class="Bound">¬names-⊆</a> <a id="2686" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2688" href="BitML.Contracts.Validity.html#1803" class="Field">names-⊆</a>
  <a id="2698" class="CatchallClause Symbol">...</a><a id="2701" class="CatchallClause"> </a><a id="2702" class="CatchallClause Symbol">|</a><a id="2703" class="CatchallClause"> </a><a id="2704" class="CatchallClause Symbol">_</a><a id="2705" class="CatchallClause"> </a><a id="2706" class="CatchallClause Symbol">|</a><a id="2707" class="CatchallClause"> </a><a id="2708" href="Relation.Nullary.html#1685" class="CatchallClause InductiveConstructor">no</a><a id="2710" class="CatchallClause"> </a><a id="2711" href="BitML.Contracts.Validity.html#2711" class="CatchallClause Bound">¬names-put</a><a id="2721" class="CatchallClause"> </a><a id="2722" class="CatchallClause Symbol">|</a><a id="2723" class="CatchallClause"> </a><a id="2724" class="CatchallClause Symbol">_</a><a id="2725" class="CatchallClause"> </a><a id="2726" class="CatchallClause Symbol">|</a><a id="2727" class="CatchallClause"> </a><a id="2728" class="CatchallClause Symbol">_</a>      <a id="2735" class="Symbol">=</a> <a id="2737" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2740" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="2742" href="BitML.Contracts.Validity.html#2711" class="Bound">¬names-put</a> <a id="2753" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2755" href="BitML.Contracts.Validity.html#1946" class="Field">names-put</a>
  <a id="2767" class="CatchallClause Symbol">...</a><a id="2770" class="CatchallClause"> </a><a id="2771" class="CatchallClause Symbol">|</a><a id="2772" class="CatchallClause"> </a><a id="2773" class="CatchallClause Symbol">_</a><a id="2774" class="CatchallClause"> </a><a id="2775" class="CatchallClause Symbol">|</a><a id="2776" class="CatchallClause"> </a><a id="2777" class="CatchallClause Symbol">_</a><a id="2778" class="CatchallClause"> </a><a id="2779" class="CatchallClause Symbol">|</a><a id="2780" class="CatchallClause"> </a><a id="2781" href="Relation.Nullary.html#1685" class="CatchallClause InductiveConstructor">no</a><a id="2783" class="CatchallClause"> </a><a id="2784" href="BitML.Contracts.Validity.html#2784" class="CatchallClause Bound">¬participants-⊆</a><a id="2799" class="CatchallClause"> </a><a id="2800" class="CatchallClause Symbol">|</a><a id="2801" class="CatchallClause"> </a><a id="2802" class="CatchallClause Symbol">_</a> <a id="2804" class="Symbol">=</a> <a id="2806" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2809" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="2811" href="BitML.Contracts.Validity.html#2784" class="Bound">¬participants-⊆</a> <a id="2827" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2829" href="BitML.Contracts.Validity.html#2089" class="Field">participants-⊆</a>
  <a id="2846" class="CatchallClause Symbol">...</a><a id="2849" class="CatchallClause"> </a><a id="2850" class="CatchallClause Symbol">|</a><a id="2851" class="CatchallClause"> </a><a id="2852" class="CatchallClause Symbol">_</a><a id="2853" class="CatchallClause"> </a><a id="2854" class="CatchallClause Symbol">|</a><a id="2855" class="CatchallClause"> </a><a id="2856" class="CatchallClause Symbol">_</a><a id="2857" class="CatchallClause"> </a><a id="2858" class="CatchallClause Symbol">|</a><a id="2859" class="CatchallClause"> </a><a id="2860" class="CatchallClause Symbol">_</a><a id="2861" class="CatchallClause"> </a><a id="2862" class="CatchallClause Symbol">|</a><a id="2863" class="CatchallClause"> </a><a id="2864" href="Relation.Nullary.html#1685" class="CatchallClause InductiveConstructor">no</a><a id="2866" class="CatchallClause"> </a><a id="2867" href="BitML.Contracts.Validity.html#2867" class="CatchallClause Bound">¬splits-OK</a>      <a id="2883" class="Symbol">=</a> <a id="2885" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2888" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="2890" href="BitML.Contracts.Validity.html#2867" class="Bound">¬splits-OK</a> <a id="2901" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2903" href="BitML.Contracts.Validity.html#2229" class="Field">splits-OK</a>
  <a id="2915" class="Symbol">...</a> <a id="2919" class="Symbol">|</a> <a id="2921" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2925" href="BitML.Contracts.Validity.html#2925" class="Bound">p₁</a> <a id="2928" class="Symbol">|</a> <a id="2930" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2934" href="BitML.Contracts.Validity.html#2934" class="Bound">p₂</a> <a id="2937" class="Symbol">|</a> <a id="2939" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2943" href="BitML.Contracts.Validity.html#2943" class="Bound">p₃</a> <a id="2946" class="Symbol">|</a> <a id="2948" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2952" href="BitML.Contracts.Validity.html#2952" class="Bound">p₄</a> <a id="2955" class="Symbol">=</a> <a id="2957" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2961" class="Symbol">λ</a> <a id="2963" class="Keyword">where</a>
    <a id="2973" class="Symbol">.</a><a id="2974" href="BitML.Contracts.Validity.html#1803" class="Field">names-⊆</a> <a id="2982" class="Symbol">→</a> <a id="2984" href="BitML.Contracts.Validity.html#2925" class="Bound">p₁</a><a id="2986" class="Symbol">;</a> <a id="2988" class="Symbol">.</a><a id="2989" href="BitML.Contracts.Validity.html#1946" class="Field">names-put</a> <a id="2999" class="Symbol">→</a> <a id="3001" href="BitML.Contracts.Validity.html#2934" class="Bound">p₂</a><a id="3003" class="Symbol">;</a> <a id="3005" class="Symbol">.</a><a id="3006" href="BitML.Contracts.Validity.html#2089" class="Field">participants-⊆</a> <a id="3021" class="Symbol">→</a> <a id="3023" href="BitML.Contracts.Validity.html#2943" class="Bound">p₃</a><a id="3025" class="Symbol">;</a> <a id="3027" class="Symbol">.</a><a id="3028" href="BitML.Contracts.Validity.html#2229" class="Field">splits-OK</a> <a id="3038" class="Symbol">→</a> <a id="3040" href="BitML.Contracts.Validity.html#2952" class="Bound">p₄</a>

<a id="3044" class="Comment">-- Properties.</a>

<a id="Valid⇒part⊆"></a><a id="3060" href="BitML.Contracts.Validity.html#3060" class="Function">Valid⇒part⊆</a> <a id="3072" class="Symbol">:</a> <a id="3074" class="Keyword">let</a> <a id="3078" href="BitML.Contracts.Types.html#2452" class="InductiveConstructor Operator">⟨</a> <a id="3080" href="BitML.Contracts.Validity.html#3080" class="Bound">G</a> <a id="3082" href="BitML.Contracts.Types.html#2452" class="InductiveConstructor Operator">⟩</a> <a id="3084" href="BitML.Contracts.Validity.html#3084" class="Bound">C</a> <a id="3086" class="Symbol">=</a> <a id="3088" href="BitML.Contracts.Types.html#2652" class="Generalizable">ad</a> <a id="3091" class="Keyword">in</a>
  <a id="3096" href="Prelude.Validity.html#322" class="Field">Valid</a> <a id="3102" href="BitML.Contracts.Types.html#2652" class="Generalizable">ad</a> <a id="3105" class="Symbol">→</a> <a id="3107" href="BitML.Contracts.Helpers.html#6573" class="Function">participants</a> <a id="3120" href="BitML.Contracts.Validity.html#3084" class="Bound">C</a> <a id="3122" href="Prelude.Sets.AsUniqueLists.Core.html#5258" class="Function Operator">⊆ˢ</a> <a id="3125" href="BitML.Contracts.Helpers.html#6573" class="Function">participants</a> <a id="3138" href="BitML.Contracts.Validity.html#3080" class="Bound">G</a>
<a id="3140" href="BitML.Contracts.Validity.html#3060" class="Function">Valid⇒part⊆</a> <a id="3152" class="Symbol">{</a><a id="3153" href="BitML.Contracts.Types.html#2452" class="InductiveConstructor Operator">⟨</a> <a id="3155" href="BitML.Contracts.Validity.html#3155" class="Bound">G</a> <a id="3157" href="BitML.Contracts.Types.html#2452" class="InductiveConstructor Operator">⟩</a> <a id="3159" href="BitML.Contracts.Validity.html#3159" class="Bound">C</a><a id="3160" class="Symbol">}</a> <a id="3162" href="BitML.Contracts.Validity.html#3162" class="Bound">vad</a>
  <a id="3168" class="Symbol">=</a> <a id="3170" href="BitML.Contracts.Helpers.html#15437" class="Function">persistentParticipants⊆</a> <a id="3194" class="Symbol">{</a><a id="3195" class="Argument">g</a> <a id="3197" class="Symbol">=</a> <a id="3199" href="BitML.Contracts.Validity.html#3155" class="Bound">G</a><a id="3200" class="Symbol">}</a>
  <a id="3204" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3206" href="BitML.Contracts.Validity.html#3162" class="Bound">vad</a> <a id="3210" class="Symbol">.</a><a id="3211" href="BitML.Contracts.Validity.html#2089" class="Field">participants-⊆</a>
  <a id="3228" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3230" href="Prelude.Sets.AsUniqueLists.Core.html#3941" class="Function">∈-∪⁺ʳ</a> <a id="3236" class="Symbol">_</a> <a id="3238" class="Symbol">(</a><a id="3239" href="BitML.Contracts.Helpers.html#6573" class="Function">participants</a> <a id="3252" href="BitML.Contracts.Validity.html#3155" class="Bound">G</a><a id="3253" class="Symbol">)</a> <a id="3255" class="Symbol">(</a><a id="3256" href="BitML.Contracts.Helpers.html#6573" class="Function">participants</a> <a id="3269" href="BitML.Contracts.Validity.html#3159" class="Bound">C</a><a id="3270" class="Symbol">)</a>

<a id="subterms′-part⊆ᵃ"></a><a id="3273" href="BitML.Contracts.Validity.html#3273" class="Function">subterms′-part⊆ᵃ</a> <a id="3290" class="Symbol">:</a> <a id="3292" href="Prelude.Validity.html#322" class="Field">Valid</a> <a id="3298" href="BitML.Contracts.Types.html#2652" class="Generalizable">ad</a> <a id="3301" class="Symbol">→</a> <a id="3303" href="BitML.Contracts.Types.html#1313" class="Generalizable">d</a> <a id="3305" href="Prelude.Membership.html#400" class="Field Operator">∈</a> <a id="3307" href="BitML.Contracts.Helpers.html#22484" class="Function">subtermsᵃ′</a> <a id="3318" href="BitML.Contracts.Types.html#2652" class="Generalizable">ad</a> <a id="3321" class="Symbol">→</a> <a id="3323" href="BitML.Contracts.Helpers.html#6573" class="Function">participants</a> <a id="3336" href="BitML.Contracts.Types.html#1313" class="Generalizable">d</a> <a id="3338" href="Prelude.Sets.AsUniqueLists.Core.html#5258" class="Function Operator">⊆ˢ</a> <a id="3341" href="BitML.Contracts.Helpers.html#6573" class="Function">participants</a> <a id="3354" class="Symbol">(</a><a id="3355" href="BitML.Contracts.Types.html#2652" class="Generalizable">ad</a> <a id="3358" class="Symbol">.</a><a id="3359" href="BitML.Contracts.Types.html#2469" class="Field">G</a><a id="3360" class="Symbol">)</a>
<a id="3362" href="BitML.Contracts.Validity.html#3273" class="Function">subterms′-part⊆ᵃ</a> <a id="3379" class="Symbol">{</a><a id="3380" href="BitML.Contracts.Validity.html#3380" class="Bound">ad</a><a id="3382" class="Symbol">@(</a><a id="3384" href="BitML.Contracts.Types.html#2452" class="InductiveConstructor Operator">⟨</a> <a id="3386" href="BitML.Contracts.Validity.html#3386" class="Bound">G</a> <a id="3388" href="BitML.Contracts.Types.html#2452" class="InductiveConstructor Operator">⟩</a> <a id="3390" href="BitML.Contracts.Validity.html#3390" class="Bound">C</a><a id="3391" class="Symbol">)}{</a><a id="3394" href="BitML.Contracts.Validity.html#3394" class="Bound">d</a><a id="3395" class="Symbol">}</a> <a id="3397" href="BitML.Contracts.Validity.html#3397" class="Bound">vad</a> <a id="3401" href="BitML.Contracts.Validity.html#3401" class="Bound">d∈</a> <a id="3404" class="Symbol">=</a> <a id="3406" href="BitML.Contracts.Validity.html#3060" class="Function">Valid⇒part⊆</a> <a id="3418" href="BitML.Contracts.Validity.html#3397" class="Bound">vad</a> <a id="3422" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3424" href="BitML.Contracts.Helpers.html#31846" class="Function">subterms′-part⊆ᶜˢ</a> <a id="3442" class="Symbol">{</a><a id="3443" class="Argument">ds</a> <a id="3446" class="Symbol">=</a> <a id="3448" href="BitML.Contracts.Validity.html#3390" class="Bound">C</a><a id="3449" class="Symbol">}</a> <a id="3451" href="BitML.Contracts.Validity.html#3401" class="Bound">d∈</a>
</pre></body></html>