<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>BitML.Contracts.Validity</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Validity of advertisements.</a>
<a id="105" class="Comment">------------------------------------------------------------------------</a>
<a id="178" class="Keyword">open</a> <a id="183" class="Keyword">import</a> <a id="190" href="Function.html" class="Module">Function</a> <a id="199" class="Keyword">using</a> <a id="205" class="Symbol">(</a><a id="206" href="Function.Base.html#615" class="Function">id</a><a id="208" class="Symbol">)</a>

<a id="211" class="Keyword">open</a> <a id="216" class="Keyword">import</a> <a id="223" href="Data.List.Membership.Propositional.Properties.html" class="Module">Data.List.Membership.Propositional.Properties</a>
<a id="269" class="Keyword">open</a> <a id="274" class="Keyword">import</a> <a id="281" href="Data.List.Relation.Binary.Subset.Propositional.Properties.html" class="Module">Data.List.Relation.Binary.Subset.Propositional.Properties</a>

<a id="340" class="Keyword">open</a> <a id="345" class="Keyword">import</a> <a id="352" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="365" class="Keyword">open</a> <a id="370" class="Keyword">import</a> <a id="377" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="393" class="Keyword">open</a> <a id="398" class="Keyword">import</a> <a id="405" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="419" class="Keyword">open</a> <a id="424" class="Keyword">import</a> <a id="431" href="Prelude.DecLists.html" class="Module">Prelude.DecLists</a>
<a id="448" class="Keyword">open</a> <a id="453" class="Keyword">import</a> <a id="460" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="474" class="Comment">-- open import Prelude.Membership</a>
<a id="508" class="Keyword">open</a> <a id="513" class="Keyword">import</a> <a id="520" href="Prelude.Sets.html" class="Module">Prelude.Sets</a>
<a id="533" class="Keyword">open</a> <a id="538" class="Keyword">import</a> <a id="545" href="Prelude.Measurable.html" class="Module">Prelude.Measurable</a>
<a id="564" class="Keyword">open</a> <a id="569" class="Keyword">import</a> <a id="576" href="Prelude.Collections.html" class="Module">Prelude.Collections</a>
<a id="596" class="Keyword">open</a> <a id="601" class="Keyword">import</a> <a id="608" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="624" class="Keyword">open</a> <a id="629" class="Keyword">import</a> <a id="636" href="Prelude.Foldable.html" class="Module">Prelude.Foldable</a>
<a id="653" class="Keyword">open</a> <a id="658" class="Keyword">import</a> <a id="665" href="Prelude.Traversable.html" class="Module">Prelude.Traversable</a>
<a id="685" class="Keyword">open</a> <a id="690" class="Keyword">import</a> <a id="697" href="Prelude.Monad.html" class="Module">Prelude.Monad</a>
<a id="711" class="Keyword">open</a> <a id="716" class="Keyword">import</a> <a id="723" href="Prelude.Validity.html" class="Module">Prelude.Validity</a>
<a id="740" class="Keyword">open</a> <a id="745" class="Keyword">import</a> <a id="752" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>

<a id="771" class="Keyword">open</a> <a id="776" class="Keyword">import</a> <a id="783" href="BitML.BasicTypes.html" class="Module">BitML.BasicTypes</a>
<a id="800" class="Keyword">open</a> <a id="805" class="Keyword">import</a> <a id="812" href="BitML.Predicate.html" class="Module">BitML.Predicate</a> <a id="828" class="Keyword">hiding</a> <a id="835" class="Symbol">(</a><a id="836" href="BitML.Predicate.html#531" class="InductiveConstructor Operator">∣_∣</a><a id="839" class="Symbol">)</a>

<a id="842" class="Keyword">module</a> <a id="849" href="BitML.Contracts.Validity.html" class="Module">BitML.Contracts.Validity</a>
  <a id="876" class="Symbol">(</a><a id="877" href="BitML.Contracts.Validity.html#877" class="Bound">Participant</a> <a id="889" class="Symbol">:</a> <a id="891" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="894" class="Symbol">)</a>
  <a id="898" class="Symbol">⦃</a> <a id="900" href="BitML.Contracts.Validity.html#900" class="Bound">_</a> <a id="902" class="Symbol">:</a> <a id="904" href="Prelude.DecEq.Core.html#103" class="Record">DecEq</a> <a id="910" href="BitML.Contracts.Validity.html#877" class="Bound">Participant</a> <a id="922" class="Symbol">⦄</a>
  <a id="926" class="Symbol">(</a><a id="927" href="BitML.Contracts.Validity.html#927" class="Bound">Honest</a> <a id="934" class="Symbol">:</a> <a id="936" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a> <a id="942" href="BitML.Contracts.Validity.html#877" class="Bound">Participant</a><a id="953" class="Symbol">)</a>
  <a id="957" class="Keyword">where</a>

<a id="964" class="Keyword">open</a> <a id="969" class="Keyword">import</a> <a id="976" href="BitML.Contracts.Types.html" class="Module">BitML.Contracts.Types</a> <a id="998" href="BitML.Contracts.Validity.html#877" class="Bound">Participant</a> <a id="1010" href="BitML.Contracts.Validity.html#927" class="Bound">Honest</a> <a id="1017" class="Keyword">hiding</a> <a id="1024" class="Symbol">(</a><a id="1025" href="BitML.Contracts.Types.html#517" class="Generalizable">B</a><a id="1026" class="Symbol">)</a>
<a id="1028" class="Keyword">open</a> <a id="1033" class="Keyword">import</a> <a id="1040" href="BitML.Contracts.Helpers.html" class="Module">BitML.Contracts.Helpers</a> <a id="1064" href="BitML.Contracts.Validity.html#877" class="Bound">Participant</a> <a id="1076" href="BitML.Contracts.Validity.html#927" class="Bound">Honest</a>

<a id="splitsOK"></a><a id="1084" href="BitML.Contracts.Validity.html#1084" class="Function">splitsOK</a> <a id="1093" class="Symbol">:</a> <a id="1095" href="BitML.Contracts.Types.html#1823" class="Datatype">Precondition</a> <a id="1108" class="Symbol">→</a> <a id="1110" href="BitML.Contracts.Types.html#647" class="Function">Contracts</a> <a id="1120" class="Symbol">→</a> <a id="1122" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1127" href="BitML.Contracts.Validity.html#1084" class="Function">splitsOK</a> <a id="1136" href="BitML.Contracts.Validity.html#1136" class="Bound">G</a> <a id="1138" href="BitML.Contracts.Validity.html#1138" class="Bound">C₀</a> <a id="1141" class="Symbol">=</a> <a id="1143" href="BitML.Contracts.Validity.html#1223" class="Function">goᶜˢ</a> <a id="1148" href="BitML.Contracts.Validity.html#1138" class="Bound">C₀</a> <a id="1151" class="Symbol">(</a><a id="1152" href="BitML.Contracts.Helpers.html#8780" class="Function">persistentValue</a> <a id="1168" href="BitML.Contracts.Validity.html#1136" class="Bound">G</a><a id="1169" class="Symbol">)</a>
  <a id="1173" class="Keyword">where</a>
    <a id="1183" href="BitML.Contracts.Validity.html#1183" class="Function">goᶜ</a> <a id="1187" class="Symbol">:</a> <a id="1189" class="Symbol">(</a><a id="1190" href="BitML.Contracts.Validity.html#1190" class="Bound">C</a> <a id="1192" class="Symbol">:</a> <a id="1194" href="BitML.Contracts.Types.html#632" class="Datatype">Contract</a><a id="1202" class="Symbol">)</a> <a id="1204" class="Symbol">→</a> <a id="1206" href="BitML.BasicTypes.html#229" class="Function">Value</a> <a id="1212" class="Symbol">→</a> <a id="1214" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="1223" href="BitML.Contracts.Validity.html#1223" class="Function">goᶜˢ</a> <a id="1228" class="Symbol">:</a> <a id="1230" class="Symbol">(</a><a id="1231" href="BitML.Contracts.Validity.html#1231" class="Bound">C</a> <a id="1233" class="Symbol">:</a> <a id="1235" href="BitML.Contracts.Types.html#647" class="Function">Contracts</a><a id="1244" class="Symbol">)</a> <a id="1246" class="Symbol">→</a> <a id="1248" href="BitML.BasicTypes.html#229" class="Function">Value</a> <a id="1254" class="Symbol">→</a> <a id="1256" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="1265" href="BitML.Contracts.Validity.html#1265" class="Function">goᵛᶜˢ</a> <a id="1271" class="Symbol">:</a> <a id="1273" class="Symbol">(</a><a id="1274" href="BitML.Contracts.Validity.html#1274" class="Bound">C</a> <a id="1276" class="Symbol">:</a> <a id="1278" href="BitML.Contracts.Types.html#673" class="Function">VContracts</a><a id="1288" class="Symbol">)</a> <a id="1290" class="Symbol">→</a> <a id="1292" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>

    <a id="1302" href="BitML.Contracts.Validity.html#1265" class="Function">goᵛᶜˢ</a> <a id="1308" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1311" class="Symbol">=</a> <a id="1313" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
    <a id="1322" href="BitML.Contracts.Validity.html#1265" class="Function">goᵛᶜˢ</a> <a id="1328" class="Symbol">((</a><a id="1330" href="BitML.Contracts.Validity.html#1330" class="Bound">v</a> <a id="1332" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1334" href="BitML.Contracts.Validity.html#1334" class="Bound">cs</a><a id="1336" class="Symbol">)</a> <a id="1338" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1340" href="BitML.Contracts.Validity.html#1340" class="Bound">vcs</a><a id="1343" class="Symbol">)</a> <a id="1345" class="Symbol">=</a> <a id="1347" href="BitML.Contracts.Validity.html#1223" class="Function">goᶜˢ</a> <a id="1352" href="BitML.Contracts.Validity.html#1334" class="Bound">cs</a> <a id="1355" href="BitML.Contracts.Validity.html#1330" class="Bound">v</a>

    <a id="1362" href="BitML.Contracts.Validity.html#1223" class="Function">goᶜˢ</a> <a id="1367" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1370" class="Symbol">_</a> <a id="1372" class="Symbol">=</a> <a id="1374" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
    <a id="1383" href="BitML.Contracts.Validity.html#1223" class="Function">goᶜˢ</a> <a id="1388" class="Symbol">(</a><a id="1389" href="BitML.Contracts.Validity.html#1389" class="Bound">c</a> <a id="1391" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1393" href="BitML.Contracts.Validity.html#1393" class="Bound">cs</a><a id="1395" class="Symbol">)</a> <a id="1397" href="BitML.Contracts.Validity.html#1397" class="Bound">v</a> <a id="1399" class="Symbol">=</a> <a id="1401" href="BitML.Contracts.Validity.html#1183" class="Function">goᶜ</a> <a id="1405" href="BitML.Contracts.Validity.html#1389" class="Bound">c</a> <a id="1407" href="BitML.Contracts.Validity.html#1397" class="Bound">v</a> <a id="1409" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="1411" href="BitML.Contracts.Validity.html#1223" class="Function">goᶜˢ</a> <a id="1416" href="BitML.Contracts.Validity.html#1393" class="Bound">cs</a> <a id="1419" href="BitML.Contracts.Validity.html#1397" class="Bound">v</a>

    <a id="1426" href="BitML.Contracts.Validity.html#1183" class="Function">goᶜ</a> <a id="1430" href="BitML.Contracts.Validity.html#1430" class="Bound">c₀</a><a id="1432" class="Symbol">@(</a><a id="1434" href="BitML.Contracts.Types.html#769" class="InductiveConstructor Operator">put</a> <a id="1438" href="BitML.Contracts.Validity.html#1438" class="Bound">xs</a> <a id="1441" href="BitML.Contracts.Types.html#769" class="InductiveConstructor Operator">&amp;reveal</a> <a id="1449" href="BitML.Contracts.Validity.html#1449" class="Bound">as</a> <a id="1452" href="BitML.Contracts.Types.html#769" class="InductiveConstructor Operator">if</a> <a id="1455" href="BitML.Contracts.Validity.html#1455" class="Bound">p</a> <a id="1457" href="BitML.Contracts.Types.html#769" class="InductiveConstructor Operator">⇒</a> <a id="1459" href="BitML.Contracts.Validity.html#1459" class="Bound">c</a><a id="1460" class="Symbol">)</a> <a id="1462" href="BitML.Contracts.Validity.html#1462" class="Bound">v</a>
      <a id="1470" class="Keyword">with</a> <a id="1475" href="Prelude.Traversable.html#593" class="Field">sequenceM</a> <a id="1485" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1487" href="Data.List.Base.html#1544" class="Function">map</a> <a id="1491" class="Symbol">(λ</a> <a id="1494" href="BitML.Contracts.Validity.html#1494" class="Bound">x</a> <a id="1496" class="Symbol">→</a> <a id="1498" href="BitML.Contracts.Helpers.html#12503" class="Function">checkDeposit</a> <a id="1511" href="BitML.Contracts.Types.html#2920" class="InductiveConstructor">volatile</a> <a id="1520" href="BitML.Contracts.Validity.html#1494" class="Bound">x</a> <a id="1522" href="BitML.Contracts.Validity.html#1136" class="Bound">G</a><a id="1523" class="Symbol">)</a> <a id="1525" href="BitML.Contracts.Validity.html#1438" class="Bound">xs</a>
    <a id="1532" class="Symbol">...</a> <a id="1536" class="Symbol">|</a> <a id="1538" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="1546" class="Symbol">=</a> <a id="1548" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
    <a id="1558" class="Symbol">...</a> <a id="1562" class="Symbol">|</a> <a id="1564" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1569" href="BitML.Contracts.Validity.html#1569" class="Bound">vs</a> <a id="1572" class="Symbol">=</a> <a id="1574" href="BitML.Contracts.Validity.html#1223" class="Function">goᶜˢ</a> <a id="1579" class="Bound">c</a> <a id="1581" class="Symbol">(</a><a id="1582" href="Prelude.Lists.html#27568" class="Function">∑ℕ</a> <a id="1585" href="BitML.Contracts.Validity.html#1569" class="Bound">vs</a><a id="1587" class="Symbol">)</a>
    <a id="1593" href="BitML.Contracts.Validity.html#1183" class="Function">goᶜ</a> <a id="1597" class="Symbol">(</a><a id="1598" href="BitML.Contracts.Types.html#1022" class="InductiveConstructor">split</a> <a id="1604" href="BitML.Contracts.Validity.html#1604" class="Bound">vcs</a><a id="1607" class="Symbol">)</a>   <a id="1611" href="BitML.Contracts.Validity.html#1611" class="Bound">v</a> <a id="1613" class="Symbol">=</a> <a id="1615" class="Symbol">(</a><a id="1616" href="Prelude.Lists.html#27629" class="Function">∑₁</a> <a id="1619" href="BitML.Contracts.Validity.html#1604" class="Bound">vcs</a> <a id="1623" href="Prelude.DecEq.Core.html#179" class="Function Operator">==</a> <a id="1626" href="BitML.Contracts.Validity.html#1611" class="Bound">v</a><a id="1627" class="Symbol">)</a> <a id="1629" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="1631" href="BitML.Contracts.Validity.html#1265" class="Function">goᵛᶜˢ</a> <a id="1637" href="BitML.Contracts.Validity.html#1604" class="Bound">vcs</a>
    <a id="1645" href="BitML.Contracts.Validity.html#1183" class="Function">goᶜ</a> <a id="1649" class="Symbol">(</a><a id="1650" href="BitML.Contracts.Types.html#1170" class="InductiveConstructor Operator">after</a> <a id="1656" class="Symbol">_</a> <a id="1658" href="BitML.Contracts.Types.html#1170" class="InductiveConstructor Operator">⇒</a> <a id="1660" href="BitML.Contracts.Validity.html#1660" class="Bound">c</a><a id="1661" class="Symbol">)</a> <a id="1663" href="BitML.Contracts.Validity.html#1663" class="Bound">v</a> <a id="1665" class="Symbol">=</a> <a id="1667" href="BitML.Contracts.Validity.html#1183" class="Function">goᶜ</a> <a id="1671" href="BitML.Contracts.Validity.html#1660" class="Bound">c</a> <a id="1673" href="BitML.Contracts.Validity.html#1663" class="Bound">v</a>
    <a id="1679" href="BitML.Contracts.Validity.html#1183" class="Function">goᶜ</a> <a id="1683" class="Symbol">(_</a> <a id="1686" href="BitML.Contracts.Types.html#1097" class="InductiveConstructor Operator">⇒</a> <a id="1688" href="BitML.Contracts.Validity.html#1688" class="Bound">c</a><a id="1689" class="Symbol">)</a>       <a id="1697" href="BitML.Contracts.Validity.html#1697" class="Bound">v</a> <a id="1699" class="Symbol">=</a> <a id="1701" href="BitML.Contracts.Validity.html#1183" class="Function">goᶜ</a> <a id="1705" href="BitML.Contracts.Validity.html#1688" class="Bound">c</a> <a id="1707" href="BitML.Contracts.Validity.html#1697" class="Bound">v</a>
    <a id="1713" href="BitML.Contracts.Validity.html#1183" class="Function">goᶜ</a> <a id="1717" class="Symbol">(</a><a id="1718" href="BitML.Contracts.Types.html#884" class="InductiveConstructor">withdraw</a> <a id="1727" class="Symbol">_)</a>  <a id="1731" class="Symbol">_</a> <a id="1733" class="Symbol">=</a> <a id="1735" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>

<a id="1741" class="Keyword">record</a> <a id="ValidAdvertisement"></a><a id="1748" href="BitML.Contracts.Validity.html#1748" class="Record">ValidAdvertisement</a> <a id="1767" class="Symbol">(</a><a id="1768" href="BitML.Contracts.Validity.html#1768" class="Bound">ad</a> <a id="1771" class="Symbol">:</a> <a id="1773" href="BitML.Contracts.Types.html#2400" class="Record">Advertisement</a><a id="1786" class="Symbol">)</a> <a id="1788" class="Symbol">:</a> <a id="1790" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1794" class="Keyword">where</a>
  <a id="1802" class="Comment">-- open Advertisement ad renaming (C to c; G to g) -- ⟨ G ⟩ C = ad</a>
  <a id="1871" class="Keyword">field</a>
    <a id="1881" class="Comment">-- (i) names in G are distinct</a>
    <a id="ValidAdvertisement.names-uniq"></a><a id="1916" href="BitML.Contracts.Validity.html#1916" class="Field">names-uniq</a> <a id="1927" class="Symbol">:</a> <a id="1929" href="Data.List.Relation.Unary.Unique.Setoid.html#719" class="Datatype">Unique</a> <a id="1936" class="Symbol">(</a><a id="1937" href="BitML.Contracts.Helpers.html#3710" class="Function">names</a> <a id="1943" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1945" href="BitML.Contracts.Types.html#2457" class="Field">G</a> <a id="1947" href="BitML.Contracts.Validity.html#1768" class="Bound">ad</a><a id="1949" class="Symbol">)</a>

    <a id="1956" class="Comment">-- (ii) each name in C appears in G</a>
    <a id="ValidAdvertisement.names-⊆"></a><a id="1996" href="BitML.Contracts.Validity.html#1996" class="Field">names-⊆</a> <a id="2004" class="Symbol">:</a> <a id="2006" href="BitML.Contracts.Helpers.html#3710" class="Function">names</a> <a id="2012" class="Symbol">(</a><a id="2013" href="BitML.Contracts.Types.html#2478" class="Field">C</a> <a id="2015" href="BitML.Contracts.Validity.html#1768" class="Bound">ad</a><a id="2017" class="Symbol">)</a> <a id="2019" href="Data.List.Relation.Binary.Subset.Setoid.html#739" class="Function Operator">⊆</a> <a id="2021" href="BitML.Contracts.Helpers.html#3710" class="Function">names</a> <a id="2027" class="Symbol">(</a><a id="2028" href="BitML.Contracts.Types.html#2457" class="Field">G</a> <a id="2030" href="BitML.Contracts.Validity.html#1768" class="Bound">ad</a><a id="2032" class="Symbol">)</a>

    <a id="2039" class="Comment">-- (iii) the names in put_&amp;reveal_ are distinct and secrets in `if ...` appear in `reveal ...`</a>
    <a id="ValidAdvertisement.names-put"></a><a id="2138" href="BitML.Contracts.Validity.html#2138" class="Field">names-put</a> <a id="2148" class="Symbol">:</a> <a id="2150" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="2154" class="Symbol">(λ{</a> <a id="2158" class="Symbol">(</a><a id="2159" href="BitML.Contracts.Validity.html#2159" class="Bound">xs</a> <a id="2162" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2164" href="BitML.Contracts.Validity.html#2164" class="Bound">as</a> <a id="2167" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2169" href="BitML.Contracts.Validity.html#2169" class="Bound">p</a><a id="2170" class="Symbol">)</a> <a id="2172" class="Symbol">→</a> <a id="2174" href="Data.List.Relation.Unary.Unique.Setoid.html#719" class="Datatype">Unique</a> <a id="2181" href="BitML.Contracts.Validity.html#2159" class="Bound">xs</a> <a id="2184" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2186" class="Symbol">(</a><a id="2187" href="BitML.Contracts.Helpers.html#4909" class="Function">secrets</a> <a id="2195" href="BitML.Contracts.Validity.html#2169" class="Bound">p</a> <a id="2197" href="Data.List.Relation.Binary.Subset.Setoid.html#739" class="Function Operator">⊆</a> <a id="2199" href="BitML.Contracts.Validity.html#2164" class="Bound">as</a><a id="2201" class="Symbol">)})</a> <a id="2205" class="Symbol">(</a><a id="2206" href="BitML.Contracts.Helpers.html#5714" class="Function">putComponents</a> <a id="2220" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="2222" href="BitML.Contracts.Types.html#2478" class="Field">C</a> <a id="2224" href="BitML.Contracts.Validity.html#1768" class="Bound">ad</a><a id="2226" class="Symbol">)</a>

    <a id="2233" class="Comment">-- (iv) each participant has a persistent deposit in G</a>
    <a id="ValidAdvertisement.participants-⊆"></a><a id="2292" href="BitML.Contracts.Validity.html#2292" class="Field">participants-⊆</a> <a id="2307" class="Symbol">:</a> <a id="2309" href="BitML.Contracts.Helpers.html#2598" class="Function">participants</a> <a id="2322" class="Symbol">(</a><a id="2323" href="BitML.Contracts.Types.html#2457" class="Field">G</a> <a id="2325" href="BitML.Contracts.Validity.html#1768" class="Bound">ad</a><a id="2327" class="Symbol">)</a> <a id="2329" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="2332" href="BitML.Contracts.Helpers.html#2598" class="Function">participants</a> <a id="2345" class="Symbol">(</a><a id="2346" href="BitML.Contracts.Types.html#2478" class="Field">C</a> <a id="2348" href="BitML.Contracts.Validity.html#1768" class="Bound">ad</a><a id="2350" class="Symbol">)</a> <a id="2352" href="Data.List.Relation.Binary.Subset.Setoid.html#739" class="Function Operator">⊆</a> <a id="2354" href="BitML.Contracts.Helpers.html#8905" class="Function">persistentParticipants</a> <a id="2377" class="Symbol">(</a><a id="2378" href="BitML.Contracts.Types.html#2457" class="Field">G</a> <a id="2380" href="BitML.Contracts.Validity.html#1768" class="Bound">ad</a><a id="2382" class="Symbol">)</a>

    <a id="2389" class="Comment">-- (extra) split commands are valid</a>
    <a id="ValidAdvertisement.splits-OK"></a><a id="2429" href="BitML.Contracts.Validity.html#2429" class="Field">splits-OK</a> <a id="2439" class="Symbol">:</a> <a id="2441" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="2443" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="2445" href="BitML.Contracts.Validity.html#1084" class="Function">splitsOK</a> <a id="2454" class="Symbol">(</a><a id="2455" href="BitML.Contracts.Types.html#2457" class="Field">G</a> <a id="2457" href="BitML.Contracts.Validity.html#1768" class="Bound">ad</a><a id="2459" class="Symbol">)</a> <a id="2461" class="Symbol">(</a><a id="2462" href="BitML.Contracts.Types.html#2478" class="Field">C</a> <a id="2464" href="BitML.Contracts.Validity.html#1768" class="Bound">ad</a><a id="2466" class="Symbol">)</a>

<a id="2469" class="Keyword">open</a> <a id="2474" href="BitML.Contracts.Validity.html#1748" class="Module">ValidAdvertisement</a> <a id="2493" class="Keyword">public</a>

<a id="2501" class="Keyword">instance</a>
  <a id="𝕍Ad"></a><a id="2512" href="BitML.Contracts.Validity.html#2512" class="Function">𝕍Ad</a> <a id="2516" class="Symbol">:</a> <a id="2518" href="Prelude.Validity.html#245" class="Record">Validable</a> <a id="2528" href="BitML.Contracts.Types.html#2400" class="Record">Advertisement</a>
  <a id="2544" href="BitML.Contracts.Validity.html#2512" class="Function">𝕍Ad</a> <a id="2548" class="Symbol">.</a><a id="2549" href="Prelude.Validity.html#302" class="Field">Valid</a> <a id="2555" class="Symbol">=</a> <a id="2557" href="BitML.Contracts.Validity.html#1748" class="Record">ValidAdvertisement</a>

  <a id="Dec-𝕍Ad"></a><a id="2579" href="BitML.Contracts.Validity.html#2579" class="Function">Dec-𝕍Ad</a> <a id="2587" class="Symbol">:</a> <a id="2589" href="Prelude.Validity.html#302" class="Field">Valid</a> <a id="2595" href="Prelude.Decidable.html#504" class="Function Operator">⁇¹</a>
  <a id="2600" href="BitML.Contracts.Validity.html#2579" class="Function">Dec-𝕍Ad</a> <a id="2608" class="Symbol">{</a><a id="2609" class="Argument">x</a> <a id="2611" class="Symbol">=</a> <a id="2613" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟨</a> <a id="2615" href="BitML.Contracts.Validity.html#2615" class="Bound">G</a> <a id="2617" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟩</a> <a id="2619" href="BitML.Contracts.Validity.html#2619" class="Bound">C</a><a id="2620" class="Symbol">}</a> <a id="2622" class="Symbol">.</a><a id="2623" href="Prelude.Decidable.html#200" class="Field">dec</a>
    <a id="2631" class="Keyword">with</a> <a id="2636" href="Prelude.DecLists.html#1150" class="Function">unique?</a> <a id="2644" class="Symbol">(</a><a id="2645" href="BitML.Contracts.Helpers.html#3710" class="Function">names</a> <a id="2651" href="BitML.Contracts.Validity.html#2615" class="Bound">G</a><a id="2652" class="Symbol">)</a>
       <a id="2661" class="Symbol">|</a> <a id="2663" href="BitML.Contracts.Helpers.html#3710" class="Function">names</a> <a id="2669" href="BitML.Contracts.Validity.html#2619" class="Bound">C</a> <a id="2671" href="Prelude.DecLists.html#253" class="Function Operator">⊆?</a> <a id="2674" href="BitML.Contracts.Helpers.html#3710" class="Function">names</a> <a id="2680" href="BitML.Contracts.Validity.html#2615" class="Bound">G</a>
       <a id="2689" class="Symbol">|</a> <a id="2691" href="Data.List.Relation.Unary.All.html#6240" class="Function">all?</a> <a id="2696" class="Symbol">(λ{</a> <a id="2700" class="Symbol">(</a><a id="2701" href="BitML.Contracts.Validity.html#2701" class="Bound">xs</a> <a id="2704" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2706" href="BitML.Contracts.Validity.html#2706" class="Bound">as</a> <a id="2709" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2711" href="BitML.Contracts.Validity.html#2711" class="Bound">p</a><a id="2712" class="Symbol">)</a> <a id="2714" class="Symbol">→</a> <a id="2716" href="Prelude.DecLists.html#1150" class="Function">unique?</a> <a id="2724" href="BitML.Contracts.Validity.html#2701" class="Bound">xs</a> <a id="2727" href="Relation.Nullary.Product.html#921" class="Function Operator">×-dec</a> <a id="2733" class="Symbol">(</a><a id="2734" href="BitML.Contracts.Helpers.html#4909" class="Function">secrets</a> <a id="2742" href="BitML.Contracts.Validity.html#2711" class="Bound">p</a> <a id="2744" href="Prelude.DecLists.html#253" class="Function Operator">⊆?</a> <a id="2747" href="BitML.Contracts.Validity.html#2706" class="Bound">as</a><a id="2749" class="Symbol">)})</a> <a id="2753" class="Symbol">(</a><a id="2754" href="BitML.Contracts.Helpers.html#5714" class="Function">putComponents</a> <a id="2768" href="BitML.Contracts.Validity.html#2619" class="Bound">C</a><a id="2769" class="Symbol">)</a>
       <a id="2778" class="Symbol">|</a> <a id="2780" href="BitML.Contracts.Helpers.html#2598" class="Function">participants</a> <a id="2793" href="BitML.Contracts.Validity.html#2615" class="Bound">G</a> <a id="2795" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="2798" href="BitML.Contracts.Helpers.html#2598" class="Function">participants</a> <a id="2811" href="BitML.Contracts.Validity.html#2619" class="Bound">C</a> <a id="2813" href="Prelude.DecLists.html#253" class="Function Operator">⊆?</a> <a id="2816" href="BitML.Contracts.Helpers.html#8905" class="Function">persistentParticipants</a> <a id="2839" href="BitML.Contracts.Validity.html#2615" class="Bound">G</a>
       <a id="2848" class="Symbol">|</a> <a id="2850" href="Data.Bool.Properties.html#15470" class="Function">T?</a> <a id="2853" class="Symbol">(</a><a id="2854" href="BitML.Contracts.Validity.html#1084" class="Function">splitsOK</a> <a id="2863" href="BitML.Contracts.Validity.html#2615" class="Bound">G</a> <a id="2865" href="BitML.Contracts.Validity.html#2619" class="Bound">C</a><a id="2866" class="Symbol">)</a>
  <a id="2870" class="Symbol">...</a> <a id="2874" class="Symbol">|</a> <a id="2876" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2879" href="BitML.Contracts.Validity.html#2879" class="Bound">¬names-uniq</a> <a id="2891" class="Symbol">|</a> <a id="2893" class="Symbol">_</a> <a id="2895" class="Symbol">|</a> <a id="2897" class="Symbol">_</a> <a id="2899" class="Symbol">|</a> <a id="2901" class="Symbol">_</a> <a id="2903" class="Symbol">|</a> <a id="2905" class="Symbol">_</a>     <a id="2911" class="Symbol">=</a> <a id="2913" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2916" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="2918" href="BitML.Contracts.Validity.html#2879" class="Bound">¬names-uniq</a> <a id="2930" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2932" href="BitML.Contracts.Validity.html#1916" class="Field">names-uniq</a>
  <a id="2945" class="CatchallClause Symbol">...</a><a id="2948" class="CatchallClause"> </a><a id="2949" class="CatchallClause Symbol">|</a><a id="2950" class="CatchallClause"> </a><a id="2951" class="CatchallClause Symbol">_</a><a id="2952" class="CatchallClause"> </a><a id="2953" class="CatchallClause Symbol">|</a><a id="2954" class="CatchallClause"> </a><a id="2955" href="Relation.Nullary.html#1685" class="CatchallClause InductiveConstructor">no</a><a id="2957" class="CatchallClause"> </a><a id="2958" href="BitML.Contracts.Validity.html#2958" class="CatchallClause Bound">¬names-⊆</a><a id="2966" class="CatchallClause"> </a><a id="2967" class="CatchallClause Symbol">|</a><a id="2968" class="CatchallClause"> </a><a id="2969" class="CatchallClause Symbol">_</a><a id="2970" class="CatchallClause"> </a><a id="2971" class="CatchallClause Symbol">|</a><a id="2972" class="CatchallClause"> </a><a id="2973" class="CatchallClause Symbol">_</a><a id="2974" class="CatchallClause"> </a><a id="2975" class="CatchallClause Symbol">|</a><a id="2976" class="CatchallClause"> </a><a id="2977" class="CatchallClause Symbol">_</a>        <a id="2986" class="Symbol">=</a> <a id="2988" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2991" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="2993" href="BitML.Contracts.Validity.html#2958" class="Bound">¬names-⊆</a> <a id="3002" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3004" href="BitML.Contracts.Validity.html#1996" class="Field">names-⊆</a>
  <a id="3014" class="CatchallClause Symbol">...</a><a id="3017" class="CatchallClause"> </a><a id="3018" class="CatchallClause Symbol">|</a><a id="3019" class="CatchallClause"> </a><a id="3020" class="CatchallClause Symbol">_</a><a id="3021" class="CatchallClause"> </a><a id="3022" class="CatchallClause Symbol">|</a><a id="3023" class="CatchallClause"> </a><a id="3024" class="CatchallClause Symbol">_</a><a id="3025" class="CatchallClause"> </a><a id="3026" class="CatchallClause Symbol">|</a><a id="3027" class="CatchallClause"> </a><a id="3028" href="Relation.Nullary.html#1685" class="CatchallClause InductiveConstructor">no</a><a id="3030" class="CatchallClause"> </a><a id="3031" href="BitML.Contracts.Validity.html#3031" class="CatchallClause Bound">¬names-put</a><a id="3041" class="CatchallClause"> </a><a id="3042" class="CatchallClause Symbol">|</a><a id="3043" class="CatchallClause"> </a><a id="3044" class="CatchallClause Symbol">_</a><a id="3045" class="CatchallClause"> </a><a id="3046" class="CatchallClause Symbol">|</a><a id="3047" class="CatchallClause"> </a><a id="3048" class="CatchallClause Symbol">_</a>      <a id="3055" class="Symbol">=</a> <a id="3057" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3060" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="3062" href="BitML.Contracts.Validity.html#3031" class="Bound">¬names-put</a> <a id="3073" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3075" href="BitML.Contracts.Validity.html#2138" class="Field">names-put</a>
  <a id="3087" class="CatchallClause Symbol">...</a><a id="3090" class="CatchallClause"> </a><a id="3091" class="CatchallClause Symbol">|</a><a id="3092" class="CatchallClause"> </a><a id="3093" class="CatchallClause Symbol">_</a><a id="3094" class="CatchallClause"> </a><a id="3095" class="CatchallClause Symbol">|</a><a id="3096" class="CatchallClause"> </a><a id="3097" class="CatchallClause Symbol">_</a><a id="3098" class="CatchallClause"> </a><a id="3099" class="CatchallClause Symbol">|</a><a id="3100" class="CatchallClause"> </a><a id="3101" class="CatchallClause Symbol">_</a><a id="3102" class="CatchallClause"> </a><a id="3103" class="CatchallClause Symbol">|</a><a id="3104" class="CatchallClause"> </a><a id="3105" href="Relation.Nullary.html#1685" class="CatchallClause InductiveConstructor">no</a><a id="3107" class="CatchallClause"> </a><a id="3108" href="BitML.Contracts.Validity.html#3108" class="CatchallClause Bound">¬participants-⊆</a><a id="3123" class="CatchallClause"> </a><a id="3124" class="CatchallClause Symbol">|</a><a id="3125" class="CatchallClause"> </a><a id="3126" class="CatchallClause Symbol">_</a> <a id="3128" class="Symbol">=</a> <a id="3130" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3133" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="3135" href="BitML.Contracts.Validity.html#3108" class="Bound">¬participants-⊆</a> <a id="3151" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3153" href="BitML.Contracts.Validity.html#2292" class="Field">participants-⊆</a>
  <a id="3170" class="CatchallClause Symbol">...</a><a id="3173" class="CatchallClause"> </a><a id="3174" class="CatchallClause Symbol">|</a><a id="3175" class="CatchallClause"> </a><a id="3176" class="CatchallClause Symbol">_</a><a id="3177" class="CatchallClause"> </a><a id="3178" class="CatchallClause Symbol">|</a><a id="3179" class="CatchallClause"> </a><a id="3180" class="CatchallClause Symbol">_</a><a id="3181" class="CatchallClause"> </a><a id="3182" class="CatchallClause Symbol">|</a><a id="3183" class="CatchallClause"> </a><a id="3184" class="CatchallClause Symbol">_</a><a id="3185" class="CatchallClause"> </a><a id="3186" class="CatchallClause Symbol">|</a><a id="3187" class="CatchallClause"> </a><a id="3188" class="CatchallClause Symbol">_</a><a id="3189" class="CatchallClause"> </a><a id="3190" class="CatchallClause Symbol">|</a><a id="3191" class="CatchallClause"> </a><a id="3192" href="Relation.Nullary.html#1685" class="CatchallClause InductiveConstructor">no</a><a id="3194" class="CatchallClause"> </a><a id="3195" href="BitML.Contracts.Validity.html#3195" class="CatchallClause Bound">¬splits-OK</a>      <a id="3211" class="Symbol">=</a> <a id="3213" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="3216" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="3218" href="BitML.Contracts.Validity.html#3195" class="Bound">¬splits-OK</a> <a id="3229" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3231" href="BitML.Contracts.Validity.html#2429" class="Field">splits-OK</a>
  <a id="3243" class="Symbol">...</a> <a id="3247" class="Symbol">|</a> <a id="3249" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3253" href="BitML.Contracts.Validity.html#3253" class="Bound">p₁</a> <a id="3256" class="Symbol">|</a> <a id="3258" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3262" href="BitML.Contracts.Validity.html#3262" class="Bound">p₂</a> <a id="3265" class="Symbol">|</a> <a id="3267" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3271" href="BitML.Contracts.Validity.html#3271" class="Bound">p₃</a> <a id="3274" class="Symbol">|</a> <a id="3276" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3280" href="BitML.Contracts.Validity.html#3280" class="Bound">p₄</a> <a id="3283" class="Symbol">|</a> <a id="3285" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3289" href="BitML.Contracts.Validity.html#3289" class="Bound">p₅</a> <a id="3292" class="Symbol">=</a> <a id="3294" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3298" class="Symbol">λ</a> <a id="3300" class="Keyword">where</a>
    <a id="3310" class="Symbol">.</a><a id="3311" href="BitML.Contracts.Validity.html#1916" class="Field">names-uniq</a> <a id="3322" class="Symbol">→</a> <a id="3324" href="BitML.Contracts.Validity.html#3253" class="Bound">p₁</a><a id="3326" class="Symbol">;</a> <a id="3328" class="Symbol">.</a><a id="3329" href="BitML.Contracts.Validity.html#1996" class="Field">names-⊆</a> <a id="3337" class="Symbol">→</a> <a id="3339" href="BitML.Contracts.Validity.html#3262" class="Bound">p₂</a><a id="3341" class="Symbol">;</a> <a id="3343" class="Symbol">.</a><a id="3344" href="BitML.Contracts.Validity.html#2138" class="Field">names-put</a> <a id="3354" class="Symbol">→</a> <a id="3356" href="BitML.Contracts.Validity.html#3271" class="Bound">p₃</a><a id="3358" class="Symbol">;</a> <a id="3360" class="Symbol">.</a><a id="3361" href="BitML.Contracts.Validity.html#2292" class="Field">participants-⊆</a> <a id="3376" class="Symbol">→</a> <a id="3378" href="BitML.Contracts.Validity.html#3280" class="Bound">p₄</a><a id="3380" class="Symbol">;</a> <a id="3382" class="Symbol">.</a><a id="3383" href="BitML.Contracts.Validity.html#2429" class="Field">splits-OK</a> <a id="3393" class="Symbol">→</a> <a id="3395" href="BitML.Contracts.Validity.html#3289" class="Bound">p₅</a>
</pre></body></html>