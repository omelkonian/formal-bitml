<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>BitML.Contracts.Validity</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Validity of advertisements.</a>
<a id="105" class="Comment">------------------------------------------------------------------------</a>
<a id="178" class="Keyword">open</a> <a id="183" class="Keyword">import</a> <a id="190" href="Function.html" class="Module">Function</a> <a id="199" class="Keyword">using</a> <a id="205" class="Symbol">(</a><a id="206" href="Function.Base.html#615" class="Function">id</a><a id="208" class="Symbol">)</a>

<a id="211" class="Keyword">open</a> <a id="216" class="Keyword">import</a> <a id="223" href="Data.List.Membership.Propositional.Properties.html" class="Module">Data.List.Membership.Propositional.Properties</a>
<a id="269" class="Keyword">open</a> <a id="274" class="Keyword">import</a> <a id="281" href="Data.List.Relation.Binary.Subset.Propositional.Properties.html" class="Module">Data.List.Relation.Binary.Subset.Propositional.Properties</a>

<a id="340" class="Keyword">open</a> <a id="345" class="Keyword">import</a> <a id="352" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="365" class="Keyword">open</a> <a id="370" class="Keyword">import</a> <a id="377" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="393" class="Keyword">open</a> <a id="398" class="Keyword">import</a> <a id="405" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="419" class="Keyword">open</a> <a id="424" class="Keyword">import</a> <a id="431" href="Prelude.DecLists.html" class="Module">Prelude.DecLists</a>
<a id="448" class="Keyword">open</a> <a id="453" class="Keyword">import</a> <a id="460" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="474" class="Comment">-- open import Prelude.Membership</a>
<a id="508" class="Keyword">open</a> <a id="513" class="Keyword">import</a> <a id="520" href="Prelude.Sets.html" class="Module">Prelude.Sets</a>
<a id="533" class="Keyword">open</a> <a id="538" class="Keyword">import</a> <a id="545" href="Prelude.Measurable.html" class="Module">Prelude.Measurable</a>
<a id="564" class="Keyword">open</a> <a id="569" class="Keyword">import</a> <a id="576" href="Prelude.Collections.html" class="Module">Prelude.Collections</a>
<a id="596" class="Keyword">open</a> <a id="601" class="Keyword">import</a> <a id="608" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="624" class="Keyword">open</a> <a id="629" class="Keyword">import</a> <a id="636" href="Prelude.Foldable.html" class="Module">Prelude.Foldable</a>
<a id="653" class="Keyword">open</a> <a id="658" class="Keyword">import</a> <a id="665" href="Prelude.Traversable.html" class="Module">Prelude.Traversable</a>
<a id="685" class="Keyword">open</a> <a id="690" class="Keyword">import</a> <a id="697" href="Prelude.Monad.html" class="Module">Prelude.Monad</a>

<a id="712" class="Keyword">open</a> <a id="717" class="Keyword">import</a> <a id="724" href="BitML.BasicTypes.html" class="Module">BitML.BasicTypes</a>
<a id="741" class="Keyword">open</a> <a id="746" class="Keyword">import</a> <a id="753" href="BitML.Predicate.html" class="Module">BitML.Predicate</a> <a id="769" class="Keyword">hiding</a> <a id="776" class="Symbol">(</a><a id="777" href="BitML.Predicate.html#531" class="InductiveConstructor Operator">∣_∣</a><a id="780" class="Symbol">)</a>

<a id="783" class="Keyword">module</a> <a id="790" href="BitML.Contracts.Validity.html" class="Module">BitML.Contracts.Validity</a>
  <a id="817" class="Symbol">(</a><a id="818" href="BitML.Contracts.Validity.html#818" class="Bound">Participant</a> <a id="830" class="Symbol">:</a> <a id="832" class="PrimitiveType">Set</a><a id="835" class="Symbol">)</a>
  <a id="839" class="Symbol">⦃</a> <a id="841" href="BitML.Contracts.Validity.html#841" class="Bound">_</a> <a id="843" class="Symbol">:</a> <a id="845" href="Prelude.DecEq.html#581" class="Record">DecEq</a> <a id="851" href="BitML.Contracts.Validity.html#818" class="Bound">Participant</a> <a id="863" class="Symbol">⦄</a>
  <a id="867" class="Symbol">(</a><a id="868" href="BitML.Contracts.Validity.html#868" class="Bound">Honest</a> <a id="875" class="Symbol">:</a> <a id="877" href="Data.List.NonEmpty.html#1318" class="Record">List⁺</a> <a id="883" href="BitML.Contracts.Validity.html#818" class="Bound">Participant</a><a id="894" class="Symbol">)</a>
  <a id="898" class="Keyword">where</a>

<a id="905" class="Keyword">open</a> <a id="910" class="Keyword">import</a> <a id="917" href="BitML.Contracts.Types.html" class="Module">BitML.Contracts.Types</a> <a id="939" href="BitML.Contracts.Validity.html#818" class="Bound">Participant</a> <a id="951" href="BitML.Contracts.Validity.html#868" class="Bound">Honest</a> <a id="958" class="Keyword">hiding</a> <a id="965" class="Symbol">(</a>B<a id="967" class="Symbol">)</a>
<a id="969" class="Keyword">open</a> <a id="974" class="Keyword">import</a> <a id="981" href="BitML.Contracts.Helpers.html" class="Module">BitML.Contracts.Helpers</a> <a id="1005" href="BitML.Contracts.Validity.html#818" class="Bound">Participant</a> <a id="1017" href="BitML.Contracts.Validity.html#868" class="Bound">Honest</a>

<a id="splitsOK"></a><a id="1025" href="BitML.Contracts.Validity.html#1025" class="Function">splitsOK</a> <a id="1034" class="Symbol">:</a> <a id="1036" class="Symbol">(</a><a id="1037" href="BitML.Contracts.Validity.html#1037" class="Bound">G</a> <a id="1039" class="Symbol">:</a> <a id="1041" href="BitML.Contracts.Types.html#1825" class="Datatype">Precondition</a><a id="1053" class="Symbol">)</a> <a id="1055" class="Symbol">(</a><a id="1056" href="BitML.Contracts.Validity.html#1056" class="Bound">C</a> <a id="1058" class="Symbol">:</a> <a id="1060" href="BitML.Contracts.Types.html#649" class="Function">Contracts</a><a id="1069" class="Symbol">)</a> <a id="1071" class="Symbol">→</a> <a id="1073" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1078" href="BitML.Contracts.Validity.html#1025" class="Function">splitsOK</a> <a id="1087" href="BitML.Contracts.Validity.html#1087" class="Bound">G</a> <a id="1089" href="BitML.Contracts.Validity.html#1089" class="Bound">C₀</a> <a id="1092" class="Symbol">=</a> <a id="1094" href="BitML.Contracts.Validity.html#1174" class="Function">goᶜˢ</a> <a id="1099" href="BitML.Contracts.Validity.html#1089" class="Bound">C₀</a> <a id="1102" class="Symbol">(</a><a id="1103" href="BitML.Contracts.Helpers.html#7683" class="Function">persistentValue</a> <a id="1119" href="BitML.Contracts.Validity.html#1087" class="Bound">G</a><a id="1120" class="Symbol">)</a>
  <a id="1124" class="Keyword">where</a>
    <a id="1134" href="BitML.Contracts.Validity.html#1134" class="Function">goᶜ</a> <a id="1138" class="Symbol">:</a> <a id="1140" class="Symbol">(</a><a id="1141" href="BitML.Contracts.Validity.html#1141" class="Bound">C</a> <a id="1143" class="Symbol">:</a> <a id="1145" href="BitML.Contracts.Types.html#634" class="Datatype">Contract</a><a id="1153" class="Symbol">)</a> <a id="1155" class="Symbol">→</a> <a id="1157" href="BitML.BasicTypes.html#229" class="Function">Value</a> <a id="1163" class="Symbol">→</a> <a id="1165" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="1174" href="BitML.Contracts.Validity.html#1174" class="Function">goᶜˢ</a> <a id="1179" class="Symbol">:</a> <a id="1181" class="Symbol">(</a><a id="1182" href="BitML.Contracts.Validity.html#1182" class="Bound">C</a> <a id="1184" class="Symbol">:</a> <a id="1186" href="BitML.Contracts.Types.html#649" class="Function">Contracts</a><a id="1195" class="Symbol">)</a> <a id="1197" class="Symbol">→</a> <a id="1199" href="BitML.BasicTypes.html#229" class="Function">Value</a> <a id="1205" class="Symbol">→</a> <a id="1207" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="1216" href="BitML.Contracts.Validity.html#1216" class="Function">goᵛᶜˢ</a> <a id="1222" class="Symbol">:</a> <a id="1224" class="Symbol">(</a><a id="1225" href="BitML.Contracts.Validity.html#1225" class="Bound">C</a> <a id="1227" class="Symbol">:</a> <a id="1229" href="BitML.Contracts.Types.html#675" class="Function">VContracts</a><a id="1239" class="Symbol">)</a> <a id="1241" class="Symbol">→</a> <a id="1243" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>

    <a id="1253" href="BitML.Contracts.Validity.html#1216" class="Function">goᵛᶜˢ</a> <a id="1259" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1262" class="Symbol">=</a> <a id="1264" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
    <a id="1273" href="BitML.Contracts.Validity.html#1216" class="Function">goᵛᶜˢ</a> <a id="1279" class="Symbol">((</a><a id="1281" href="BitML.Contracts.Validity.html#1281" class="Bound">v</a> <a id="1283" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1285" href="BitML.Contracts.Validity.html#1285" class="Bound">cs</a><a id="1287" class="Symbol">)</a> <a id="1289" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1291" href="BitML.Contracts.Validity.html#1291" class="Bound">vcs</a><a id="1294" class="Symbol">)</a> <a id="1296" class="Symbol">=</a> <a id="1298" href="BitML.Contracts.Validity.html#1174" class="Function">goᶜˢ</a> <a id="1303" href="BitML.Contracts.Validity.html#1285" class="Bound">cs</a> <a id="1306" href="BitML.Contracts.Validity.html#1281" class="Bound">v</a>

    <a id="1313" href="BitML.Contracts.Validity.html#1174" class="Function">goᶜˢ</a> <a id="1318" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1321" class="Symbol">_</a> <a id="1323" class="Symbol">=</a> <a id="1325" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
    <a id="1334" href="BitML.Contracts.Validity.html#1174" class="Function">goᶜˢ</a> <a id="1339" class="Symbol">(</a><a id="1340" href="BitML.Contracts.Validity.html#1340" class="Bound">c</a> <a id="1342" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1344" href="BitML.Contracts.Validity.html#1344" class="Bound">cs</a><a id="1346" class="Symbol">)</a> <a id="1348" href="BitML.Contracts.Validity.html#1348" class="Bound">v</a> <a id="1350" class="Symbol">=</a> <a id="1352" href="BitML.Contracts.Validity.html#1134" class="Function">goᶜ</a> <a id="1356" href="BitML.Contracts.Validity.html#1340" class="Bound">c</a> <a id="1358" href="BitML.Contracts.Validity.html#1348" class="Bound">v</a> <a id="1360" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="1362" href="BitML.Contracts.Validity.html#1174" class="Function">goᶜˢ</a> <a id="1367" href="BitML.Contracts.Validity.html#1344" class="Bound">cs</a> <a id="1370" href="BitML.Contracts.Validity.html#1348" class="Bound">v</a>

    <a id="1377" href="BitML.Contracts.Validity.html#1134" class="Function">goᶜ</a> <a id="1381" href="BitML.Contracts.Validity.html#1381" class="Bound">c₀</a><a id="1383" class="Symbol">@(</a><a id="1385" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">put</a> <a id="1389" href="BitML.Contracts.Validity.html#1389" class="Bound">xs</a> <a id="1392" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">&amp;reveal</a> <a id="1400" href="BitML.Contracts.Validity.html#1400" class="Bound">as</a> <a id="1403" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">if</a> <a id="1406" href="BitML.Contracts.Validity.html#1406" class="Bound">p</a> <a id="1408" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">⇒</a> <a id="1410" href="BitML.Contracts.Validity.html#1410" class="Bound">c</a><a id="1411" class="Symbol">)</a> <a id="1413" href="BitML.Contracts.Validity.html#1413" class="Bound">v</a>
      <a id="1421" class="Keyword">with</a> <a id="1426" href="Prelude.Traversable.html#667" class="Field">sequenceM</a> <a id="1436" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="1438" href="Data.List.Base.html#1497" class="Function">map</a> <a id="1442" class="Symbol">(λ</a> <a id="1445" href="BitML.Contracts.Validity.html#1445" class="Bound">x</a> <a id="1447" class="Symbol">→</a> <a id="1449" href="BitML.Contracts.Helpers.html#11406" class="Function">checkDeposit</a> <a id="1462" href="BitML.Contracts.Types.html#2907" class="InductiveConstructor">volatile</a> <a id="1471" href="BitML.Contracts.Validity.html#1445" class="Bound">x</a> <a id="1473" href="BitML.Contracts.Validity.html#1087" class="Bound">G</a><a id="1474" class="Symbol">)</a> <a id="1476" href="BitML.Contracts.Validity.html#1389" class="Bound">xs</a>
    <a id="1483" class="Symbol">...</a> <a id="1487" class="Symbol">|</a> <a id="1489" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a> <a id="1497" class="Symbol">=</a> <a id="1499" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
    <a id="1509" class="Symbol">...</a> <a id="1513" class="Symbol">|</a> <a id="1515" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="1520" href="BitML.Contracts.Validity.html#1520" class="Bound">vs</a> <a id="1523" class="Symbol">=</a> <a id="1525" href="BitML.Contracts.Validity.html#1174" class="Function">goᶜˢ</a> <a id="1530" class="Bound">c</a> <a id="1532" class="Symbol">(</a><a id="1533" href="Prelude.Lists.html#24579" class="Function">∑ℕ</a> <a id="1536" href="BitML.Contracts.Validity.html#1520" class="Bound">vs</a><a id="1538" class="Symbol">)</a>
    <a id="1544" href="BitML.Contracts.Validity.html#1134" class="Function">goᶜ</a> <a id="1548" class="Symbol">(</a><a id="1549" href="BitML.Contracts.Types.html#1024" class="InductiveConstructor">split</a> <a id="1555" href="BitML.Contracts.Validity.html#1555" class="Bound">vcs</a><a id="1558" class="Symbol">)</a>   <a id="1562" href="BitML.Contracts.Validity.html#1562" class="Bound">v</a> <a id="1564" class="Symbol">=</a> <a id="1566" class="Symbol">(</a><a id="1567" href="Prelude.Lists.html#24640" class="Function">∑₁</a> <a id="1570" href="BitML.Contracts.Validity.html#1555" class="Bound">vcs</a> <a id="1574" href="Prelude.DecEq.html#661" class="Function Operator">==</a> <a id="1577" href="BitML.Contracts.Validity.html#1562" class="Bound">v</a><a id="1578" class="Symbol">)</a> <a id="1580" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="1582" href="BitML.Contracts.Validity.html#1216" class="Function">goᵛᶜˢ</a> <a id="1588" href="BitML.Contracts.Validity.html#1555" class="Bound">vcs</a>
    <a id="1596" href="BitML.Contracts.Validity.html#1134" class="Function">goᶜ</a> <a id="1600" class="Symbol">(</a><a id="1601" href="BitML.Contracts.Types.html#1172" class="InductiveConstructor Operator">after</a> <a id="1607" class="Symbol">_</a> <a id="1609" href="BitML.Contracts.Types.html#1172" class="InductiveConstructor Operator">⇒</a> <a id="1611" href="BitML.Contracts.Validity.html#1611" class="Bound">c</a><a id="1612" class="Symbol">)</a> <a id="1614" href="BitML.Contracts.Validity.html#1614" class="Bound">v</a> <a id="1616" class="Symbol">=</a> <a id="1618" href="BitML.Contracts.Validity.html#1134" class="Function">goᶜ</a> <a id="1622" href="BitML.Contracts.Validity.html#1611" class="Bound">c</a> <a id="1624" href="BitML.Contracts.Validity.html#1614" class="Bound">v</a>
    <a id="1630" href="BitML.Contracts.Validity.html#1134" class="Function">goᶜ</a> <a id="1634" class="Symbol">(_</a> <a id="1637" href="BitML.Contracts.Types.html#1099" class="InductiveConstructor Operator">⇒</a> <a id="1639" href="BitML.Contracts.Validity.html#1639" class="Bound">c</a><a id="1640" class="Symbol">)</a>       <a id="1648" href="BitML.Contracts.Validity.html#1648" class="Bound">v</a> <a id="1650" class="Symbol">=</a> <a id="1652" href="BitML.Contracts.Validity.html#1134" class="Function">goᶜ</a> <a id="1656" href="BitML.Contracts.Validity.html#1639" class="Bound">c</a> <a id="1658" href="BitML.Contracts.Validity.html#1648" class="Bound">v</a>
    <a id="1664" href="BitML.Contracts.Validity.html#1134" class="Function">goᶜ</a> <a id="1668" class="Symbol">(</a><a id="1669" href="BitML.Contracts.Types.html#886" class="InductiveConstructor">withdraw</a> <a id="1678" class="Symbol">_)</a>  <a id="1682" class="Symbol">_</a> <a id="1684" class="Symbol">=</a> <a id="1686" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>

<a id="1692" class="Keyword">record</a> <a id="ValidAdvertisement"></a><a id="1699" href="BitML.Contracts.Validity.html#1699" class="Record">ValidAdvertisement</a> <a id="1718" class="Symbol">(</a><a id="1719" href="BitML.Contracts.Validity.html#1719" class="Bound">ad</a> <a id="1722" class="Symbol">:</a> <a id="1724" href="BitML.Contracts.Types.html#2404" class="Record">Advertisement</a><a id="1737" class="Symbol">)</a> <a id="1739" class="Symbol">:</a> <a id="1741" class="PrimitiveType">Set</a> <a id="1745" class="Keyword">where</a>
  <a id="1753" class="Comment">-- open Advertisement ad renaming (C to c; G to g) -- ⟨ G ⟩ C = ad</a>
  <a id="1822" class="Keyword">field</a>
    <a id="1832" class="Comment">-- (i) names in G are distinct</a>
    <a id="ValidAdvertisement.names-uniq"></a><a id="1867" href="BitML.Contracts.Validity.html#1867" class="Field">names-uniq</a> <a id="1878" class="Symbol">:</a> <a id="1880" href="Data.List.Relation.Unary.Unique.Setoid.html#869" class="Datatype">Unique</a> <a id="1887" class="Symbol">(</a><a id="1888" href="BitML.Contracts.Helpers.html#3536" class="Function">names</a> <a id="1894" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="1896" href="BitML.Contracts.Types.html#2461" class="Field">G</a> <a id="1898" href="BitML.Contracts.Validity.html#1719" class="Bound">ad</a><a id="1900" class="Symbol">)</a>

    <a id="1907" class="Comment">-- (ii) each name in C appears in G</a>
    <a id="ValidAdvertisement.names-⊆"></a><a id="1947" href="BitML.Contracts.Validity.html#1947" class="Field">names-⊆</a> <a id="1955" class="Symbol">:</a> <a id="1957" href="BitML.Contracts.Helpers.html#3536" class="Function">names</a> <a id="1963" class="Symbol">(</a><a id="1964" href="BitML.Contracts.Types.html#2482" class="Field">C</a> <a id="1966" href="BitML.Contracts.Validity.html#1719" class="Bound">ad</a><a id="1968" class="Symbol">)</a> <a id="1970" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="1972" href="BitML.Contracts.Helpers.html#3536" class="Function">names</a> <a id="1978" class="Symbol">(</a><a id="1979" href="BitML.Contracts.Types.html#2461" class="Field">G</a> <a id="1981" href="BitML.Contracts.Validity.html#1719" class="Bound">ad</a><a id="1983" class="Symbol">)</a>

    <a id="1990" class="Comment">-- (iii) the names in put_&amp;reveal_ are distinct and secrets in `if ...` appear in `reveal ...`</a>
    <a id="ValidAdvertisement.names-put"></a><a id="2089" href="BitML.Contracts.Validity.html#2089" class="Field">names-put</a> <a id="2099" class="Symbol">:</a> <a id="2101" href="Data.List.Relation.Unary.All.html#1274" class="Datatype">All</a> <a id="2105" class="Symbol">(λ{</a> <a id="2109" class="Symbol">(</a><a id="2110" href="BitML.Contracts.Validity.html#2110" class="Bound">xs</a> <a id="2113" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2115" href="BitML.Contracts.Validity.html#2115" class="Bound">as</a> <a id="2118" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2120" href="BitML.Contracts.Validity.html#2120" class="Bound">p</a><a id="2121" class="Symbol">)</a> <a id="2123" class="Symbol">→</a> <a id="2125" href="Data.List.Relation.Unary.Unique.Setoid.html#869" class="Datatype">Unique</a> <a id="2132" href="BitML.Contracts.Validity.html#2110" class="Bound">xs</a> <a id="2135" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2137" class="Symbol">(</a><a id="2138" href="BitML.Contracts.Helpers.html#4703" class="Function">secrets</a> <a id="2146" href="BitML.Contracts.Validity.html#2120" class="Bound">p</a> <a id="2148" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="2150" href="BitML.Contracts.Validity.html#2115" class="Bound">as</a><a id="2152" class="Symbol">)})</a> <a id="2156" class="Symbol">(</a><a id="2157" href="BitML.Contracts.Helpers.html#5467" class="Function">putComponents</a> <a id="2171" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="2173" href="BitML.Contracts.Types.html#2482" class="Field">C</a> <a id="2175" href="BitML.Contracts.Validity.html#1719" class="Bound">ad</a><a id="2177" class="Symbol">)</a>

    <a id="2184" class="Comment">-- (iv) each participant has a persistent deposit in G</a>
    <a id="ValidAdvertisement.participants-⊆"></a><a id="2243" href="BitML.Contracts.Validity.html#2243" class="Field">participants-⊆</a> <a id="2258" class="Symbol">:</a> <a id="2260" href="BitML.Contracts.Helpers.html#2497" class="Function">participants</a> <a id="2273" class="Symbol">(</a><a id="2274" href="BitML.Contracts.Types.html#2461" class="Field">G</a> <a id="2276" href="BitML.Contracts.Validity.html#1719" class="Bound">ad</a><a id="2278" class="Symbol">)</a> <a id="2280" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="2283" href="BitML.Contracts.Helpers.html#2497" class="Function">participants</a> <a id="2296" class="Symbol">(</a><a id="2297" href="BitML.Contracts.Types.html#2482" class="Field">C</a> <a id="2299" href="BitML.Contracts.Validity.html#1719" class="Bound">ad</a><a id="2301" class="Symbol">)</a> <a id="2303" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="2305" href="BitML.Contracts.Helpers.html#7808" class="Function">persistentParticipants</a> <a id="2328" class="Symbol">(</a><a id="2329" href="BitML.Contracts.Types.html#2461" class="Field">G</a> <a id="2331" href="BitML.Contracts.Validity.html#1719" class="Bound">ad</a><a id="2333" class="Symbol">)</a>

    <a id="2340" class="Comment">-- (extra) split commands are valid</a>
    <a id="ValidAdvertisement.splits-OK"></a><a id="2380" href="BitML.Contracts.Validity.html#2380" class="Field">splits-OK</a> <a id="2390" class="Symbol">:</a> <a id="2392" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="2394" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="2396" href="BitML.Contracts.Validity.html#1025" class="Function">splitsOK</a> <a id="2405" class="Symbol">(</a><a id="2406" href="BitML.Contracts.Types.html#2461" class="Field">G</a> <a id="2408" href="BitML.Contracts.Validity.html#1719" class="Bound">ad</a><a id="2410" class="Symbol">)</a> <a id="2412" class="Symbol">(</a><a id="2413" href="BitML.Contracts.Types.html#2482" class="Field">C</a> <a id="2415" href="BitML.Contracts.Validity.html#1719" class="Bound">ad</a><a id="2417" class="Symbol">)</a>

<a id="2420" class="Keyword">open</a> <a id="2425" href="BitML.Contracts.Validity.html#1699" class="Module">ValidAdvertisement</a> <a id="2444" class="Keyword">public</a>

<a id="validAd?"></a><a id="2452" href="BitML.Contracts.Validity.html#2452" class="Function">validAd?</a> <a id="2461" class="Symbol">:</a> <a id="2463" class="Symbol">∀</a> <a id="2465" class="Symbol">(</a><a id="2466" href="BitML.Contracts.Validity.html#2466" class="Bound">ad</a> <a id="2469" class="Symbol">:</a> <a id="2471" href="BitML.Contracts.Types.html#2404" class="Record">Advertisement</a><a id="2484" class="Symbol">)</a> <a id="2486" class="Symbol">→</a> <a id="2488" href="Relation.Nullary.html#1508" class="Record">Dec</a> <a id="2492" class="Symbol">(</a><a id="2493" href="BitML.Contracts.Validity.html#1699" class="Record">ValidAdvertisement</a> <a id="2512" href="BitML.Contracts.Validity.html#2466" class="Bound">ad</a><a id="2514" class="Symbol">)</a>
<a id="2516" href="BitML.Contracts.Validity.html#2452" class="Function">validAd?</a> <a id="2525" class="Symbol">(</a><a id="2526" href="BitML.Contracts.Types.html#2444" class="InductiveConstructor Operator">⟨</a> <a id="2528" href="BitML.Contracts.Validity.html#2528" class="Bound">G</a> <a id="2530" href="BitML.Contracts.Types.html#2444" class="InductiveConstructor Operator">⟩</a> <a id="2532" href="BitML.Contracts.Validity.html#2532" class="Bound">C</a><a id="2533" class="Symbol">)</a>
  <a id="2537" class="Keyword">with</a> <a id="2542" href="Prelude.DecLists.html#1144" class="Function">unique?</a> <a id="2550" class="Symbol">(</a><a id="2551" href="BitML.Contracts.Helpers.html#3536" class="Function">names</a> <a id="2557" href="BitML.Contracts.Validity.html#2528" class="Bound">G</a><a id="2558" class="Symbol">)</a>
     <a id="2565" class="Symbol">|</a> <a id="2567" href="BitML.Contracts.Helpers.html#3536" class="Function">names</a> <a id="2573" href="BitML.Contracts.Validity.html#2532" class="Bound">C</a> <a id="2575" href="Prelude.DecLists.html#247" class="Function Operator">⊆?</a> <a id="2578" href="BitML.Contracts.Helpers.html#3536" class="Function">names</a> <a id="2584" href="BitML.Contracts.Validity.html#2528" class="Bound">G</a>
     <a id="2591" class="Symbol">|</a> <a id="2593" href="Data.List.Relation.Unary.All.html#6205" class="Function">all?</a> <a id="2598" class="Symbol">(λ{</a> <a id="2602" class="Symbol">(</a><a id="2603" href="BitML.Contracts.Validity.html#2603" class="Bound">xs</a> <a id="2606" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2608" href="BitML.Contracts.Validity.html#2608" class="Bound">as</a> <a id="2611" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2613" href="BitML.Contracts.Validity.html#2613" class="Bound">p</a><a id="2614" class="Symbol">)</a> <a id="2616" class="Symbol">→</a> <a id="2618" href="Prelude.DecLists.html#1144" class="Function">unique?</a> <a id="2626" href="BitML.Contracts.Validity.html#2603" class="Bound">xs</a> <a id="2629" href="Relation.Nullary.Product.html#904" class="Function Operator">×-dec</a> <a id="2635" class="Symbol">(</a><a id="2636" href="BitML.Contracts.Helpers.html#4703" class="Function">secrets</a> <a id="2644" href="BitML.Contracts.Validity.html#2613" class="Bound">p</a> <a id="2646" href="Prelude.DecLists.html#247" class="Function Operator">⊆?</a> <a id="2649" href="BitML.Contracts.Validity.html#2608" class="Bound">as</a><a id="2651" class="Symbol">)})</a> <a id="2655" class="Symbol">(</a><a id="2656" href="BitML.Contracts.Helpers.html#5467" class="Function">putComponents</a> <a id="2670" href="BitML.Contracts.Validity.html#2532" class="Bound">C</a><a id="2671" class="Symbol">)</a>
     <a id="2678" class="Symbol">|</a> <a id="2680" href="BitML.Contracts.Helpers.html#2497" class="Function">participants</a> <a id="2693" href="BitML.Contracts.Validity.html#2528" class="Bound">G</a> <a id="2695" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="2698" href="BitML.Contracts.Helpers.html#2497" class="Function">participants</a> <a id="2711" href="BitML.Contracts.Validity.html#2532" class="Bound">C</a> <a id="2713" href="Prelude.DecLists.html#247" class="Function Operator">⊆?</a> <a id="2716" href="BitML.Contracts.Helpers.html#7808" class="Function">persistentParticipants</a> <a id="2739" href="BitML.Contracts.Validity.html#2528" class="Bound">G</a>
     <a id="2746" class="Symbol">|</a> <a id="2748" href="Data.Bool.Properties.html#15457" class="Function">T?</a> <a id="2751" class="Symbol">(</a><a id="2752" href="BitML.Contracts.Validity.html#1025" class="Function">splitsOK</a> <a id="2761" href="BitML.Contracts.Validity.html#2528" class="Bound">G</a> <a id="2763" href="BitML.Contracts.Validity.html#2532" class="Bound">C</a><a id="2764" class="Symbol">)</a>
<a id="2766" class="Symbol">...</a> <a id="2770" class="Symbol">|</a> <a id="2772" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="2775" href="BitML.Contracts.Validity.html#2775" class="Bound">¬names-uniq</a> <a id="2787" class="Symbol">|</a> <a id="2789" class="Symbol">_</a> <a id="2791" class="Symbol">|</a> <a id="2793" class="Symbol">_</a> <a id="2795" class="Symbol">|</a> <a id="2797" class="Symbol">_</a> <a id="2799" class="Symbol">|</a> <a id="2801" class="Symbol">_</a>     <a id="2807" class="Symbol">=</a> <a id="2809" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="2812" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="2814" href="BitML.Contracts.Validity.html#2775" class="Bound">¬names-uniq</a> <a id="2826" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2828" href="BitML.Contracts.Validity.html#1867" class="Field">names-uniq</a>
<a id="2839" class="CatchallClause Symbol">...</a><a id="2842" class="CatchallClause"> </a><a id="2843" class="CatchallClause Symbol">|</a><a id="2844" class="CatchallClause"> </a><a id="2845" class="CatchallClause Symbol">_</a><a id="2846" class="CatchallClause"> </a><a id="2847" class="CatchallClause Symbol">|</a><a id="2848" class="CatchallClause"> </a><a id="2849" href="Relation.Nullary.html#1682" class="CatchallClause InductiveConstructor">no</a><a id="2851" class="CatchallClause"> </a><a id="2852" href="BitML.Contracts.Validity.html#2852" class="CatchallClause Bound">¬names-⊆</a><a id="2860" class="CatchallClause"> </a><a id="2861" class="CatchallClause Symbol">|</a><a id="2862" class="CatchallClause"> </a><a id="2863" class="CatchallClause Symbol">_</a><a id="2864" class="CatchallClause"> </a><a id="2865" class="CatchallClause Symbol">|</a><a id="2866" class="CatchallClause"> </a><a id="2867" class="CatchallClause Symbol">_</a><a id="2868" class="CatchallClause"> </a><a id="2869" class="CatchallClause Symbol">|</a><a id="2870" class="CatchallClause"> </a><a id="2871" class="CatchallClause Symbol">_</a>        <a id="2880" class="Symbol">=</a> <a id="2882" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="2885" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="2887" href="BitML.Contracts.Validity.html#2852" class="Bound">¬names-⊆</a> <a id="2896" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2898" href="BitML.Contracts.Validity.html#1947" class="Field">names-⊆</a>
<a id="2906" class="CatchallClause Symbol">...</a><a id="2909" class="CatchallClause"> </a><a id="2910" class="CatchallClause Symbol">|</a><a id="2911" class="CatchallClause"> </a><a id="2912" class="CatchallClause Symbol">_</a><a id="2913" class="CatchallClause"> </a><a id="2914" class="CatchallClause Symbol">|</a><a id="2915" class="CatchallClause"> </a><a id="2916" class="CatchallClause Symbol">_</a><a id="2917" class="CatchallClause"> </a><a id="2918" class="CatchallClause Symbol">|</a><a id="2919" class="CatchallClause"> </a><a id="2920" href="Relation.Nullary.html#1682" class="CatchallClause InductiveConstructor">no</a><a id="2922" class="CatchallClause"> </a><a id="2923" href="BitML.Contracts.Validity.html#2923" class="CatchallClause Bound">¬names-put</a><a id="2933" class="CatchallClause"> </a><a id="2934" class="CatchallClause Symbol">|</a><a id="2935" class="CatchallClause"> </a><a id="2936" class="CatchallClause Symbol">_</a><a id="2937" class="CatchallClause"> </a><a id="2938" class="CatchallClause Symbol">|</a><a id="2939" class="CatchallClause"> </a><a id="2940" class="CatchallClause Symbol">_</a>      <a id="2947" class="Symbol">=</a> <a id="2949" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="2952" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="2954" href="BitML.Contracts.Validity.html#2923" class="Bound">¬names-put</a> <a id="2965" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2967" href="BitML.Contracts.Validity.html#2089" class="Field">names-put</a>
<a id="2977" class="CatchallClause Symbol">...</a><a id="2980" class="CatchallClause"> </a><a id="2981" class="CatchallClause Symbol">|</a><a id="2982" class="CatchallClause"> </a><a id="2983" class="CatchallClause Symbol">_</a><a id="2984" class="CatchallClause"> </a><a id="2985" class="CatchallClause Symbol">|</a><a id="2986" class="CatchallClause"> </a><a id="2987" class="CatchallClause Symbol">_</a><a id="2988" class="CatchallClause"> </a><a id="2989" class="CatchallClause Symbol">|</a><a id="2990" class="CatchallClause"> </a><a id="2991" class="CatchallClause Symbol">_</a><a id="2992" class="CatchallClause"> </a><a id="2993" class="CatchallClause Symbol">|</a><a id="2994" class="CatchallClause"> </a><a id="2995" href="Relation.Nullary.html#1682" class="CatchallClause InductiveConstructor">no</a><a id="2997" class="CatchallClause"> </a><a id="2998" href="BitML.Contracts.Validity.html#2998" class="CatchallClause Bound">¬participants-⊆</a><a id="3013" class="CatchallClause"> </a><a id="3014" class="CatchallClause Symbol">|</a><a id="3015" class="CatchallClause"> </a><a id="3016" class="CatchallClause Symbol">_</a> <a id="3018" class="Symbol">=</a> <a id="3020" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="3023" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="3025" href="BitML.Contracts.Validity.html#2998" class="Bound">¬participants-⊆</a> <a id="3041" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3043" href="BitML.Contracts.Validity.html#2243" class="Field">participants-⊆</a>
<a id="3058" class="CatchallClause Symbol">...</a><a id="3061" class="CatchallClause"> </a><a id="3062" class="CatchallClause Symbol">|</a><a id="3063" class="CatchallClause"> </a><a id="3064" class="CatchallClause Symbol">_</a><a id="3065" class="CatchallClause"> </a><a id="3066" class="CatchallClause Symbol">|</a><a id="3067" class="CatchallClause"> </a><a id="3068" class="CatchallClause Symbol">_</a><a id="3069" class="CatchallClause"> </a><a id="3070" class="CatchallClause Symbol">|</a><a id="3071" class="CatchallClause"> </a><a id="3072" class="CatchallClause Symbol">_</a><a id="3073" class="CatchallClause"> </a><a id="3074" class="CatchallClause Symbol">|</a><a id="3075" class="CatchallClause"> </a><a id="3076" class="CatchallClause Symbol">_</a><a id="3077" class="CatchallClause"> </a><a id="3078" class="CatchallClause Symbol">|</a><a id="3079" class="CatchallClause"> </a><a id="3080" href="Relation.Nullary.html#1682" class="CatchallClause InductiveConstructor">no</a><a id="3082" class="CatchallClause"> </a><a id="3083" href="BitML.Contracts.Validity.html#3083" class="CatchallClause Bound">¬splits-OK</a>      <a id="3099" class="Symbol">=</a> <a id="3101" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="3104" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="3106" href="BitML.Contracts.Validity.html#3083" class="Bound">¬splits-OK</a> <a id="3117" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3119" href="BitML.Contracts.Validity.html#2380" class="Field">splits-OK</a>
<a id="3129" class="Symbol">...</a> <a id="3133" class="Symbol">|</a> <a id="3135" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="3139" href="BitML.Contracts.Validity.html#3139" class="Bound">p₁</a> <a id="3142" class="Symbol">|</a> <a id="3144" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="3148" href="BitML.Contracts.Validity.html#3148" class="Bound">p₂</a> <a id="3151" class="Symbol">|</a> <a id="3153" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="3157" href="BitML.Contracts.Validity.html#3157" class="Bound">p₃</a> <a id="3160" class="Symbol">|</a> <a id="3162" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="3166" href="BitML.Contracts.Validity.html#3166" class="Bound">p₄</a> <a id="3169" class="Symbol">|</a> <a id="3171" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="3175" href="BitML.Contracts.Validity.html#3175" class="Bound">p₅</a> <a id="3178" class="Symbol">=</a> <a id="3180" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="3184" class="Keyword">record</a>
  <a id="3193" class="Symbol">{</a> <a id="3195" href="BitML.Contracts.Validity.html#1867" class="Field">names-uniq</a> <a id="3206" class="Symbol">=</a> <a id="3208" href="BitML.Contracts.Validity.html#3139" class="Bound">p₁</a>
  <a id="3213" class="Symbol">;</a> <a id="3215" href="BitML.Contracts.Validity.html#1947" class="Field">names-⊆</a> <a id="3223" class="Symbol">=</a> <a id="3225" href="BitML.Contracts.Validity.html#3148" class="Bound">p₂</a>
  <a id="3230" class="Symbol">;</a> <a id="3232" href="BitML.Contracts.Validity.html#2089" class="Field">names-put</a> <a id="3242" class="Symbol">=</a> <a id="3244" href="BitML.Contracts.Validity.html#3157" class="Bound">p₃</a>
  <a id="3249" class="Symbol">;</a> <a id="3251" href="BitML.Contracts.Validity.html#2243" class="Field">participants-⊆</a> <a id="3266" class="Symbol">=</a> <a id="3268" href="BitML.Contracts.Validity.html#3166" class="Bound">p₄</a>
  <a id="3273" class="Symbol">;</a> <a id="3275" href="BitML.Contracts.Validity.html#2380" class="Field">splits-OK</a> <a id="3285" class="Symbol">=</a> <a id="3287" href="BitML.Contracts.Validity.html#3175" class="Bound">p₅</a>
  <a id="3292" class="Symbol">}</a>
</pre></body></html>