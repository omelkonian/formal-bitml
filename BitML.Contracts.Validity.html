<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>BitML.Contracts.Validity</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Validity of advertisements.</a>
<a id="105" class="Comment">------------------------------------------------------------------------</a>
<a id="178" class="Keyword">open</a> <a id="183" class="Keyword">import</a> <a id="190" href="Function.html" class="Module">Function</a> <a id="199" class="Keyword">using</a> <a id="205" class="Symbol">(</a><a id="206" href="Function.Base.html#615" class="Function">id</a><a id="208" class="Symbol">)</a>

<a id="211" class="Keyword">open</a> <a id="216" class="Keyword">import</a> <a id="223" href="Data.List.Membership.Propositional.Properties.html" class="Module">Data.List.Membership.Propositional.Properties</a>
<a id="269" class="Keyword">open</a> <a id="274" class="Keyword">import</a> <a id="281" href="Data.List.Relation.Binary.Subset.Propositional.Properties.html" class="Module">Data.List.Relation.Binary.Subset.Propositional.Properties</a>

<a id="340" class="Keyword">open</a> <a id="345" class="Keyword">import</a> <a id="352" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="365" class="Keyword">open</a> <a id="370" class="Keyword">import</a> <a id="377" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="393" class="Keyword">open</a> <a id="398" class="Keyword">import</a> <a id="405" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="419" class="Keyword">open</a> <a id="424" class="Keyword">import</a> <a id="431" href="Prelude.DecLists.html" class="Module">Prelude.DecLists</a>
<a id="448" class="Keyword">open</a> <a id="453" class="Keyword">import</a> <a id="460" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="474" class="Comment">-- open import Prelude.Membership</a>
<a id="508" class="Keyword">open</a> <a id="513" class="Keyword">import</a> <a id="520" href="Prelude.Sets.html" class="Module">Prelude.Sets</a>
<a id="533" class="Keyword">open</a> <a id="538" class="Keyword">import</a> <a id="545" href="Prelude.Measurable.html" class="Module">Prelude.Measurable</a>
<a id="564" class="Keyword">open</a> <a id="569" class="Keyword">import</a> <a id="576" href="Prelude.Collections.html" class="Module">Prelude.Collections</a>
<a id="596" class="Keyword">open</a> <a id="601" class="Keyword">import</a> <a id="608" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="624" class="Keyword">open</a> <a id="629" class="Keyword">import</a> <a id="636" href="Prelude.Foldable.html" class="Module">Prelude.Foldable</a>
<a id="653" class="Keyword">open</a> <a id="658" class="Keyword">import</a> <a id="665" href="Prelude.Traversable.html" class="Module">Prelude.Traversable</a>
<a id="685" class="Keyword">open</a> <a id="690" class="Keyword">import</a> <a id="697" href="Prelude.Monad.html" class="Module">Prelude.Monad</a>

<a id="712" class="Keyword">open</a> <a id="717" class="Keyword">import</a> <a id="724" href="BitML.BasicTypes.html" class="Module">BitML.BasicTypes</a>
<a id="741" class="Keyword">open</a> <a id="746" class="Keyword">import</a> <a id="753" href="BitML.Predicate.html" class="Module">BitML.Predicate</a> <a id="769" class="Keyword">hiding</a> <a id="776" class="Symbol">(</a><a id="777" href="BitML.Predicate.html#531" class="InductiveConstructor Operator">∣_∣</a><a id="780" class="Symbol">)</a>

<a id="783" class="Keyword">module</a> <a id="790" href="BitML.Contracts.Validity.html" class="Module">BitML.Contracts.Validity</a>
  <a id="817" class="Symbol">(</a><a id="818" href="BitML.Contracts.Validity.html#818" class="Bound">Participant</a> <a id="830" class="Symbol">:</a> <a id="832" class="PrimitiveType">Set</a><a id="835" class="Symbol">)</a>
  <a id="839" class="Symbol">⦃</a> <a id="841" href="BitML.Contracts.Validity.html#841" class="Bound">_</a> <a id="843" class="Symbol">:</a> <a id="845" href="Prelude.DecEq.html#581" class="Record">DecEq</a> <a id="851" href="BitML.Contracts.Validity.html#818" class="Bound">Participant</a> <a id="863" class="Symbol">⦄</a>
  <a id="867" class="Symbol">(</a><a id="868" href="BitML.Contracts.Validity.html#868" class="Bound">Honest</a> <a id="875" class="Symbol">:</a> <a id="877" href="Data.List.NonEmpty.html#1318" class="Record">List⁺</a> <a id="883" href="BitML.Contracts.Validity.html#818" class="Bound">Participant</a><a id="894" class="Symbol">)</a>
  <a id="898" class="Keyword">where</a>

<a id="905" class="Keyword">open</a> <a id="910" class="Keyword">import</a> <a id="917" href="BitML.Contracts.Types.html" class="Module">BitML.Contracts.Types</a> <a id="939" href="BitML.Contracts.Validity.html#818" class="Bound">Participant</a> <a id="951" href="BitML.Contracts.Validity.html#868" class="Bound">Honest</a> <a id="958" class="Keyword">hiding</a> <a id="965" class="Symbol">(</a>B<a id="967" class="Symbol">)</a>
<a id="969" class="Keyword">open</a> <a id="974" class="Keyword">import</a> <a id="981" href="BitML.Contracts.Helpers.html" class="Module">BitML.Contracts.Helpers</a> <a id="1005" href="BitML.Contracts.Validity.html#818" class="Bound">Participant</a> <a id="1017" href="BitML.Contracts.Validity.html#868" class="Bound">Honest</a>

<a id="splitsOK"></a><a id="1025" href="BitML.Contracts.Validity.html#1025" class="Function">splitsOK</a> <a id="1034" class="Symbol">:</a> <a id="1036" href="BitML.Contracts.Types.html#1825" class="Datatype">Precondition</a> <a id="1049" class="Symbol">→</a> <a id="1051" href="BitML.Contracts.Types.html#649" class="Function">Contracts</a> <a id="1061" class="Symbol">→</a> <a id="1063" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1068" href="BitML.Contracts.Validity.html#1025" class="Function">splitsOK</a> <a id="1077" href="BitML.Contracts.Validity.html#1077" class="Bound">G</a> <a id="1079" href="BitML.Contracts.Validity.html#1079" class="Bound">C₀</a> <a id="1082" class="Symbol">=</a> <a id="1084" href="BitML.Contracts.Validity.html#1164" class="Function">goᶜˢ</a> <a id="1089" href="BitML.Contracts.Validity.html#1079" class="Bound">C₀</a> <a id="1092" class="Symbol">(</a><a id="1093" href="BitML.Contracts.Helpers.html#7683" class="Function">persistentValue</a> <a id="1109" href="BitML.Contracts.Validity.html#1077" class="Bound">G</a><a id="1110" class="Symbol">)</a>
  <a id="1114" class="Keyword">where</a>
    <a id="1124" href="BitML.Contracts.Validity.html#1124" class="Function">goᶜ</a> <a id="1128" class="Symbol">:</a> <a id="1130" class="Symbol">(</a><a id="1131" href="BitML.Contracts.Validity.html#1131" class="Bound">C</a> <a id="1133" class="Symbol">:</a> <a id="1135" href="BitML.Contracts.Types.html#634" class="Datatype">Contract</a><a id="1143" class="Symbol">)</a> <a id="1145" class="Symbol">→</a> <a id="1147" href="BitML.BasicTypes.html#229" class="Function">Value</a> <a id="1153" class="Symbol">→</a> <a id="1155" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="1164" href="BitML.Contracts.Validity.html#1164" class="Function">goᶜˢ</a> <a id="1169" class="Symbol">:</a> <a id="1171" class="Symbol">(</a><a id="1172" href="BitML.Contracts.Validity.html#1172" class="Bound">C</a> <a id="1174" class="Symbol">:</a> <a id="1176" href="BitML.Contracts.Types.html#649" class="Function">Contracts</a><a id="1185" class="Symbol">)</a> <a id="1187" class="Symbol">→</a> <a id="1189" href="BitML.BasicTypes.html#229" class="Function">Value</a> <a id="1195" class="Symbol">→</a> <a id="1197" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="1206" href="BitML.Contracts.Validity.html#1206" class="Function">goᵛᶜˢ</a> <a id="1212" class="Symbol">:</a> <a id="1214" class="Symbol">(</a><a id="1215" href="BitML.Contracts.Validity.html#1215" class="Bound">C</a> <a id="1217" class="Symbol">:</a> <a id="1219" href="BitML.Contracts.Types.html#675" class="Function">VContracts</a><a id="1229" class="Symbol">)</a> <a id="1231" class="Symbol">→</a> <a id="1233" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>

    <a id="1243" href="BitML.Contracts.Validity.html#1206" class="Function">goᵛᶜˢ</a> <a id="1249" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1252" class="Symbol">=</a> <a id="1254" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
    <a id="1263" href="BitML.Contracts.Validity.html#1206" class="Function">goᵛᶜˢ</a> <a id="1269" class="Symbol">((</a><a id="1271" href="BitML.Contracts.Validity.html#1271" class="Bound">v</a> <a id="1273" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1275" href="BitML.Contracts.Validity.html#1275" class="Bound">cs</a><a id="1277" class="Symbol">)</a> <a id="1279" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1281" href="BitML.Contracts.Validity.html#1281" class="Bound">vcs</a><a id="1284" class="Symbol">)</a> <a id="1286" class="Symbol">=</a> <a id="1288" href="BitML.Contracts.Validity.html#1164" class="Function">goᶜˢ</a> <a id="1293" href="BitML.Contracts.Validity.html#1275" class="Bound">cs</a> <a id="1296" href="BitML.Contracts.Validity.html#1271" class="Bound">v</a>

    <a id="1303" href="BitML.Contracts.Validity.html#1164" class="Function">goᶜˢ</a> <a id="1308" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1311" class="Symbol">_</a> <a id="1313" class="Symbol">=</a> <a id="1315" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
    <a id="1324" href="BitML.Contracts.Validity.html#1164" class="Function">goᶜˢ</a> <a id="1329" class="Symbol">(</a><a id="1330" href="BitML.Contracts.Validity.html#1330" class="Bound">c</a> <a id="1332" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1334" href="BitML.Contracts.Validity.html#1334" class="Bound">cs</a><a id="1336" class="Symbol">)</a> <a id="1338" href="BitML.Contracts.Validity.html#1338" class="Bound">v</a> <a id="1340" class="Symbol">=</a> <a id="1342" href="BitML.Contracts.Validity.html#1124" class="Function">goᶜ</a> <a id="1346" href="BitML.Contracts.Validity.html#1330" class="Bound">c</a> <a id="1348" href="BitML.Contracts.Validity.html#1338" class="Bound">v</a> <a id="1350" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="1352" href="BitML.Contracts.Validity.html#1164" class="Function">goᶜˢ</a> <a id="1357" href="BitML.Contracts.Validity.html#1334" class="Bound">cs</a> <a id="1360" href="BitML.Contracts.Validity.html#1338" class="Bound">v</a>

    <a id="1367" href="BitML.Contracts.Validity.html#1124" class="Function">goᶜ</a> <a id="1371" href="BitML.Contracts.Validity.html#1371" class="Bound">c₀</a><a id="1373" class="Symbol">@(</a><a id="1375" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">put</a> <a id="1379" href="BitML.Contracts.Validity.html#1379" class="Bound">xs</a> <a id="1382" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">&amp;reveal</a> <a id="1390" href="BitML.Contracts.Validity.html#1390" class="Bound">as</a> <a id="1393" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">if</a> <a id="1396" href="BitML.Contracts.Validity.html#1396" class="Bound">p</a> <a id="1398" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">⇒</a> <a id="1400" href="BitML.Contracts.Validity.html#1400" class="Bound">c</a><a id="1401" class="Symbol">)</a> <a id="1403" href="BitML.Contracts.Validity.html#1403" class="Bound">v</a>
      <a id="1411" class="Keyword">with</a> <a id="1416" href="Prelude.Traversable.html#667" class="Field">sequenceM</a> <a id="1426" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="1428" href="Data.List.Base.html#1497" class="Function">map</a> <a id="1432" class="Symbol">(λ</a> <a id="1435" href="BitML.Contracts.Validity.html#1435" class="Bound">x</a> <a id="1437" class="Symbol">→</a> <a id="1439" href="BitML.Contracts.Helpers.html#11406" class="Function">checkDeposit</a> <a id="1452" href="BitML.Contracts.Types.html#2907" class="InductiveConstructor">volatile</a> <a id="1461" href="BitML.Contracts.Validity.html#1435" class="Bound">x</a> <a id="1463" href="BitML.Contracts.Validity.html#1077" class="Bound">G</a><a id="1464" class="Symbol">)</a> <a id="1466" href="BitML.Contracts.Validity.html#1379" class="Bound">xs</a>
    <a id="1473" class="Symbol">...</a> <a id="1477" class="Symbol">|</a> <a id="1479" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a> <a id="1487" class="Symbol">=</a> <a id="1489" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
    <a id="1499" class="Symbol">...</a> <a id="1503" class="Symbol">|</a> <a id="1505" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="1510" href="BitML.Contracts.Validity.html#1510" class="Bound">vs</a> <a id="1513" class="Symbol">=</a> <a id="1515" href="BitML.Contracts.Validity.html#1164" class="Function">goᶜˢ</a> <a id="1520" class="Bound">c</a> <a id="1522" class="Symbol">(</a><a id="1523" href="Prelude.Lists.html#24579" class="Function">∑ℕ</a> <a id="1526" href="BitML.Contracts.Validity.html#1510" class="Bound">vs</a><a id="1528" class="Symbol">)</a>
    <a id="1534" href="BitML.Contracts.Validity.html#1124" class="Function">goᶜ</a> <a id="1538" class="Symbol">(</a><a id="1539" href="BitML.Contracts.Types.html#1024" class="InductiveConstructor">split</a> <a id="1545" href="BitML.Contracts.Validity.html#1545" class="Bound">vcs</a><a id="1548" class="Symbol">)</a>   <a id="1552" href="BitML.Contracts.Validity.html#1552" class="Bound">v</a> <a id="1554" class="Symbol">=</a> <a id="1556" class="Symbol">(</a><a id="1557" href="Prelude.Lists.html#24640" class="Function">∑₁</a> <a id="1560" href="BitML.Contracts.Validity.html#1545" class="Bound">vcs</a> <a id="1564" href="Prelude.DecEq.html#661" class="Function Operator">==</a> <a id="1567" href="BitML.Contracts.Validity.html#1552" class="Bound">v</a><a id="1568" class="Symbol">)</a> <a id="1570" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="1572" href="BitML.Contracts.Validity.html#1206" class="Function">goᵛᶜˢ</a> <a id="1578" href="BitML.Contracts.Validity.html#1545" class="Bound">vcs</a>
    <a id="1586" href="BitML.Contracts.Validity.html#1124" class="Function">goᶜ</a> <a id="1590" class="Symbol">(</a><a id="1591" href="BitML.Contracts.Types.html#1172" class="InductiveConstructor Operator">after</a> <a id="1597" class="Symbol">_</a> <a id="1599" href="BitML.Contracts.Types.html#1172" class="InductiveConstructor Operator">⇒</a> <a id="1601" href="BitML.Contracts.Validity.html#1601" class="Bound">c</a><a id="1602" class="Symbol">)</a> <a id="1604" href="BitML.Contracts.Validity.html#1604" class="Bound">v</a> <a id="1606" class="Symbol">=</a> <a id="1608" href="BitML.Contracts.Validity.html#1124" class="Function">goᶜ</a> <a id="1612" href="BitML.Contracts.Validity.html#1601" class="Bound">c</a> <a id="1614" href="BitML.Contracts.Validity.html#1604" class="Bound">v</a>
    <a id="1620" href="BitML.Contracts.Validity.html#1124" class="Function">goᶜ</a> <a id="1624" class="Symbol">(_</a> <a id="1627" href="BitML.Contracts.Types.html#1099" class="InductiveConstructor Operator">⇒</a> <a id="1629" href="BitML.Contracts.Validity.html#1629" class="Bound">c</a><a id="1630" class="Symbol">)</a>       <a id="1638" href="BitML.Contracts.Validity.html#1638" class="Bound">v</a> <a id="1640" class="Symbol">=</a> <a id="1642" href="BitML.Contracts.Validity.html#1124" class="Function">goᶜ</a> <a id="1646" href="BitML.Contracts.Validity.html#1629" class="Bound">c</a> <a id="1648" href="BitML.Contracts.Validity.html#1638" class="Bound">v</a>
    <a id="1654" href="BitML.Contracts.Validity.html#1124" class="Function">goᶜ</a> <a id="1658" class="Symbol">(</a><a id="1659" href="BitML.Contracts.Types.html#886" class="InductiveConstructor">withdraw</a> <a id="1668" class="Symbol">_)</a>  <a id="1672" class="Symbol">_</a> <a id="1674" class="Symbol">=</a> <a id="1676" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>

<a id="1682" class="Keyword">record</a> <a id="ValidAdvertisement"></a><a id="1689" href="BitML.Contracts.Validity.html#1689" class="Record">ValidAdvertisement</a> <a id="1708" class="Symbol">(</a><a id="1709" href="BitML.Contracts.Validity.html#1709" class="Bound">ad</a> <a id="1712" class="Symbol">:</a> <a id="1714" href="BitML.Contracts.Types.html#2404" class="Record">Advertisement</a><a id="1727" class="Symbol">)</a> <a id="1729" class="Symbol">:</a> <a id="1731" class="PrimitiveType">Set</a> <a id="1735" class="Keyword">where</a>
  <a id="1743" class="Comment">-- open Advertisement ad renaming (C to c; G to g) -- ⟨ G ⟩ C = ad</a>
  <a id="1812" class="Keyword">field</a>
    <a id="1822" class="Comment">-- (i) names in G are distinct</a>
    <a id="ValidAdvertisement.names-uniq"></a><a id="1857" href="BitML.Contracts.Validity.html#1857" class="Field">names-uniq</a> <a id="1868" class="Symbol">:</a> <a id="1870" href="Data.List.Relation.Unary.Unique.Setoid.html#869" class="Datatype">Unique</a> <a id="1877" class="Symbol">(</a><a id="1878" href="BitML.Contracts.Helpers.html#3536" class="Function">names</a> <a id="1884" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="1886" href="BitML.Contracts.Types.html#2461" class="Field">G</a> <a id="1888" href="BitML.Contracts.Validity.html#1709" class="Bound">ad</a><a id="1890" class="Symbol">)</a>

    <a id="1897" class="Comment">-- (ii) each name in C appears in G</a>
    <a id="ValidAdvertisement.names-⊆"></a><a id="1937" href="BitML.Contracts.Validity.html#1937" class="Field">names-⊆</a> <a id="1945" class="Symbol">:</a> <a id="1947" href="BitML.Contracts.Helpers.html#3536" class="Function">names</a> <a id="1953" class="Symbol">(</a><a id="1954" href="BitML.Contracts.Types.html#2482" class="Field">C</a> <a id="1956" href="BitML.Contracts.Validity.html#1709" class="Bound">ad</a><a id="1958" class="Symbol">)</a> <a id="1960" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="1962" href="BitML.Contracts.Helpers.html#3536" class="Function">names</a> <a id="1968" class="Symbol">(</a><a id="1969" href="BitML.Contracts.Types.html#2461" class="Field">G</a> <a id="1971" href="BitML.Contracts.Validity.html#1709" class="Bound">ad</a><a id="1973" class="Symbol">)</a>

    <a id="1980" class="Comment">-- (iii) the names in put_&amp;reveal_ are distinct and secrets in `if ...` appear in `reveal ...`</a>
    <a id="ValidAdvertisement.names-put"></a><a id="2079" href="BitML.Contracts.Validity.html#2079" class="Field">names-put</a> <a id="2089" class="Symbol">:</a> <a id="2091" href="Data.List.Relation.Unary.All.html#1274" class="Datatype">All</a> <a id="2095" class="Symbol">(λ{</a> <a id="2099" class="Symbol">(</a><a id="2100" href="BitML.Contracts.Validity.html#2100" class="Bound">xs</a> <a id="2103" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2105" href="BitML.Contracts.Validity.html#2105" class="Bound">as</a> <a id="2108" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2110" href="BitML.Contracts.Validity.html#2110" class="Bound">p</a><a id="2111" class="Symbol">)</a> <a id="2113" class="Symbol">→</a> <a id="2115" href="Data.List.Relation.Unary.Unique.Setoid.html#869" class="Datatype">Unique</a> <a id="2122" href="BitML.Contracts.Validity.html#2100" class="Bound">xs</a> <a id="2125" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2127" class="Symbol">(</a><a id="2128" href="BitML.Contracts.Helpers.html#4703" class="Function">secrets</a> <a id="2136" href="BitML.Contracts.Validity.html#2110" class="Bound">p</a> <a id="2138" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="2140" href="BitML.Contracts.Validity.html#2105" class="Bound">as</a><a id="2142" class="Symbol">)})</a> <a id="2146" class="Symbol">(</a><a id="2147" href="BitML.Contracts.Helpers.html#5467" class="Function">putComponents</a> <a id="2161" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="2163" href="BitML.Contracts.Types.html#2482" class="Field">C</a> <a id="2165" href="BitML.Contracts.Validity.html#1709" class="Bound">ad</a><a id="2167" class="Symbol">)</a>

    <a id="2174" class="Comment">-- (iv) each participant has a persistent deposit in G</a>
    <a id="ValidAdvertisement.participants-⊆"></a><a id="2233" href="BitML.Contracts.Validity.html#2233" class="Field">participants-⊆</a> <a id="2248" class="Symbol">:</a> <a id="2250" href="BitML.Contracts.Helpers.html#2497" class="Function">participants</a> <a id="2263" class="Symbol">(</a><a id="2264" href="BitML.Contracts.Types.html#2461" class="Field">G</a> <a id="2266" href="BitML.Contracts.Validity.html#1709" class="Bound">ad</a><a id="2268" class="Symbol">)</a> <a id="2270" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="2273" href="BitML.Contracts.Helpers.html#2497" class="Function">participants</a> <a id="2286" class="Symbol">(</a><a id="2287" href="BitML.Contracts.Types.html#2482" class="Field">C</a> <a id="2289" href="BitML.Contracts.Validity.html#1709" class="Bound">ad</a><a id="2291" class="Symbol">)</a> <a id="2293" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="2295" href="BitML.Contracts.Helpers.html#7808" class="Function">persistentParticipants</a> <a id="2318" class="Symbol">(</a><a id="2319" href="BitML.Contracts.Types.html#2461" class="Field">G</a> <a id="2321" href="BitML.Contracts.Validity.html#1709" class="Bound">ad</a><a id="2323" class="Symbol">)</a>

    <a id="2330" class="Comment">-- (extra) split commands are valid</a>
    <a id="ValidAdvertisement.splits-OK"></a><a id="2370" href="BitML.Contracts.Validity.html#2370" class="Field">splits-OK</a> <a id="2380" class="Symbol">:</a> <a id="2382" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="2384" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="2386" href="BitML.Contracts.Validity.html#1025" class="Function">splitsOK</a> <a id="2395" class="Symbol">(</a><a id="2396" href="BitML.Contracts.Types.html#2461" class="Field">G</a> <a id="2398" href="BitML.Contracts.Validity.html#1709" class="Bound">ad</a><a id="2400" class="Symbol">)</a> <a id="2402" class="Symbol">(</a><a id="2403" href="BitML.Contracts.Types.html#2482" class="Field">C</a> <a id="2405" href="BitML.Contracts.Validity.html#1709" class="Bound">ad</a><a id="2407" class="Symbol">)</a>

<a id="2410" class="Keyword">open</a> <a id="2415" href="BitML.Contracts.Validity.html#1689" class="Module">ValidAdvertisement</a> <a id="2434" class="Keyword">public</a>

<a id="validAd?"></a><a id="2442" href="BitML.Contracts.Validity.html#2442" class="Function">validAd?</a> <a id="2451" class="Symbol">:</a> <a id="2453" class="Symbol">∀</a> <a id="2455" class="Symbol">(</a><a id="2456" href="BitML.Contracts.Validity.html#2456" class="Bound">ad</a> <a id="2459" class="Symbol">:</a> <a id="2461" href="BitML.Contracts.Types.html#2404" class="Record">Advertisement</a><a id="2474" class="Symbol">)</a> <a id="2476" class="Symbol">→</a> <a id="2478" href="Relation.Nullary.html#1508" class="Record">Dec</a> <a id="2482" class="Symbol">(</a><a id="2483" href="BitML.Contracts.Validity.html#1689" class="Record">ValidAdvertisement</a> <a id="2502" href="BitML.Contracts.Validity.html#2456" class="Bound">ad</a><a id="2504" class="Symbol">)</a>
<a id="2506" href="BitML.Contracts.Validity.html#2442" class="Function">validAd?</a> <a id="2515" class="Symbol">(</a><a id="2516" href="BitML.Contracts.Types.html#2444" class="InductiveConstructor Operator">⟨</a> <a id="2518" href="BitML.Contracts.Validity.html#2518" class="Bound">G</a> <a id="2520" href="BitML.Contracts.Types.html#2444" class="InductiveConstructor Operator">⟩</a> <a id="2522" href="BitML.Contracts.Validity.html#2522" class="Bound">C</a><a id="2523" class="Symbol">)</a>
  <a id="2527" class="Keyword">with</a> <a id="2532" href="Prelude.DecLists.html#1144" class="Function">unique?</a> <a id="2540" class="Symbol">(</a><a id="2541" href="BitML.Contracts.Helpers.html#3536" class="Function">names</a> <a id="2547" href="BitML.Contracts.Validity.html#2518" class="Bound">G</a><a id="2548" class="Symbol">)</a>
     <a id="2555" class="Symbol">|</a> <a id="2557" href="BitML.Contracts.Helpers.html#3536" class="Function">names</a> <a id="2563" href="BitML.Contracts.Validity.html#2522" class="Bound">C</a> <a id="2565" href="Prelude.DecLists.html#247" class="Function Operator">⊆?</a> <a id="2568" href="BitML.Contracts.Helpers.html#3536" class="Function">names</a> <a id="2574" href="BitML.Contracts.Validity.html#2518" class="Bound">G</a>
     <a id="2581" class="Symbol">|</a> <a id="2583" href="Data.List.Relation.Unary.All.html#6205" class="Function">all?</a> <a id="2588" class="Symbol">(λ{</a> <a id="2592" class="Symbol">(</a><a id="2593" href="BitML.Contracts.Validity.html#2593" class="Bound">xs</a> <a id="2596" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2598" href="BitML.Contracts.Validity.html#2598" class="Bound">as</a> <a id="2601" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2603" href="BitML.Contracts.Validity.html#2603" class="Bound">p</a><a id="2604" class="Symbol">)</a> <a id="2606" class="Symbol">→</a> <a id="2608" href="Prelude.DecLists.html#1144" class="Function">unique?</a> <a id="2616" href="BitML.Contracts.Validity.html#2593" class="Bound">xs</a> <a id="2619" href="Relation.Nullary.Product.html#904" class="Function Operator">×-dec</a> <a id="2625" class="Symbol">(</a><a id="2626" href="BitML.Contracts.Helpers.html#4703" class="Function">secrets</a> <a id="2634" href="BitML.Contracts.Validity.html#2603" class="Bound">p</a> <a id="2636" href="Prelude.DecLists.html#247" class="Function Operator">⊆?</a> <a id="2639" href="BitML.Contracts.Validity.html#2598" class="Bound">as</a><a id="2641" class="Symbol">)})</a> <a id="2645" class="Symbol">(</a><a id="2646" href="BitML.Contracts.Helpers.html#5467" class="Function">putComponents</a> <a id="2660" href="BitML.Contracts.Validity.html#2522" class="Bound">C</a><a id="2661" class="Symbol">)</a>
     <a id="2668" class="Symbol">|</a> <a id="2670" href="BitML.Contracts.Helpers.html#2497" class="Function">participants</a> <a id="2683" href="BitML.Contracts.Validity.html#2518" class="Bound">G</a> <a id="2685" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="2688" href="BitML.Contracts.Helpers.html#2497" class="Function">participants</a> <a id="2701" href="BitML.Contracts.Validity.html#2522" class="Bound">C</a> <a id="2703" href="Prelude.DecLists.html#247" class="Function Operator">⊆?</a> <a id="2706" href="BitML.Contracts.Helpers.html#7808" class="Function">persistentParticipants</a> <a id="2729" href="BitML.Contracts.Validity.html#2518" class="Bound">G</a>
     <a id="2736" class="Symbol">|</a> <a id="2738" href="Data.Bool.Properties.html#15457" class="Function">T?</a> <a id="2741" class="Symbol">(</a><a id="2742" href="BitML.Contracts.Validity.html#1025" class="Function">splitsOK</a> <a id="2751" href="BitML.Contracts.Validity.html#2518" class="Bound">G</a> <a id="2753" href="BitML.Contracts.Validity.html#2522" class="Bound">C</a><a id="2754" class="Symbol">)</a>
<a id="2756" class="Symbol">...</a> <a id="2760" class="Symbol">|</a> <a id="2762" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="2765" href="BitML.Contracts.Validity.html#2765" class="Bound">¬names-uniq</a> <a id="2777" class="Symbol">|</a> <a id="2779" class="Symbol">_</a> <a id="2781" class="Symbol">|</a> <a id="2783" class="Symbol">_</a> <a id="2785" class="Symbol">|</a> <a id="2787" class="Symbol">_</a> <a id="2789" class="Symbol">|</a> <a id="2791" class="Symbol">_</a>     <a id="2797" class="Symbol">=</a> <a id="2799" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="2802" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="2804" href="BitML.Contracts.Validity.html#2765" class="Bound">¬names-uniq</a> <a id="2816" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2818" href="BitML.Contracts.Validity.html#1857" class="Field">names-uniq</a>
<a id="2829" class="CatchallClause Symbol">...</a><a id="2832" class="CatchallClause"> </a><a id="2833" class="CatchallClause Symbol">|</a><a id="2834" class="CatchallClause"> </a><a id="2835" class="CatchallClause Symbol">_</a><a id="2836" class="CatchallClause"> </a><a id="2837" class="CatchallClause Symbol">|</a><a id="2838" class="CatchallClause"> </a><a id="2839" href="Relation.Nullary.html#1682" class="CatchallClause InductiveConstructor">no</a><a id="2841" class="CatchallClause"> </a><a id="2842" href="BitML.Contracts.Validity.html#2842" class="CatchallClause Bound">¬names-⊆</a><a id="2850" class="CatchallClause"> </a><a id="2851" class="CatchallClause Symbol">|</a><a id="2852" class="CatchallClause"> </a><a id="2853" class="CatchallClause Symbol">_</a><a id="2854" class="CatchallClause"> </a><a id="2855" class="CatchallClause Symbol">|</a><a id="2856" class="CatchallClause"> </a><a id="2857" class="CatchallClause Symbol">_</a><a id="2858" class="CatchallClause"> </a><a id="2859" class="CatchallClause Symbol">|</a><a id="2860" class="CatchallClause"> </a><a id="2861" class="CatchallClause Symbol">_</a>        <a id="2870" class="Symbol">=</a> <a id="2872" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="2875" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="2877" href="BitML.Contracts.Validity.html#2842" class="Bound">¬names-⊆</a> <a id="2886" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2888" href="BitML.Contracts.Validity.html#1937" class="Field">names-⊆</a>
<a id="2896" class="CatchallClause Symbol">...</a><a id="2899" class="CatchallClause"> </a><a id="2900" class="CatchallClause Symbol">|</a><a id="2901" class="CatchallClause"> </a><a id="2902" class="CatchallClause Symbol">_</a><a id="2903" class="CatchallClause"> </a><a id="2904" class="CatchallClause Symbol">|</a><a id="2905" class="CatchallClause"> </a><a id="2906" class="CatchallClause Symbol">_</a><a id="2907" class="CatchallClause"> </a><a id="2908" class="CatchallClause Symbol">|</a><a id="2909" class="CatchallClause"> </a><a id="2910" href="Relation.Nullary.html#1682" class="CatchallClause InductiveConstructor">no</a><a id="2912" class="CatchallClause"> </a><a id="2913" href="BitML.Contracts.Validity.html#2913" class="CatchallClause Bound">¬names-put</a><a id="2923" class="CatchallClause"> </a><a id="2924" class="CatchallClause Symbol">|</a><a id="2925" class="CatchallClause"> </a><a id="2926" class="CatchallClause Symbol">_</a><a id="2927" class="CatchallClause"> </a><a id="2928" class="CatchallClause Symbol">|</a><a id="2929" class="CatchallClause"> </a><a id="2930" class="CatchallClause Symbol">_</a>      <a id="2937" class="Symbol">=</a> <a id="2939" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="2942" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="2944" href="BitML.Contracts.Validity.html#2913" class="Bound">¬names-put</a> <a id="2955" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2957" href="BitML.Contracts.Validity.html#2079" class="Field">names-put</a>
<a id="2967" class="CatchallClause Symbol">...</a><a id="2970" class="CatchallClause"> </a><a id="2971" class="CatchallClause Symbol">|</a><a id="2972" class="CatchallClause"> </a><a id="2973" class="CatchallClause Symbol">_</a><a id="2974" class="CatchallClause"> </a><a id="2975" class="CatchallClause Symbol">|</a><a id="2976" class="CatchallClause"> </a><a id="2977" class="CatchallClause Symbol">_</a><a id="2978" class="CatchallClause"> </a><a id="2979" class="CatchallClause Symbol">|</a><a id="2980" class="CatchallClause"> </a><a id="2981" class="CatchallClause Symbol">_</a><a id="2982" class="CatchallClause"> </a><a id="2983" class="CatchallClause Symbol">|</a><a id="2984" class="CatchallClause"> </a><a id="2985" href="Relation.Nullary.html#1682" class="CatchallClause InductiveConstructor">no</a><a id="2987" class="CatchallClause"> </a><a id="2988" href="BitML.Contracts.Validity.html#2988" class="CatchallClause Bound">¬participants-⊆</a><a id="3003" class="CatchallClause"> </a><a id="3004" class="CatchallClause Symbol">|</a><a id="3005" class="CatchallClause"> </a><a id="3006" class="CatchallClause Symbol">_</a> <a id="3008" class="Symbol">=</a> <a id="3010" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="3013" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="3015" href="BitML.Contracts.Validity.html#2988" class="Bound">¬participants-⊆</a> <a id="3031" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3033" href="BitML.Contracts.Validity.html#2233" class="Field">participants-⊆</a>
<a id="3048" class="CatchallClause Symbol">...</a><a id="3051" class="CatchallClause"> </a><a id="3052" class="CatchallClause Symbol">|</a><a id="3053" class="CatchallClause"> </a><a id="3054" class="CatchallClause Symbol">_</a><a id="3055" class="CatchallClause"> </a><a id="3056" class="CatchallClause Symbol">|</a><a id="3057" class="CatchallClause"> </a><a id="3058" class="CatchallClause Symbol">_</a><a id="3059" class="CatchallClause"> </a><a id="3060" class="CatchallClause Symbol">|</a><a id="3061" class="CatchallClause"> </a><a id="3062" class="CatchallClause Symbol">_</a><a id="3063" class="CatchallClause"> </a><a id="3064" class="CatchallClause Symbol">|</a><a id="3065" class="CatchallClause"> </a><a id="3066" class="CatchallClause Symbol">_</a><a id="3067" class="CatchallClause"> </a><a id="3068" class="CatchallClause Symbol">|</a><a id="3069" class="CatchallClause"> </a><a id="3070" href="Relation.Nullary.html#1682" class="CatchallClause InductiveConstructor">no</a><a id="3072" class="CatchallClause"> </a><a id="3073" href="BitML.Contracts.Validity.html#3073" class="CatchallClause Bound">¬splits-OK</a>      <a id="3089" class="Symbol">=</a> <a id="3091" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="3094" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="3096" href="BitML.Contracts.Validity.html#3073" class="Bound">¬splits-OK</a> <a id="3107" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3109" href="BitML.Contracts.Validity.html#2370" class="Field">splits-OK</a>
<a id="3119" class="Symbol">...</a> <a id="3123" class="Symbol">|</a> <a id="3125" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="3129" href="BitML.Contracts.Validity.html#3129" class="Bound">p₁</a> <a id="3132" class="Symbol">|</a> <a id="3134" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="3138" href="BitML.Contracts.Validity.html#3138" class="Bound">p₂</a> <a id="3141" class="Symbol">|</a> <a id="3143" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="3147" href="BitML.Contracts.Validity.html#3147" class="Bound">p₃</a> <a id="3150" class="Symbol">|</a> <a id="3152" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="3156" href="BitML.Contracts.Validity.html#3156" class="Bound">p₄</a> <a id="3159" class="Symbol">|</a> <a id="3161" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="3165" href="BitML.Contracts.Validity.html#3165" class="Bound">p₅</a> <a id="3168" class="Symbol">=</a> <a id="3170" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="3174" class="Keyword">record</a>
  <a id="3183" class="Symbol">{</a> <a id="3185" href="BitML.Contracts.Validity.html#1857" class="Field">names-uniq</a> <a id="3196" class="Symbol">=</a> <a id="3198" href="BitML.Contracts.Validity.html#3129" class="Bound">p₁</a>
  <a id="3203" class="Symbol">;</a> <a id="3205" href="BitML.Contracts.Validity.html#1937" class="Field">names-⊆</a> <a id="3213" class="Symbol">=</a> <a id="3215" href="BitML.Contracts.Validity.html#3138" class="Bound">p₂</a>
  <a id="3220" class="Symbol">;</a> <a id="3222" href="BitML.Contracts.Validity.html#2079" class="Field">names-put</a> <a id="3232" class="Symbol">=</a> <a id="3234" href="BitML.Contracts.Validity.html#3147" class="Bound">p₃</a>
  <a id="3239" class="Symbol">;</a> <a id="3241" href="BitML.Contracts.Validity.html#2233" class="Field">participants-⊆</a> <a id="3256" class="Symbol">=</a> <a id="3258" href="BitML.Contracts.Validity.html#3156" class="Bound">p₄</a>
  <a id="3263" class="Symbol">;</a> <a id="3265" href="BitML.Contracts.Validity.html#2370" class="Field">splits-OK</a> <a id="3275" class="Symbol">=</a> <a id="3277" href="BitML.Contracts.Validity.html#3165" class="Bound">p₅</a>
  <a id="3282" class="Symbol">}</a>
</pre></body></html>