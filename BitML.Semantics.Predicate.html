<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>BitML.Semantics.Predicate</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-bitml/tree/master/BitML/Semantics/Predicate.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Denotational semantics of predicates.</a>
<a id="115" class="Comment">------------------------------------------------------------------------</a>
<a id="188" class="Keyword">open</a> <a id="193" class="Keyword">import</a> <a id="200" href="Prelude.Init.html" class="Module">Prelude.Init</a> <a id="213" class="Keyword">hiding</a> <a id="220" class="Symbol">(</a><a id="221" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">_+_</a><a id="224" class="Symbol">)</a>
<a id="226" class="Keyword">open</a> <a id="231" href="Prelude.Init.html#504" class="Module">SetAsType</a>
<a id="241" class="Keyword">open</a> <a id="246" href="Prelude.Init.html#3642" class="Module">Integer</a> <a id="254" class="Keyword">using</a> <a id="260" class="Symbol">(</a><a id="261" href="Data.Integer.Base.html#4853" class="Function Operator">_+_</a><a id="264" class="Symbol">;</a> <a id="266" href="Data.Integer.Base.html#5032" class="Function Operator">_-_</a><a id="269" class="Symbol">;</a> <a id="271" href="Data.Integer.Properties.html#9376" class="Function Operator">_&lt;?_</a><a id="275" class="Symbol">)</a>
<a id="277" class="Keyword">open</a> <a id="282" class="Keyword">import</a> <a id="289" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="303" class="Keyword">open</a> <a id="308" class="Keyword">import</a> <a id="315" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="329" class="Keyword">open</a> <a id="334" class="Keyword">import</a> <a id="341" href="Prelude.Applicative.html" class="Module">Prelude.Applicative</a>
<a id="361" class="Keyword">open</a> <a id="366" class="Keyword">import</a> <a id="373" href="Prelude.Monad.html" class="Module">Prelude.Monad</a>

<a id="388" class="Keyword">open</a> <a id="393" class="Keyword">import</a> <a id="400" href="BitML.BasicTypes.html" class="Module">BitML.BasicTypes</a>
<a id="417" class="Keyword">open</a> <a id="422" class="Keyword">import</a> <a id="429" href="BitML.Predicate.html" class="Module">BitML.Predicate</a>

<a id="446" class="Keyword">module</a> <a id="453" href="BitML.Semantics.Predicate.html" class="Module">BitML.Semantics.Predicate</a> <a id="479" class="Symbol">(</a><a id="480" href="BitML.Semantics.Predicate.html#480" class="Bound">⋯</a> <a id="482" class="Symbol">:</a> <a id="484" href="BitML.BasicTypes.html#631" class="Record">⋯</a><a id="485" class="Symbol">)</a> <a id="487" class="Symbol">(</a><a id="488" class="Keyword">let</a> <a id="492" class="Keyword">open</a> <a id="497" href="BitML.BasicTypes.html#631" class="Module">⋯</a> <a id="499" href="BitML.Semantics.Predicate.html#480" class="Bound">⋯</a><a id="500" class="Symbol">)</a> <a id="502" class="Keyword">where</a>

<a id="509" class="Keyword">open</a> <a id="514" class="Keyword">import</a> <a id="521" href="BitML.Semantics.Configurations.Types.html" class="Module">BitML.Semantics.Configurations.Types</a> <a id="558" href="BitML.Semantics.Predicate.html#480" class="Bound">⋯</a> <a id="560" class="Keyword">hiding</a> <a id="567" class="Symbol">(</a><a id="568" href="BitML.Semantics.Configurations.Types.html#572" class="InductiveConstructor Operator">`_</a><a id="570" class="Symbol">)</a>

<a id="573" class="Keyword">infix</a> <a id="579" class="Number">4</a> <a id="581" href="BitML.Semantics.Predicate.html#587" class="Function Operator">_&lt;?ᵇ_</a>
<a id="_&lt;?ᵇ_"></a><a id="587" href="BitML.Semantics.Predicate.html#587" class="Function Operator">_&lt;?ᵇ_</a> <a id="593" class="Symbol">:</a> <a id="595" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a> <a id="597" class="Symbol">→</a> <a id="599" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a> <a id="601" class="Symbol">→</a> <a id="603" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="608" href="BitML.Semantics.Predicate.html#608" class="Bound">x</a> <a id="610" href="BitML.Semantics.Predicate.html#587" class="Function Operator">&lt;?ᵇ</a> <a id="614" href="BitML.Semantics.Predicate.html#614" class="Bound">y</a> <a id="616" class="Symbol">=</a> <a id="618" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊</a> <a id="620" href="BitML.Semantics.Predicate.html#608" class="Bound">x</a> <a id="622" href="Data.Integer.Properties.html#9376" class="Function Operator">&lt;?</a> <a id="625" href="BitML.Semantics.Predicate.html#614" class="Bound">y</a> <a id="627" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌋</a>

<a id="lookupSecretLen"></a><a id="630" href="BitML.Semantics.Predicate.html#630" class="Function">lookupSecretLen</a> <a id="646" class="Symbol">:</a> <a id="648" href="BitML.BasicTypes.html#303" class="Function">Secret</a> <a id="655" class="Symbol">→</a> <a id="657" href="BitML.Semantics.Configurations.Types.html#482" class="Datatype">Configuration</a> <a id="671" class="Symbol">→</a> <a id="673" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="679" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a>
<a id="681" href="BitML.Semantics.Predicate.html#630" class="Function">lookupSecretLen</a> <a id="697" href="BitML.Semantics.Predicate.html#697" class="Bound">a</a> <a id="699" class="Symbol">(_</a> <a id="702" href="BitML.Semantics.Configurations.Types.html#1049" class="InductiveConstructor Operator">∶</a> <a id="704" href="BitML.Semantics.Predicate.html#704" class="Bound">a′</a> <a id="707" href="BitML.Semantics.Configurations.Types.html#1049" class="InductiveConstructor Operator">♯</a> <a id="709" href="BitML.Semantics.Predicate.html#709" class="Bound">N</a><a id="710" class="Symbol">)</a> <a id="712" class="Symbol">=</a> <a id="714" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="717" href="BitML.Semantics.Predicate.html#697" class="Bound">a</a> <a id="719" href="Prelude.DecEq.Core.html#222" class="Function Operator">==</a> <a id="722" href="BitML.Semantics.Predicate.html#704" class="Bound">a′</a> <a id="725" href="Data.Bool.Base.html#1292" class="Function Operator">then</a> <a id="730" class="Symbol">⦇</a> <a id="732" class="Symbol">(</a><a id="733" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="735" href="BitML.Semantics.Predicate.html#709" class="Bound">N</a><a id="736" class="Symbol">)</a> <a id="738" class="Symbol">⦈</a> <a id="740" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="745" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>
<a id="753" href="BitML.Semantics.Predicate.html#630" class="Function">lookupSecretLen</a> <a id="769" href="BitML.Semantics.Predicate.html#769" class="Bound">a</a> <a id="771" class="Symbol">(</a><a id="772" href="BitML.Semantics.Predicate.html#772" class="Bound">l</a> <a id="774" href="BitML.Semantics.Configurations.Types.html#1145" class="InductiveConstructor Operator">∣</a> <a id="776" href="BitML.Semantics.Predicate.html#776" class="Bound">r</a><a id="777" class="Symbol">)</a>      <a id="784" class="Symbol">=</a> <a id="786" href="BitML.Semantics.Predicate.html#630" class="Function">lookupSecretLen</a> <a id="802" href="BitML.Semantics.Predicate.html#769" class="Bound">a</a> <a id="804" href="BitML.Semantics.Predicate.html#772" class="Bound">l</a> <a id="806" href="Prelude.Applicative.html#2951" class="Field Operator">&lt;|&gt;</a> <a id="810" href="BitML.Semantics.Predicate.html#630" class="Function">lookupSecretLen</a> <a id="826" href="BitML.Semantics.Predicate.html#769" class="Bound">a</a> <a id="828" href="BitML.Semantics.Predicate.html#776" class="Bound">r</a>
<a id="830" href="BitML.Semantics.Predicate.html#630" class="CatchallClause Function">lookupSecretLen</a><a id="845" class="CatchallClause"> </a><a id="846" class="CatchallClause Symbol">_</a><a id="847" class="CatchallClause"> </a><a id="848" class="CatchallClause Symbol">_</a>            <a id="861" class="Symbol">=</a> <a id="863" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>

<a id="⟦_⟧ᵃʳ_"></a><a id="872" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟦_⟧ᵃʳ_</a> <a id="879" class="Symbol">:</a> <a id="881" href="BitML.Predicate.html#326" class="Datatype">Arith</a> <a id="887" class="Symbol">→</a> <a id="889" href="BitML.Semantics.Configurations.Types.html#482" class="Datatype">Configuration</a> <a id="903" class="Symbol">→</a> <a id="905" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="911" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a>
<a id="913" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟦</a> <a id="915" href="BitML.Predicate.html#366" class="InductiveConstructor Operator">∣</a> <a id="917" href="BitML.Semantics.Predicate.html#917" class="Bound">a</a> <a id="919" href="BitML.Predicate.html#366" class="InductiveConstructor Operator">∣</a>   <a id="923" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟧ᵃʳ</a> <a id="927" href="BitML.Semantics.Predicate.html#927" class="Bound">Γ</a> <a id="929" class="Symbol">=</a> <a id="931" href="BitML.Semantics.Predicate.html#630" class="Function">lookupSecretLen</a> <a id="947" href="BitML.Semantics.Predicate.html#917" class="Bound">a</a> <a id="949" href="BitML.Semantics.Predicate.html#927" class="Bound">Γ</a>
<a id="951" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟦</a> <a id="953" href="BitML.Predicate.html#347" class="InductiveConstructor">`</a> <a id="955" href="BitML.Semantics.Predicate.html#955" class="Bound">x</a>     <a id="961" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟧ᵃʳ</a> <a id="965" class="Symbol">_</a> <a id="967" class="Symbol">=</a> <a id="969" class="Symbol">⦇</a> <a id="971" href="BitML.Semantics.Predicate.html#955" class="Bound">x</a> <a id="973" class="Symbol">⦈</a>
<a id="975" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟦</a> <a id="977" href="BitML.Semantics.Predicate.html#977" class="Bound">e</a> <a id="979" href="BitML.Predicate.html#390" class="InductiveConstructor Operator">`+</a> <a id="982" href="BitML.Semantics.Predicate.html#982" class="Bound">e′</a> <a id="985" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟧ᵃʳ</a> <a id="989" href="BitML.Semantics.Predicate.html#989" class="Bound">Γ</a> <a id="991" class="Symbol">=</a> <a id="993" class="Symbol">⦇</a> <a id="995" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟦</a> <a id="997" href="BitML.Semantics.Predicate.html#977" class="Bound">e</a> <a id="999" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟧ᵃʳ</a> <a id="1003" href="BitML.Semantics.Predicate.html#989" class="Bound">Γ</a> <a id="1005" href="Data.Integer.Base.html#4853" class="Function Operator">+</a> <a id="1007" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟦</a> <a id="1009" href="BitML.Semantics.Predicate.html#982" class="Bound">e′</a> <a id="1012" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟧ᵃʳ</a> <a id="1016" href="BitML.Semantics.Predicate.html#989" class="Bound">Γ</a> <a id="1018" class="Symbol">⦈</a>
<a id="1020" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟦</a> <a id="1022" href="BitML.Semantics.Predicate.html#1022" class="Bound">e</a> <a id="1024" href="BitML.Predicate.html#421" class="InductiveConstructor Operator">`-</a> <a id="1027" href="BitML.Semantics.Predicate.html#1027" class="Bound">e′</a> <a id="1030" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟧ᵃʳ</a> <a id="1034" href="BitML.Semantics.Predicate.html#1034" class="Bound">Γ</a> <a id="1036" class="Symbol">=</a> <a id="1038" class="Symbol">⦇</a> <a id="1040" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟦</a> <a id="1042" href="BitML.Semantics.Predicate.html#1022" class="Bound">e</a> <a id="1044" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟧ᵃʳ</a> <a id="1048" href="BitML.Semantics.Predicate.html#1034" class="Bound">Γ</a> <a id="1050" href="Data.Integer.Base.html#5032" class="Function Operator">-</a> <a id="1052" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟦</a> <a id="1054" href="BitML.Semantics.Predicate.html#1027" class="Bound">e′</a> <a id="1057" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟧ᵃʳ</a> <a id="1061" href="BitML.Semantics.Predicate.html#1034" class="Bound">Γ</a> <a id="1063" class="Symbol">⦈</a>


<a id="⟦_⟧_"></a><a id="1067" href="BitML.Semantics.Predicate.html#1067" class="Function Operator">⟦_⟧_</a> <a id="1072" class="Symbol">:</a> <a id="1074" href="BitML.Predicate.html#517" class="Datatype">Predicate</a> <a id="1084" class="Symbol">→</a> <a id="1086" href="BitML.Semantics.Configurations.Types.html#482" class="Datatype">Configuration</a> <a id="1100" class="Symbol">→</a> <a id="1102" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="1108" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="1113" href="BitML.Semantics.Predicate.html#1067" class="Function Operator">⟦</a> <a id="1115" href="BitML.Predicate.html#542" class="InductiveConstructor">`true</a>   <a id="1123" href="BitML.Semantics.Predicate.html#1067" class="Function Operator">⟧</a> <a id="1125" href="BitML.Semantics.Predicate.html#1125" class="Bound">Γ</a> <a id="1127" class="Symbol">=</a> <a id="1129" class="Symbol">⦇</a> <a id="1131" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a> <a id="1136" class="Symbol">⦈</a>
<a id="1138" href="BitML.Semantics.Predicate.html#1067" class="Function Operator">⟦</a> <a id="1140" href="BitML.Semantics.Predicate.html#1140" class="Bound">e</a> <a id="1142" href="BitML.Predicate.html#562" class="InductiveConstructor Operator">`∧</a> <a id="1145" href="BitML.Semantics.Predicate.html#1145" class="Bound">e′</a> <a id="1148" href="BitML.Semantics.Predicate.html#1067" class="Function Operator">⟧</a> <a id="1150" href="BitML.Semantics.Predicate.html#1150" class="Bound">Γ</a> <a id="1152" class="Symbol">=</a> <a id="1154" class="Symbol">⦇</a> <a id="1156" href="BitML.Semantics.Predicate.html#1067" class="Function Operator">⟦</a> <a id="1158" href="BitML.Semantics.Predicate.html#1140" class="Bound">e</a> <a id="1160" href="BitML.Semantics.Predicate.html#1067" class="Function Operator">⟧</a> <a id="1162" href="BitML.Semantics.Predicate.html#1150" class="Bound">Γ</a> <a id="1164" href="Data.Bool.Base.html#995" class="Function Operator">∧</a> <a id="1166" href="BitML.Semantics.Predicate.html#1067" class="Function Operator">⟦</a> <a id="1168" href="BitML.Semantics.Predicate.html#1145" class="Bound">e′</a> <a id="1171" href="BitML.Semantics.Predicate.html#1067" class="Function Operator">⟧</a> <a id="1173" href="BitML.Semantics.Predicate.html#1150" class="Bound">Γ</a> <a id="1175" class="Symbol">⦈</a>
<a id="1177" href="BitML.Semantics.Predicate.html#1067" class="Function Operator">⟦</a> <a id="1179" href="BitML.Predicate.html#606" class="InductiveConstructor Operator">`¬</a> <a id="1182" href="BitML.Semantics.Predicate.html#1182" class="Bound">e</a>    <a id="1187" href="BitML.Semantics.Predicate.html#1067" class="Function Operator">⟧</a> <a id="1189" href="BitML.Semantics.Predicate.html#1189" class="Bound">Γ</a> <a id="1191" class="Symbol">=</a> <a id="1193" class="Symbol">⦇</a> <a id="1195" href="Data.Bool.Base.html#941" class="Function">not</a> <a id="1199" class="Symbol">(</a><a id="1200" href="BitML.Semantics.Predicate.html#1067" class="Function Operator">⟦</a> <a id="1202" href="BitML.Semantics.Predicate.html#1182" class="Bound">e</a> <a id="1204" href="BitML.Semantics.Predicate.html#1067" class="Function Operator">⟧</a> <a id="1206" href="BitML.Semantics.Predicate.html#1189" class="Bound">Γ</a><a id="1207" class="Symbol">)</a> <a id="1209" class="Symbol">⦈</a>
<a id="1211" href="BitML.Semantics.Predicate.html#1067" class="Function Operator">⟦</a> <a id="1213" href="BitML.Semantics.Predicate.html#1213" class="Bound">e</a> <a id="1215" href="BitML.Predicate.html#638" class="InductiveConstructor Operator">`=</a> <a id="1218" href="BitML.Semantics.Predicate.html#1218" class="Bound">e′</a> <a id="1221" href="BitML.Semantics.Predicate.html#1067" class="Function Operator">⟧</a> <a id="1223" href="BitML.Semantics.Predicate.html#1223" class="Bound">Γ</a> <a id="1225" class="Symbol">=</a> <a id="1227" class="Symbol">⦇</a> <a id="1229" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟦</a> <a id="1231" href="BitML.Semantics.Predicate.html#1213" class="Bound">e</a> <a id="1233" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟧ᵃʳ</a> <a id="1237" href="BitML.Semantics.Predicate.html#1223" class="Bound">Γ</a> <a id="1239" href="Prelude.DecEq.Core.html#222" class="Function Operator">==</a> <a id="1242" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟦</a> <a id="1244" href="BitML.Semantics.Predicate.html#1218" class="Bound">e′</a> <a id="1247" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟧ᵃʳ</a> <a id="1251" href="BitML.Semantics.Predicate.html#1223" class="Bound">Γ</a> <a id="1253" class="Symbol">⦈</a>
<a id="1255" href="BitML.Semantics.Predicate.html#1067" class="Function Operator">⟦</a> <a id="1257" href="BitML.Semantics.Predicate.html#1257" class="Bound">e</a> <a id="1259" href="BitML.Predicate.html#674" class="InductiveConstructor Operator">`&lt;</a> <a id="1262" href="BitML.Semantics.Predicate.html#1262" class="Bound">e′</a> <a id="1265" href="BitML.Semantics.Predicate.html#1067" class="Function Operator">⟧</a> <a id="1267" href="BitML.Semantics.Predicate.html#1267" class="Bound">Γ</a> <a id="1269" class="Symbol">=</a> <a id="1271" class="Symbol">⦇</a> <a id="1273" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟦</a> <a id="1275" href="BitML.Semantics.Predicate.html#1257" class="Bound">e</a> <a id="1277" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟧ᵃʳ</a> <a id="1281" href="BitML.Semantics.Predicate.html#1267" class="Bound">Γ</a> <a id="1283" href="BitML.Semantics.Predicate.html#587" class="Function Operator">&lt;?ᵇ</a> <a id="1287" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟦</a> <a id="1289" href="BitML.Semantics.Predicate.html#1262" class="Bound">e′</a> <a id="1292" href="BitML.Semantics.Predicate.html#872" class="Function Operator">⟧ᵃʳ</a> <a id="1296" href="BitML.Semantics.Predicate.html#1267" class="Bound">Γ</a> <a id="1298" class="Symbol">⦈</a>
</pre></body></html>