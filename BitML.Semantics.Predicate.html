<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>BitML.Semantics.Predicate</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Denotational semantics of predicates.</a>
<a id="115" class="Comment">------------------------------------------------------------------------</a>
<a id="188" class="Keyword">open</a> <a id="193" class="Keyword">import</a> <a id="200" href="Prelude.Init.html" class="Module">Prelude.Init</a> <a id="213" class="Keyword">hiding</a> <a id="220" class="Symbol">(</a><a id="221" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a><a id="224" class="Symbol">;</a> <a id="226" href="Data.Nat.Properties.html#8905" class="Function Operator">_&lt;?_</a><a id="230" class="Symbol">)</a>
<a id="232" class="Keyword">open</a> <a id="237" href="Prelude.Init.html#2080" class="Module">Integer</a> <a id="245" class="Keyword">using</a> <a id="251" class="Symbol">(</a><a id="252" href="Data.Integer.Base.html#3035" class="Function Operator">_+_</a><a id="255" class="Symbol">;</a> <a id="257" href="Data.Integer.Base.html#3214" class="Function Operator">_-_</a><a id="260" class="Symbol">;</a> <a id="262" href="Data.Integer.Properties.html#7702" class="Function Operator">_&lt;?_</a><a id="266" class="Symbol">)</a>
<a id="268" class="Keyword">open</a> <a id="273" class="Keyword">import</a> <a id="280" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="294" class="Keyword">open</a> <a id="299" class="Keyword">import</a> <a id="306" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="320" class="Keyword">open</a> <a id="325" class="Keyword">import</a> <a id="332" href="Prelude.Applicative.html" class="Module">Prelude.Applicative</a>
<a id="352" class="Keyword">open</a> <a id="357" class="Keyword">import</a> <a id="364" href="Prelude.Monad.html" class="Module">Prelude.Monad</a>

<a id="379" class="Keyword">open</a> <a id="384" class="Keyword">import</a> <a id="391" href="BitML.BasicTypes.html" class="Module">BitML.BasicTypes</a>
<a id="408" class="Keyword">open</a> <a id="413" class="Keyword">import</a> <a id="420" href="BitML.Predicate.html" class="Module">BitML.Predicate</a>

<a id="437" class="Keyword">module</a> <a id="444" href="BitML.Semantics.Predicate.html" class="Module">BitML.Semantics.Predicate</a>
  <a id="472" class="Symbol">(</a><a id="473" href="BitML.Semantics.Predicate.html#473" class="Bound">Participant</a> <a id="485" class="Symbol">:</a> <a id="487" class="PrimitiveType">Set</a><a id="490" class="Symbol">)</a>
  <a id="494" class="Symbol">⦃</a> <a id="496" href="BitML.Semantics.Predicate.html#496" class="Bound">_</a> <a id="498" class="Symbol">:</a> <a id="500" href="Prelude.DecEq.html#581" class="Record">DecEq</a> <a id="506" href="BitML.Semantics.Predicate.html#473" class="Bound">Participant</a> <a id="518" class="Symbol">⦄</a>
  <a id="522" class="Symbol">(</a><a id="523" href="BitML.Semantics.Predicate.html#523" class="Bound">Honest</a> <a id="530" class="Symbol">:</a> <a id="532" href="Data.List.NonEmpty.html#1318" class="Record">List⁺</a> <a id="538" href="BitML.Semantics.Predicate.html#473" class="Bound">Participant</a><a id="549" class="Symbol">)</a>
  <a id="553" class="Keyword">where</a>

<a id="560" class="Keyword">open</a> <a id="565" class="Keyword">import</a> <a id="572" href="BitML.Semantics.Configurations.Types.html" class="Module">BitML.Semantics.Configurations.Types</a> <a id="609" href="BitML.Semantics.Predicate.html#473" class="Bound">Participant</a> <a id="621" href="BitML.Semantics.Predicate.html#523" class="Bound">Honest</a> <a id="628" class="Keyword">hiding</a> <a id="635" class="Symbol">(</a>`_<a id="638" class="Symbol">)</a>

<a id="641" class="Keyword">infix</a> <a id="647" class="Number">4</a> <a id="649" href="BitML.Semantics.Predicate.html#655" class="Function Operator">_&lt;?ᵇ_</a>
<a id="_&lt;?ᵇ_"></a><a id="655" href="BitML.Semantics.Predicate.html#655" class="Function Operator">_&lt;?ᵇ_</a> <a id="661" class="Symbol">:</a> <a id="663" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="665" class="Symbol">→</a> <a id="667" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="669" class="Symbol">→</a> <a id="671" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="676" href="BitML.Semantics.Predicate.html#676" class="Bound">x</a> <a id="678" href="BitML.Semantics.Predicate.html#655" class="Function Operator">&lt;?ᵇ</a> <a id="682" href="BitML.Semantics.Predicate.html#682" class="Bound">y</a> <a id="684" class="Symbol">=</a> <a id="686" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="688" href="BitML.Semantics.Predicate.html#676" class="Bound">x</a> <a id="690" href="Data.Integer.Properties.html#7702" class="Function Operator">&lt;?</a> <a id="693" href="BitML.Semantics.Predicate.html#682" class="Bound">y</a> <a id="695" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a>

<a id="lookupSecretLen"></a><a id="698" href="BitML.Semantics.Predicate.html#698" class="Function">lookupSecretLen</a> <a id="714" class="Symbol">:</a> <a id="716" href="BitML.BasicTypes.html#261" class="Function">Secret</a> <a id="723" class="Symbol">→</a> <a id="725" href="BitML.Semantics.Configurations.Types.html#640" class="Datatype">Configuration</a> <a id="739" class="Symbol">→</a> <a id="741" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="747" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>
<a id="749" href="BitML.Semantics.Predicate.html#698" class="Function">lookupSecretLen</a> <a id="765" href="BitML.Semantics.Predicate.html#765" class="Bound">a</a> <a id="767" class="Symbol">(_</a> <a id="770" href="BitML.Semantics.Configurations.Types.html#1134" class="InductiveConstructor Operator">∶</a> <a id="772" href="BitML.Semantics.Predicate.html#772" class="Bound">a′</a> <a id="775" href="BitML.Semantics.Configurations.Types.html#1134" class="InductiveConstructor Operator">♯</a> <a id="777" href="BitML.Semantics.Predicate.html#777" class="Bound">N</a><a id="778" class="Symbol">)</a> <a id="780" class="Symbol">=</a> <a id="782" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="785" href="BitML.Semantics.Predicate.html#765" class="Bound">a</a> <a id="787" href="Prelude.DecEq.html#661" class="Function Operator">==</a> <a id="790" href="BitML.Semantics.Predicate.html#772" class="Bound">a′</a> <a id="793" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="798" class="Symbol">⦇</a> <a id="800" class="Symbol">(</a><a id="801" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">+</a> <a id="803" href="BitML.Semantics.Predicate.html#777" class="Bound">N</a><a id="804" class="Symbol">)</a> <a id="806" class="Symbol">⦈</a> <a id="808" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="813" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>
<a id="821" href="BitML.Semantics.Predicate.html#698" class="Function">lookupSecretLen</a> <a id="837" href="BitML.Semantics.Predicate.html#837" class="Bound">a</a> <a id="839" class="Symbol">(</a><a id="840" href="BitML.Semantics.Predicate.html#840" class="Bound">l</a> <a id="842" href="BitML.Semantics.Configurations.Types.html#1212" class="InductiveConstructor Operator">∣</a> <a id="844" href="BitML.Semantics.Predicate.html#844" class="Bound">r</a><a id="845" class="Symbol">)</a>      <a id="852" class="Symbol">=</a> <a id="854" href="BitML.Semantics.Predicate.html#698" class="Function">lookupSecretLen</a> <a id="870" href="BitML.Semantics.Predicate.html#837" class="Bound">a</a> <a id="872" href="BitML.Semantics.Predicate.html#840" class="Bound">l</a> <a id="874" href="Prelude.Applicative.html#1489" class="Field Operator">&lt;|&gt;</a> <a id="878" href="BitML.Semantics.Predicate.html#698" class="Function">lookupSecretLen</a> <a id="894" href="BitML.Semantics.Predicate.html#837" class="Bound">a</a> <a id="896" href="BitML.Semantics.Predicate.html#844" class="Bound">r</a>
<a id="898" href="BitML.Semantics.Predicate.html#698" class="CatchallClause Function">lookupSecretLen</a><a id="913" class="CatchallClause"> </a><a id="914" class="CatchallClause Symbol">_</a><a id="915" class="CatchallClause"> </a><a id="916" class="CatchallClause Symbol">_</a>            <a id="929" class="Symbol">=</a> <a id="931" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>

<a id="⟦_⟧ᵃʳ_"></a><a id="940" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟦_⟧ᵃʳ_</a> <a id="947" class="Symbol">:</a> <a id="949" href="BitML.Predicate.html#492" class="Datatype">Arith</a> <a id="955" class="Symbol">→</a> <a id="957" href="BitML.Semantics.Configurations.Types.html#640" class="Datatype">Configuration</a> <a id="971" class="Symbol">→</a> <a id="973" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="979" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>
<a id="981" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟦</a> <a id="983" href="BitML.Predicate.html#531" class="InductiveConstructor Operator">∣</a> <a id="985" href="BitML.Semantics.Predicate.html#985" class="Bound">a</a> <a id="987" href="BitML.Predicate.html#531" class="InductiveConstructor Operator">∣</a>   <a id="991" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟧ᵃʳ</a> <a id="995" href="BitML.Semantics.Predicate.html#995" class="Bound">Γ</a> <a id="997" class="Symbol">=</a> <a id="999" href="BitML.Semantics.Predicate.html#698" class="Function">lookupSecretLen</a> <a id="1015" href="BitML.Semantics.Predicate.html#985" class="Bound">a</a> <a id="1017" href="BitML.Semantics.Predicate.html#995" class="Bound">Γ</a>
<a id="1019" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟦</a> <a id="1021" href="BitML.Predicate.html#512" class="InductiveConstructor">`</a> <a id="1023" href="BitML.Semantics.Predicate.html#1023" class="Bound">x</a>     <a id="1029" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟧ᵃʳ</a> <a id="1033" class="Symbol">_</a> <a id="1035" class="Symbol">=</a> <a id="1037" class="Symbol">⦇</a> <a id="1039" href="BitML.Semantics.Predicate.html#1023" class="Bound">x</a> <a id="1041" class="Symbol">⦈</a>
<a id="1043" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟦</a> <a id="1045" href="BitML.Semantics.Predicate.html#1045" class="Bound">e</a> <a id="1047" href="BitML.Predicate.html#555" class="InductiveConstructor Operator">`+</a> <a id="1050" href="BitML.Semantics.Predicate.html#1050" class="Bound">e′</a> <a id="1053" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟧ᵃʳ</a> <a id="1057" href="BitML.Semantics.Predicate.html#1057" class="Bound">Γ</a> <a id="1059" class="Symbol">=</a> <a id="1061" class="Symbol">⦇</a> <a id="1063" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟦</a> <a id="1065" href="BitML.Semantics.Predicate.html#1045" class="Bound">e</a> <a id="1067" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟧ᵃʳ</a> <a id="1071" href="BitML.Semantics.Predicate.html#1057" class="Bound">Γ</a> <a id="1073" href="Data.Integer.Base.html#3035" class="Function Operator">+</a> <a id="1075" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟦</a> <a id="1077" href="BitML.Semantics.Predicate.html#1050" class="Bound">e′</a> <a id="1080" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟧ᵃʳ</a> <a id="1084" href="BitML.Semantics.Predicate.html#1057" class="Bound">Γ</a> <a id="1086" class="Symbol">⦈</a>
<a id="1088" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟦</a> <a id="1090" href="BitML.Semantics.Predicate.html#1090" class="Bound">e</a> <a id="1092" href="BitML.Predicate.html#586" class="InductiveConstructor Operator">`-</a> <a id="1095" href="BitML.Semantics.Predicate.html#1095" class="Bound">e′</a> <a id="1098" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟧ᵃʳ</a> <a id="1102" href="BitML.Semantics.Predicate.html#1102" class="Bound">Γ</a> <a id="1104" class="Symbol">=</a> <a id="1106" class="Symbol">⦇</a> <a id="1108" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟦</a> <a id="1110" href="BitML.Semantics.Predicate.html#1090" class="Bound">e</a> <a id="1112" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟧ᵃʳ</a> <a id="1116" href="BitML.Semantics.Predicate.html#1102" class="Bound">Γ</a> <a id="1118" href="Data.Integer.Base.html#3214" class="Function Operator">-</a> <a id="1120" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟦</a> <a id="1122" href="BitML.Semantics.Predicate.html#1095" class="Bound">e′</a> <a id="1125" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟧ᵃʳ</a> <a id="1129" href="BitML.Semantics.Predicate.html#1102" class="Bound">Γ</a> <a id="1131" class="Symbol">⦈</a>


<a id="⟦_⟧_"></a><a id="1135" href="BitML.Semantics.Predicate.html#1135" class="Function Operator">⟦_⟧_</a> <a id="1140" class="Symbol">:</a> <a id="1142" href="BitML.Predicate.html#682" class="Datatype">Predicate</a> <a id="1152" class="Symbol">→</a> <a id="1154" href="BitML.Semantics.Configurations.Types.html#640" class="Datatype">Configuration</a> <a id="1168" class="Symbol">→</a> <a id="1170" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="1176" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1181" href="BitML.Semantics.Predicate.html#1135" class="Function Operator">⟦</a> <a id="1183" href="BitML.Predicate.html#706" class="InductiveConstructor">`true</a>   <a id="1191" href="BitML.Semantics.Predicate.html#1135" class="Function Operator">⟧</a> <a id="1193" href="BitML.Semantics.Predicate.html#1193" class="Bound">Γ</a> <a id="1195" class="Symbol">=</a> <a id="1197" class="Symbol">⦇</a> <a id="1199" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="1204" class="Symbol">⦈</a>
<a id="1206" href="BitML.Semantics.Predicate.html#1135" class="Function Operator">⟦</a> <a id="1208" href="BitML.Semantics.Predicate.html#1208" class="Bound">e</a> <a id="1210" href="BitML.Predicate.html#726" class="InductiveConstructor Operator">`∧</a> <a id="1213" href="BitML.Semantics.Predicate.html#1213" class="Bound">e′</a> <a id="1216" href="BitML.Semantics.Predicate.html#1135" class="Function Operator">⟧</a> <a id="1218" href="BitML.Semantics.Predicate.html#1218" class="Bound">Γ</a> <a id="1220" class="Symbol">=</a> <a id="1222" class="Symbol">⦇</a> <a id="1224" href="BitML.Semantics.Predicate.html#1135" class="Function Operator">⟦</a> <a id="1226" href="BitML.Semantics.Predicate.html#1208" class="Bound">e</a> <a id="1228" href="BitML.Semantics.Predicate.html#1135" class="Function Operator">⟧</a> <a id="1230" href="BitML.Semantics.Predicate.html#1218" class="Bound">Γ</a> <a id="1232" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="1234" href="BitML.Semantics.Predicate.html#1135" class="Function Operator">⟦</a> <a id="1236" href="BitML.Semantics.Predicate.html#1213" class="Bound">e′</a> <a id="1239" href="BitML.Semantics.Predicate.html#1135" class="Function Operator">⟧</a> <a id="1241" href="BitML.Semantics.Predicate.html#1218" class="Bound">Γ</a> <a id="1243" class="Symbol">⦈</a>
<a id="1245" href="BitML.Semantics.Predicate.html#1135" class="Function Operator">⟦</a> <a id="1247" href="BitML.Predicate.html#770" class="InductiveConstructor Operator">`¬</a> <a id="1250" href="BitML.Semantics.Predicate.html#1250" class="Bound">e</a>    <a id="1255" href="BitML.Semantics.Predicate.html#1135" class="Function Operator">⟧</a> <a id="1257" href="BitML.Semantics.Predicate.html#1257" class="Bound">Γ</a> <a id="1259" class="Symbol">=</a> <a id="1261" class="Symbol">⦇</a> <a id="1263" href="Data.Bool.Base.html#932" class="Function">not</a> <a id="1267" class="Symbol">(</a><a id="1268" href="BitML.Semantics.Predicate.html#1135" class="Function Operator">⟦</a> <a id="1270" href="BitML.Semantics.Predicate.html#1250" class="Bound">e</a> <a id="1272" href="BitML.Semantics.Predicate.html#1135" class="Function Operator">⟧</a> <a id="1274" href="BitML.Semantics.Predicate.html#1257" class="Bound">Γ</a><a id="1275" class="Symbol">)</a> <a id="1277" class="Symbol">⦈</a>
<a id="1279" href="BitML.Semantics.Predicate.html#1135" class="Function Operator">⟦</a> <a id="1281" href="BitML.Semantics.Predicate.html#1281" class="Bound">e</a> <a id="1283" href="BitML.Predicate.html#802" class="InductiveConstructor Operator">`=</a> <a id="1286" href="BitML.Semantics.Predicate.html#1286" class="Bound">e′</a> <a id="1289" href="BitML.Semantics.Predicate.html#1135" class="Function Operator">⟧</a> <a id="1291" href="BitML.Semantics.Predicate.html#1291" class="Bound">Γ</a> <a id="1293" class="Symbol">=</a> <a id="1295" class="Symbol">⦇</a> <a id="1297" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟦</a> <a id="1299" href="BitML.Semantics.Predicate.html#1281" class="Bound">e</a> <a id="1301" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟧ᵃʳ</a> <a id="1305" href="BitML.Semantics.Predicate.html#1291" class="Bound">Γ</a> <a id="1307" href="Prelude.DecEq.html#661" class="Function Operator">==</a> <a id="1310" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟦</a> <a id="1312" href="BitML.Semantics.Predicate.html#1286" class="Bound">e′</a> <a id="1315" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟧ᵃʳ</a> <a id="1319" href="BitML.Semantics.Predicate.html#1291" class="Bound">Γ</a> <a id="1321" class="Symbol">⦈</a>
<a id="1323" href="BitML.Semantics.Predicate.html#1135" class="Function Operator">⟦</a> <a id="1325" href="BitML.Semantics.Predicate.html#1325" class="Bound">e</a> <a id="1327" href="BitML.Predicate.html#838" class="InductiveConstructor Operator">`&lt;</a> <a id="1330" href="BitML.Semantics.Predicate.html#1330" class="Bound">e′</a> <a id="1333" href="BitML.Semantics.Predicate.html#1135" class="Function Operator">⟧</a> <a id="1335" href="BitML.Semantics.Predicate.html#1335" class="Bound">Γ</a> <a id="1337" class="Symbol">=</a> <a id="1339" class="Symbol">⦇</a> <a id="1341" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟦</a> <a id="1343" href="BitML.Semantics.Predicate.html#1325" class="Bound">e</a> <a id="1345" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟧ᵃʳ</a> <a id="1349" href="BitML.Semantics.Predicate.html#1335" class="Bound">Γ</a> <a id="1351" href="BitML.Semantics.Predicate.html#655" class="Function Operator">&lt;?ᵇ</a> <a id="1355" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟦</a> <a id="1357" href="BitML.Semantics.Predicate.html#1330" class="Bound">e′</a> <a id="1360" href="BitML.Semantics.Predicate.html#940" class="Function Operator">⟧ᵃʳ</a> <a id="1364" href="BitML.Semantics.Predicate.html#1335" class="Bound">Γ</a> <a id="1366" class="Symbol">⦈</a>
</pre></body></html>