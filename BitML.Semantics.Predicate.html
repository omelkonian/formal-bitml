<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>BitML.Semantics.Predicate</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Denotational semantics of predicates.</a>
<a id="115" class="Comment">------------------------------------------------------------------------</a>
<a id="188" class="Keyword">open</a> <a id="193" class="Keyword">import</a> <a id="200" href="Data.Maybe.html" class="Module">Data.Maybe</a>   <a id="213" class="Keyword">using</a> <a id="219" class="Symbol">(</a><a id="220" href="Data.Maybe.Base.html#2354" class="Function Operator">_&lt;∣&gt;_</a><a id="225" class="Symbol">)</a>
<a id="227" class="Keyword">open</a> <a id="232" class="Keyword">import</a> <a id="239" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="252" class="Keyword">using</a> <a id="258" class="Symbol">(</a><a id="259" href="Data.Integer.Base.html#3035" class="Function Operator">_+_</a><a id="262" class="Symbol">;</a> <a id="264" href="Data.Integer.Base.html#3214" class="Function Operator">_-_</a><a id="267" class="Symbol">;</a> <a id="269" href="Data.Integer.Properties.html#7702" class="Function Operator">_&lt;?_</a><a id="273" class="Symbol">)</a>

<a id="276" class="Keyword">open</a> <a id="281" class="Keyword">import</a> <a id="288" href="Prelude.Init.html" class="Module">Prelude.Init</a> <a id="301" class="Keyword">hiding</a> <a id="308" class="Symbol">(</a><a id="309" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a><a id="312" class="Symbol">;</a> <a id="314" href="Data.Nat.Properties.html#8905" class="Function Operator">_&lt;?_</a><a id="318" class="Symbol">)</a>
<a id="320" class="Keyword">open</a> <a id="325" class="Keyword">import</a> <a id="332" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="346" class="Keyword">open</a> <a id="351" class="Keyword">import</a> <a id="358" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="372" class="Keyword">open</a> <a id="377" class="Keyword">import</a> <a id="384" href="Prelude.Monad.html" class="Module">Prelude.Monad</a>

<a id="399" class="Keyword">open</a> <a id="404" class="Keyword">import</a> <a id="411" href="BitML.BasicTypes.html" class="Module">BitML.BasicTypes</a>
<a id="428" class="Keyword">open</a> <a id="433" class="Keyword">import</a> <a id="440" href="BitML.Predicate.html" class="Module">BitML.Predicate</a>

<a id="457" class="Keyword">module</a> <a id="464" href="BitML.Semantics.Predicate.html" class="Module">BitML.Semantics.Predicate</a>
  <a id="492" class="Symbol">(</a><a id="493" href="BitML.Semantics.Predicate.html#493" class="Bound">Participant</a> <a id="505" class="Symbol">:</a> <a id="507" class="PrimitiveType">Set</a><a id="510" class="Symbol">)</a>
  <a id="514" class="Symbol">{{</a><a id="516" href="BitML.Semantics.Predicate.html#516" class="Bound">_</a> <a id="518" class="Symbol">:</a> <a id="520" href="Prelude.DecEq.html#553" class="Record">DecEq</a> <a id="526" href="BitML.Semantics.Predicate.html#493" class="Bound">Participant</a><a id="537" class="Symbol">}}</a>
  <a id="542" class="Symbol">(</a><a id="543" href="BitML.Semantics.Predicate.html#543" class="Bound">Honest</a> <a id="550" class="Symbol">:</a> <a id="552" href="Data.List.NonEmpty.html#1318" class="Record">List⁺</a> <a id="558" href="BitML.Semantics.Predicate.html#493" class="Bound">Participant</a><a id="569" class="Symbol">)</a>
  <a id="573" class="Keyword">where</a>

<a id="580" class="Keyword">open</a> <a id="585" class="Keyword">import</a> <a id="592" href="BitML.Semantics.Configurations.Types.html" class="Module">BitML.Semantics.Configurations.Types</a> <a id="629" href="BitML.Semantics.Predicate.html#493" class="Bound">Participant</a> <a id="641" href="BitML.Semantics.Predicate.html#543" class="Bound">Honest</a> <a id="648" class="Keyword">hiding</a> <a id="655" class="Symbol">(</a>`_<a id="658" class="Symbol">)</a>

<a id="661" class="Keyword">infix</a> <a id="667" class="Number">4</a> <a id="669" href="BitML.Semantics.Predicate.html#675" class="Function Operator">_&lt;?ᵇ_</a>
<a id="_&lt;?ᵇ_"></a><a id="675" href="BitML.Semantics.Predicate.html#675" class="Function Operator">_&lt;?ᵇ_</a> <a id="681" class="Symbol">:</a> <a id="683" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="685" class="Symbol">→</a> <a id="687" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="689" class="Symbol">→</a> <a id="691" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="696" href="BitML.Semantics.Predicate.html#696" class="Bound">x</a> <a id="698" href="BitML.Semantics.Predicate.html#675" class="Function Operator">&lt;?ᵇ</a> <a id="702" href="BitML.Semantics.Predicate.html#702" class="Bound">y</a> <a id="704" class="Symbol">=</a> <a id="706" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="708" href="BitML.Semantics.Predicate.html#696" class="Bound">x</a> <a id="710" href="Data.Integer.Properties.html#7702" class="Function Operator">&lt;?</a> <a id="713" href="BitML.Semantics.Predicate.html#702" class="Bound">y</a> <a id="715" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a>

<a id="lookupSecretLen"></a><a id="718" href="BitML.Semantics.Predicate.html#718" class="Function">lookupSecretLen</a> <a id="734" class="Symbol">:</a> <a id="736" href="BitML.BasicTypes.html#261" class="Function">Secret</a> <a id="743" class="Symbol">→</a> <a id="745" href="BitML.Semantics.Configurations.Types.html#599" class="Datatype">Configuration</a> <a id="759" class="Symbol">→</a> <a id="761" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="767" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>
<a id="769" href="BitML.Semantics.Predicate.html#718" class="Function">lookupSecretLen</a> <a id="785" href="BitML.Semantics.Predicate.html#785" class="Bound">a</a> <a id="787" class="Symbol">(_</a> <a id="790" href="BitML.Semantics.Configurations.Types.html#1093" class="InductiveConstructor Operator">∶</a> <a id="792" href="BitML.Semantics.Predicate.html#792" class="Bound">a′</a> <a id="795" href="BitML.Semantics.Configurations.Types.html#1093" class="InductiveConstructor Operator">♯</a> <a id="797" href="BitML.Semantics.Predicate.html#797" class="Bound">N</a><a id="798" class="Symbol">)</a> <a id="800" class="Symbol">=</a> <a id="802" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="805" href="BitML.Semantics.Predicate.html#785" class="Bound">a</a> <a id="807" href="Prelude.DecEq.html#625" class="Function Operator">==</a> <a id="810" href="BitML.Semantics.Predicate.html#792" class="Bound">a′</a> <a id="813" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="818" class="Symbol">⦇</a> <a id="820" class="Symbol">(</a><a id="821" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">+</a> <a id="823" href="BitML.Semantics.Predicate.html#797" class="Bound">N</a><a id="824" class="Symbol">)</a> <a id="826" class="Symbol">⦈</a> <a id="828" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="833" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>
<a id="841" href="BitML.Semantics.Predicate.html#718" class="Function">lookupSecretLen</a> <a id="857" href="BitML.Semantics.Predicate.html#857" class="Bound">a</a> <a id="859" class="Symbol">(</a><a id="860" href="BitML.Semantics.Predicate.html#860" class="Bound">l</a> <a id="862" href="BitML.Semantics.Configurations.Types.html#1171" class="InductiveConstructor Operator">∣</a> <a id="864" href="BitML.Semantics.Predicate.html#864" class="Bound">r</a><a id="865" class="Symbol">)</a>      <a id="872" class="Symbol">=</a> <a id="874" href="BitML.Semantics.Predicate.html#718" class="Function">lookupSecretLen</a> <a id="890" href="BitML.Semantics.Predicate.html#857" class="Bound">a</a> <a id="892" href="BitML.Semantics.Predicate.html#860" class="Bound">l</a> <a id="894" href="Data.Maybe.Base.html#2354" class="Function Operator">&lt;∣&gt;</a> <a id="898" href="BitML.Semantics.Predicate.html#718" class="Function">lookupSecretLen</a> <a id="914" href="BitML.Semantics.Predicate.html#857" class="Bound">a</a> <a id="916" href="BitML.Semantics.Predicate.html#864" class="Bound">r</a>
<a id="918" href="BitML.Semantics.Predicate.html#718" class="CatchallClause Function">lookupSecretLen</a><a id="933" class="CatchallClause"> </a><a id="934" class="CatchallClause Symbol">_</a><a id="935" class="CatchallClause"> </a><a id="936" class="CatchallClause Symbol">_</a>            <a id="949" class="Symbol">=</a> <a id="951" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>

<a id="⟦_⟧ᵃʳ_"></a><a id="960" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟦_⟧ᵃʳ_</a> <a id="967" class="Symbol">:</a> <a id="969" href="BitML.Predicate.html#492" class="Datatype">Arith</a> <a id="975" class="Symbol">→</a> <a id="977" href="BitML.Semantics.Configurations.Types.html#599" class="Datatype">Configuration</a> <a id="991" class="Symbol">→</a> <a id="993" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="999" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>
<a id="1001" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟦</a> <a id="1003" href="BitML.Predicate.html#531" class="InductiveConstructor Operator">∣</a> <a id="1005" href="BitML.Semantics.Predicate.html#1005" class="Bound">a</a> <a id="1007" href="BitML.Predicate.html#531" class="InductiveConstructor Operator">∣</a>   <a id="1011" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟧ᵃʳ</a> <a id="1015" href="BitML.Semantics.Predicate.html#1015" class="Bound">Γ</a> <a id="1017" class="Symbol">=</a> <a id="1019" href="BitML.Semantics.Predicate.html#718" class="Function">lookupSecretLen</a> <a id="1035" href="BitML.Semantics.Predicate.html#1005" class="Bound">a</a> <a id="1037" href="BitML.Semantics.Predicate.html#1015" class="Bound">Γ</a>
<a id="1039" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟦</a> <a id="1041" href="BitML.Predicate.html#512" class="InductiveConstructor">`</a> <a id="1043" href="BitML.Semantics.Predicate.html#1043" class="Bound">x</a>     <a id="1049" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟧ᵃʳ</a> <a id="1053" class="Symbol">_</a> <a id="1055" class="Symbol">=</a> <a id="1057" class="Symbol">⦇</a> <a id="1059" href="BitML.Semantics.Predicate.html#1043" class="Bound">x</a> <a id="1061" class="Symbol">⦈</a>
<a id="1063" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟦</a> <a id="1065" href="BitML.Semantics.Predicate.html#1065" class="Bound">e</a> <a id="1067" href="BitML.Predicate.html#555" class="InductiveConstructor Operator">`+</a> <a id="1070" href="BitML.Semantics.Predicate.html#1070" class="Bound">e′</a> <a id="1073" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟧ᵃʳ</a> <a id="1077" href="BitML.Semantics.Predicate.html#1077" class="Bound">Γ</a> <a id="1079" class="Symbol">=</a> <a id="1081" class="Symbol">⦇</a> <a id="1083" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟦</a> <a id="1085" href="BitML.Semantics.Predicate.html#1065" class="Bound">e</a> <a id="1087" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟧ᵃʳ</a> <a id="1091" href="BitML.Semantics.Predicate.html#1077" class="Bound">Γ</a> <a id="1093" href="Data.Integer.Base.html#3035" class="Function Operator">+</a> <a id="1095" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟦</a> <a id="1097" href="BitML.Semantics.Predicate.html#1070" class="Bound">e′</a> <a id="1100" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟧ᵃʳ</a> <a id="1104" href="BitML.Semantics.Predicate.html#1077" class="Bound">Γ</a> <a id="1106" class="Symbol">⦈</a>
<a id="1108" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟦</a> <a id="1110" href="BitML.Semantics.Predicate.html#1110" class="Bound">e</a> <a id="1112" href="BitML.Predicate.html#586" class="InductiveConstructor Operator">`-</a> <a id="1115" href="BitML.Semantics.Predicate.html#1115" class="Bound">e′</a> <a id="1118" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟧ᵃʳ</a> <a id="1122" href="BitML.Semantics.Predicate.html#1122" class="Bound">Γ</a> <a id="1124" class="Symbol">=</a> <a id="1126" class="Symbol">⦇</a> <a id="1128" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟦</a> <a id="1130" href="BitML.Semantics.Predicate.html#1110" class="Bound">e</a> <a id="1132" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟧ᵃʳ</a> <a id="1136" href="BitML.Semantics.Predicate.html#1122" class="Bound">Γ</a> <a id="1138" href="Data.Integer.Base.html#3214" class="Function Operator">-</a> <a id="1140" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟦</a> <a id="1142" href="BitML.Semantics.Predicate.html#1115" class="Bound">e′</a> <a id="1145" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟧ᵃʳ</a> <a id="1149" href="BitML.Semantics.Predicate.html#1122" class="Bound">Γ</a> <a id="1151" class="Symbol">⦈</a>


<a id="⟦_⟧_"></a><a id="1155" href="BitML.Semantics.Predicate.html#1155" class="Function Operator">⟦_⟧_</a> <a id="1160" class="Symbol">:</a> <a id="1162" href="BitML.Predicate.html#682" class="Datatype">Predicate</a> <a id="1172" class="Symbol">→</a> <a id="1174" href="BitML.Semantics.Configurations.Types.html#599" class="Datatype">Configuration</a> <a id="1188" class="Symbol">→</a> <a id="1190" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="1196" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1201" href="BitML.Semantics.Predicate.html#1155" class="Function Operator">⟦</a> <a id="1203" href="BitML.Predicate.html#706" class="InductiveConstructor">`true</a>   <a id="1211" href="BitML.Semantics.Predicate.html#1155" class="Function Operator">⟧</a> <a id="1213" href="BitML.Semantics.Predicate.html#1213" class="Bound">Γ</a> <a id="1215" class="Symbol">=</a> <a id="1217" class="Symbol">⦇</a> <a id="1219" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="1224" class="Symbol">⦈</a>
<a id="1226" href="BitML.Semantics.Predicate.html#1155" class="Function Operator">⟦</a> <a id="1228" href="BitML.Semantics.Predicate.html#1228" class="Bound">e</a> <a id="1230" href="BitML.Predicate.html#726" class="InductiveConstructor Operator">`∧</a> <a id="1233" href="BitML.Semantics.Predicate.html#1233" class="Bound">e′</a> <a id="1236" href="BitML.Semantics.Predicate.html#1155" class="Function Operator">⟧</a> <a id="1238" href="BitML.Semantics.Predicate.html#1238" class="Bound">Γ</a> <a id="1240" class="Symbol">=</a> <a id="1242" class="Symbol">⦇</a> <a id="1244" href="BitML.Semantics.Predicate.html#1155" class="Function Operator">⟦</a> <a id="1246" href="BitML.Semantics.Predicate.html#1228" class="Bound">e</a> <a id="1248" href="BitML.Semantics.Predicate.html#1155" class="Function Operator">⟧</a> <a id="1250" href="BitML.Semantics.Predicate.html#1238" class="Bound">Γ</a> <a id="1252" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="1254" href="BitML.Semantics.Predicate.html#1155" class="Function Operator">⟦</a> <a id="1256" href="BitML.Semantics.Predicate.html#1233" class="Bound">e′</a> <a id="1259" href="BitML.Semantics.Predicate.html#1155" class="Function Operator">⟧</a> <a id="1261" href="BitML.Semantics.Predicate.html#1238" class="Bound">Γ</a> <a id="1263" class="Symbol">⦈</a>
<a id="1265" href="BitML.Semantics.Predicate.html#1155" class="Function Operator">⟦</a> <a id="1267" href="BitML.Predicate.html#770" class="InductiveConstructor Operator">`¬</a> <a id="1270" href="BitML.Semantics.Predicate.html#1270" class="Bound">e</a>    <a id="1275" href="BitML.Semantics.Predicate.html#1155" class="Function Operator">⟧</a> <a id="1277" href="BitML.Semantics.Predicate.html#1277" class="Bound">Γ</a> <a id="1279" class="Symbol">=</a> <a id="1281" class="Symbol">⦇</a> <a id="1283" href="Data.Bool.Base.html#932" class="Function">not</a> <a id="1287" class="Symbol">(</a><a id="1288" href="BitML.Semantics.Predicate.html#1155" class="Function Operator">⟦</a> <a id="1290" href="BitML.Semantics.Predicate.html#1270" class="Bound">e</a> <a id="1292" href="BitML.Semantics.Predicate.html#1155" class="Function Operator">⟧</a> <a id="1294" href="BitML.Semantics.Predicate.html#1277" class="Bound">Γ</a><a id="1295" class="Symbol">)</a> <a id="1297" class="Symbol">⦈</a>
<a id="1299" href="BitML.Semantics.Predicate.html#1155" class="Function Operator">⟦</a> <a id="1301" href="BitML.Semantics.Predicate.html#1301" class="Bound">e</a> <a id="1303" href="BitML.Predicate.html#802" class="InductiveConstructor Operator">`=</a> <a id="1306" href="BitML.Semantics.Predicate.html#1306" class="Bound">e′</a> <a id="1309" href="BitML.Semantics.Predicate.html#1155" class="Function Operator">⟧</a> <a id="1311" href="BitML.Semantics.Predicate.html#1311" class="Bound">Γ</a> <a id="1313" class="Symbol">=</a> <a id="1315" class="Symbol">⦇</a> <a id="1317" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟦</a> <a id="1319" href="BitML.Semantics.Predicate.html#1301" class="Bound">e</a> <a id="1321" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟧ᵃʳ</a> <a id="1325" href="BitML.Semantics.Predicate.html#1311" class="Bound">Γ</a> <a id="1327" href="Prelude.DecEq.html#625" class="Function Operator">==</a> <a id="1330" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟦</a> <a id="1332" href="BitML.Semantics.Predicate.html#1306" class="Bound">e′</a> <a id="1335" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟧ᵃʳ</a> <a id="1339" href="BitML.Semantics.Predicate.html#1311" class="Bound">Γ</a> <a id="1341" class="Symbol">⦈</a>
<a id="1343" href="BitML.Semantics.Predicate.html#1155" class="Function Operator">⟦</a> <a id="1345" href="BitML.Semantics.Predicate.html#1345" class="Bound">e</a> <a id="1347" href="BitML.Predicate.html#838" class="InductiveConstructor Operator">`&lt;</a> <a id="1350" href="BitML.Semantics.Predicate.html#1350" class="Bound">e′</a> <a id="1353" href="BitML.Semantics.Predicate.html#1155" class="Function Operator">⟧</a> <a id="1355" href="BitML.Semantics.Predicate.html#1355" class="Bound">Γ</a> <a id="1357" class="Symbol">=</a> <a id="1359" class="Symbol">⦇</a> <a id="1361" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟦</a> <a id="1363" href="BitML.Semantics.Predicate.html#1345" class="Bound">e</a> <a id="1365" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟧ᵃʳ</a> <a id="1369" href="BitML.Semantics.Predicate.html#1355" class="Bound">Γ</a> <a id="1371" href="BitML.Semantics.Predicate.html#675" class="Function Operator">&lt;?ᵇ</a> <a id="1375" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟦</a> <a id="1377" href="BitML.Semantics.Predicate.html#1350" class="Bound">e′</a> <a id="1380" href="BitML.Semantics.Predicate.html#960" class="Function Operator">⟧ᵃʳ</a> <a id="1384" href="BitML.Semantics.Predicate.html#1355" class="Bound">Γ</a> <a id="1386" class="Symbol">⦈</a>
</pre></body></html>