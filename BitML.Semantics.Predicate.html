<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>BitML.Semantics.Predicate</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Denotational semantics of predicates.</a>
<a id="115" class="Comment">------------------------------------------------------------------------</a>
<a id="188" class="Keyword">open</a> <a id="193" class="Keyword">import</a> <a id="200" href="Prelude.Init.html" class="Module">Prelude.Init</a> <a id="213" class="Keyword">hiding</a> <a id="220" class="Symbol">(</a><a id="221" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a><a id="224" class="Symbol">)</a>
<a id="226" class="Keyword">open</a> <a id="231" href="Prelude.Init.html#2571" class="Module">Integer</a> <a id="239" class="Keyword">using</a> <a id="245" class="Symbol">(</a><a id="246" href="Data.Integer.Base.html#4844" class="Function Operator">_+_</a><a id="249" class="Symbol">;</a> <a id="251" href="Data.Integer.Base.html#5023" class="Function Operator">_-_</a><a id="254" class="Symbol">;</a> <a id="256" href="Data.Integer.Properties.html#9367" class="Function Operator">_&lt;?_</a><a id="260" class="Symbol">)</a>
<a id="262" class="Keyword">open</a> <a id="267" class="Keyword">import</a> <a id="274" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="288" class="Keyword">open</a> <a id="293" class="Keyword">import</a> <a id="300" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="314" class="Keyword">open</a> <a id="319" class="Keyword">import</a> <a id="326" href="Prelude.Applicative.html" class="Module">Prelude.Applicative</a>
<a id="346" class="Keyword">open</a> <a id="351" class="Keyword">import</a> <a id="358" href="Prelude.Monad.html" class="Module">Prelude.Monad</a>

<a id="373" class="Keyword">open</a> <a id="378" class="Keyword">import</a> <a id="385" href="BitML.BasicTypes.html" class="Module">BitML.BasicTypes</a>
<a id="402" class="Keyword">open</a> <a id="407" class="Keyword">import</a> <a id="414" href="BitML.Predicate.html" class="Module">BitML.Predicate</a>

<a id="431" class="Keyword">module</a> <a id="438" href="BitML.Semantics.Predicate.html" class="Module">BitML.Semantics.Predicate</a>
  <a id="466" class="Symbol">(</a><a id="467" href="BitML.Semantics.Predicate.html#467" class="Bound">Participant</a> <a id="479" class="Symbol">:</a> <a id="481" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="484" class="Symbol">)</a>
  <a id="488" class="Symbol">⦃</a> <a id="490" href="BitML.Semantics.Predicate.html#490" class="Bound">_</a> <a id="492" class="Symbol">:</a> <a id="494" href="Prelude.DecEq.Core.html#103" class="Record">DecEq</a> <a id="500" href="BitML.Semantics.Predicate.html#467" class="Bound">Participant</a> <a id="512" class="Symbol">⦄</a>
  <a id="516" class="Symbol">(</a><a id="517" href="BitML.Semantics.Predicate.html#517" class="Bound">Honest</a> <a id="524" class="Symbol">:</a> <a id="526" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a> <a id="532" href="BitML.Semantics.Predicate.html#467" class="Bound">Participant</a><a id="543" class="Symbol">)</a>
  <a id="547" class="Keyword">where</a>

<a id="554" class="Keyword">open</a> <a id="559" class="Keyword">import</a> <a id="566" href="BitML.Semantics.Configurations.Types.html" class="Module">BitML.Semantics.Configurations.Types</a> <a id="603" href="BitML.Semantics.Predicate.html#467" class="Bound">Participant</a> <a id="615" href="BitML.Semantics.Predicate.html#517" class="Bound">Honest</a> <a id="622" class="Keyword">hiding</a> <a id="629" class="Symbol">(</a><a id="630" href="BitML.Semantics.Configurations.Types.html#759" class="InductiveConstructor Operator">`_</a><a id="632" class="Symbol">)</a>

<a id="635" class="Keyword">infix</a> <a id="641" class="Number">4</a> <a id="643" href="BitML.Semantics.Predicate.html#649" class="Function Operator">_&lt;?ᵇ_</a>
<a id="_&lt;?ᵇ_"></a><a id="649" href="BitML.Semantics.Predicate.html#649" class="Function Operator">_&lt;?ᵇ_</a> <a id="655" class="Symbol">:</a> <a id="657" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="659" class="Symbol">→</a> <a id="661" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="663" class="Symbol">→</a> <a id="665" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="670" href="BitML.Semantics.Predicate.html#670" class="Bound">x</a> <a id="672" href="BitML.Semantics.Predicate.html#649" class="Function Operator">&lt;?ᵇ</a> <a id="676" href="BitML.Semantics.Predicate.html#676" class="Bound">y</a> <a id="678" class="Symbol">=</a> <a id="680" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="682" href="BitML.Semantics.Predicate.html#670" class="Bound">x</a> <a id="684" href="Data.Integer.Properties.html#9367" class="Function Operator">&lt;?</a> <a id="687" href="BitML.Semantics.Predicate.html#676" class="Bound">y</a> <a id="689" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a>

<a id="lookupSecretLen"></a><a id="692" href="BitML.Semantics.Predicate.html#692" class="Function">lookupSecretLen</a> <a id="708" class="Symbol">:</a> <a id="710" href="BitML.BasicTypes.html#261" class="Function">Secret</a> <a id="717" class="Symbol">→</a> <a id="719" href="BitML.Semantics.Configurations.Types.html#670" class="Datatype">Configuration</a> <a id="733" class="Symbol">→</a> <a id="735" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="741" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>
<a id="743" href="BitML.Semantics.Predicate.html#692" class="Function">lookupSecretLen</a> <a id="759" href="BitML.Semantics.Predicate.html#759" class="Bound">a</a> <a id="761" class="Symbol">(_</a> <a id="764" href="BitML.Semantics.Configurations.Types.html#1237" class="InductiveConstructor Operator">∶</a> <a id="766" href="BitML.Semantics.Predicate.html#766" class="Bound">a′</a> <a id="769" href="BitML.Semantics.Configurations.Types.html#1237" class="InductiveConstructor Operator">♯</a> <a id="771" href="BitML.Semantics.Predicate.html#771" class="Bound">N</a><a id="772" class="Symbol">)</a> <a id="774" class="Symbol">=</a> <a id="776" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="779" href="BitML.Semantics.Predicate.html#759" class="Bound">a</a> <a id="781" href="Prelude.DecEq.Core.html#179" class="Function Operator">==</a> <a id="784" href="BitML.Semantics.Predicate.html#766" class="Bound">a′</a> <a id="787" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="792" class="Symbol">⦇</a> <a id="794" class="Symbol">(</a><a id="795" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">+</a> <a id="797" href="BitML.Semantics.Predicate.html#771" class="Bound">N</a><a id="798" class="Symbol">)</a> <a id="800" class="Symbol">⦈</a> <a id="802" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="807" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="815" href="BitML.Semantics.Predicate.html#692" class="Function">lookupSecretLen</a> <a id="831" href="BitML.Semantics.Predicate.html#831" class="Bound">a</a> <a id="833" class="Symbol">(</a><a id="834" href="BitML.Semantics.Predicate.html#834" class="Bound">l</a> <a id="836" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="838" href="BitML.Semantics.Predicate.html#838" class="Bound">r</a><a id="839" class="Symbol">)</a>      <a id="846" class="Symbol">=</a> <a id="848" href="BitML.Semantics.Predicate.html#692" class="Function">lookupSecretLen</a> <a id="864" href="BitML.Semantics.Predicate.html#831" class="Bound">a</a> <a id="866" href="BitML.Semantics.Predicate.html#834" class="Bound">l</a> <a id="868" href="Prelude.Applicative.html#2898" class="Field Operator">&lt;|&gt;</a> <a id="872" href="BitML.Semantics.Predicate.html#692" class="Function">lookupSecretLen</a> <a id="888" href="BitML.Semantics.Predicate.html#831" class="Bound">a</a> <a id="890" href="BitML.Semantics.Predicate.html#838" class="Bound">r</a>
<a id="892" href="BitML.Semantics.Predicate.html#692" class="CatchallClause Function">lookupSecretLen</a><a id="907" class="CatchallClause"> </a><a id="908" class="CatchallClause Symbol">_</a><a id="909" class="CatchallClause"> </a><a id="910" class="CatchallClause Symbol">_</a>            <a id="923" class="Symbol">=</a> <a id="925" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

<a id="⟦_⟧ᵃʳ_"></a><a id="934" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟦_⟧ᵃʳ_</a> <a id="941" class="Symbol">:</a> <a id="943" href="BitML.Predicate.html#492" class="Datatype">Arith</a> <a id="949" class="Symbol">→</a> <a id="951" href="BitML.Semantics.Configurations.Types.html#670" class="Datatype">Configuration</a> <a id="965" class="Symbol">→</a> <a id="967" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="973" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>
<a id="975" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟦</a> <a id="977" href="BitML.Predicate.html#531" class="InductiveConstructor Operator">∣</a> <a id="979" href="BitML.Semantics.Predicate.html#979" class="Bound">a</a> <a id="981" href="BitML.Predicate.html#531" class="InductiveConstructor Operator">∣</a>   <a id="985" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟧ᵃʳ</a> <a id="989" href="BitML.Semantics.Predicate.html#989" class="Bound">Γ</a> <a id="991" class="Symbol">=</a> <a id="993" href="BitML.Semantics.Predicate.html#692" class="Function">lookupSecretLen</a> <a id="1009" href="BitML.Semantics.Predicate.html#979" class="Bound">a</a> <a id="1011" href="BitML.Semantics.Predicate.html#989" class="Bound">Γ</a>
<a id="1013" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟦</a> <a id="1015" href="BitML.Predicate.html#512" class="InductiveConstructor">`</a> <a id="1017" href="BitML.Semantics.Predicate.html#1017" class="Bound">x</a>     <a id="1023" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟧ᵃʳ</a> <a id="1027" class="Symbol">_</a> <a id="1029" class="Symbol">=</a> <a id="1031" class="Symbol">⦇</a> <a id="1033" href="BitML.Semantics.Predicate.html#1017" class="Bound">x</a> <a id="1035" class="Symbol">⦈</a>
<a id="1037" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟦</a> <a id="1039" href="BitML.Semantics.Predicate.html#1039" class="Bound">e</a> <a id="1041" href="BitML.Predicate.html#555" class="InductiveConstructor Operator">`+</a> <a id="1044" href="BitML.Semantics.Predicate.html#1044" class="Bound">e′</a> <a id="1047" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟧ᵃʳ</a> <a id="1051" href="BitML.Semantics.Predicate.html#1051" class="Bound">Γ</a> <a id="1053" class="Symbol">=</a> <a id="1055" class="Symbol">⦇</a> <a id="1057" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟦</a> <a id="1059" href="BitML.Semantics.Predicate.html#1039" class="Bound">e</a> <a id="1061" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟧ᵃʳ</a> <a id="1065" href="BitML.Semantics.Predicate.html#1051" class="Bound">Γ</a> <a id="1067" href="Data.Integer.Base.html#4844" class="Function Operator">+</a> <a id="1069" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟦</a> <a id="1071" href="BitML.Semantics.Predicate.html#1044" class="Bound">e′</a> <a id="1074" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟧ᵃʳ</a> <a id="1078" href="BitML.Semantics.Predicate.html#1051" class="Bound">Γ</a> <a id="1080" class="Symbol">⦈</a>
<a id="1082" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟦</a> <a id="1084" href="BitML.Semantics.Predicate.html#1084" class="Bound">e</a> <a id="1086" href="BitML.Predicate.html#586" class="InductiveConstructor Operator">`-</a> <a id="1089" href="BitML.Semantics.Predicate.html#1089" class="Bound">e′</a> <a id="1092" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟧ᵃʳ</a> <a id="1096" href="BitML.Semantics.Predicate.html#1096" class="Bound">Γ</a> <a id="1098" class="Symbol">=</a> <a id="1100" class="Symbol">⦇</a> <a id="1102" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟦</a> <a id="1104" href="BitML.Semantics.Predicate.html#1084" class="Bound">e</a> <a id="1106" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟧ᵃʳ</a> <a id="1110" href="BitML.Semantics.Predicate.html#1096" class="Bound">Γ</a> <a id="1112" href="Data.Integer.Base.html#5023" class="Function Operator">-</a> <a id="1114" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟦</a> <a id="1116" href="BitML.Semantics.Predicate.html#1089" class="Bound">e′</a> <a id="1119" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟧ᵃʳ</a> <a id="1123" href="BitML.Semantics.Predicate.html#1096" class="Bound">Γ</a> <a id="1125" class="Symbol">⦈</a>


<a id="⟦_⟧_"></a><a id="1129" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">⟦_⟧_</a> <a id="1134" class="Symbol">:</a> <a id="1136" href="BitML.Predicate.html#682" class="Datatype">Predicate</a> <a id="1146" class="Symbol">→</a> <a id="1148" href="BitML.Semantics.Configurations.Types.html#670" class="Datatype">Configuration</a> <a id="1162" class="Symbol">→</a> <a id="1164" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1170" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1175" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">⟦</a> <a id="1177" href="BitML.Predicate.html#706" class="InductiveConstructor">`true</a>   <a id="1185" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">⟧</a> <a id="1187" href="BitML.Semantics.Predicate.html#1187" class="Bound">Γ</a> <a id="1189" class="Symbol">=</a> <a id="1191" class="Symbol">⦇</a> <a id="1193" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="1198" class="Symbol">⦈</a>
<a id="1200" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">⟦</a> <a id="1202" href="BitML.Semantics.Predicate.html#1202" class="Bound">e</a> <a id="1204" href="BitML.Predicate.html#726" class="InductiveConstructor Operator">`∧</a> <a id="1207" href="BitML.Semantics.Predicate.html#1207" class="Bound">e′</a> <a id="1210" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">⟧</a> <a id="1212" href="BitML.Semantics.Predicate.html#1212" class="Bound">Γ</a> <a id="1214" class="Symbol">=</a> <a id="1216" class="Symbol">⦇</a> <a id="1218" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">⟦</a> <a id="1220" href="BitML.Semantics.Predicate.html#1202" class="Bound">e</a> <a id="1222" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">⟧</a> <a id="1224" href="BitML.Semantics.Predicate.html#1212" class="Bound">Γ</a> <a id="1226" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="1228" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">⟦</a> <a id="1230" href="BitML.Semantics.Predicate.html#1207" class="Bound">e′</a> <a id="1233" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">⟧</a> <a id="1235" href="BitML.Semantics.Predicate.html#1212" class="Bound">Γ</a> <a id="1237" class="Symbol">⦈</a>
<a id="1239" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">⟦</a> <a id="1241" href="BitML.Predicate.html#770" class="InductiveConstructor Operator">`¬</a> <a id="1244" href="BitML.Semantics.Predicate.html#1244" class="Bound">e</a>    <a id="1249" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">⟧</a> <a id="1251" href="BitML.Semantics.Predicate.html#1251" class="Bound">Γ</a> <a id="1253" class="Symbol">=</a> <a id="1255" class="Symbol">⦇</a> <a id="1257" href="Data.Bool.Base.html#932" class="Function">not</a> <a id="1261" class="Symbol">(</a><a id="1262" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">⟦</a> <a id="1264" href="BitML.Semantics.Predicate.html#1244" class="Bound">e</a> <a id="1266" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">⟧</a> <a id="1268" href="BitML.Semantics.Predicate.html#1251" class="Bound">Γ</a><a id="1269" class="Symbol">)</a> <a id="1271" class="Symbol">⦈</a>
<a id="1273" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">⟦</a> <a id="1275" href="BitML.Semantics.Predicate.html#1275" class="Bound">e</a> <a id="1277" href="BitML.Predicate.html#802" class="InductiveConstructor Operator">`=</a> <a id="1280" href="BitML.Semantics.Predicate.html#1280" class="Bound">e′</a> <a id="1283" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">⟧</a> <a id="1285" href="BitML.Semantics.Predicate.html#1285" class="Bound">Γ</a> <a id="1287" class="Symbol">=</a> <a id="1289" class="Symbol">⦇</a> <a id="1291" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟦</a> <a id="1293" href="BitML.Semantics.Predicate.html#1275" class="Bound">e</a> <a id="1295" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟧ᵃʳ</a> <a id="1299" href="BitML.Semantics.Predicate.html#1285" class="Bound">Γ</a> <a id="1301" href="Prelude.DecEq.Core.html#179" class="Function Operator">==</a> <a id="1304" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟦</a> <a id="1306" href="BitML.Semantics.Predicate.html#1280" class="Bound">e′</a> <a id="1309" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟧ᵃʳ</a> <a id="1313" href="BitML.Semantics.Predicate.html#1285" class="Bound">Γ</a> <a id="1315" class="Symbol">⦈</a>
<a id="1317" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">⟦</a> <a id="1319" href="BitML.Semantics.Predicate.html#1319" class="Bound">e</a> <a id="1321" href="BitML.Predicate.html#838" class="InductiveConstructor Operator">`&lt;</a> <a id="1324" href="BitML.Semantics.Predicate.html#1324" class="Bound">e′</a> <a id="1327" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">⟧</a> <a id="1329" href="BitML.Semantics.Predicate.html#1329" class="Bound">Γ</a> <a id="1331" class="Symbol">=</a> <a id="1333" class="Symbol">⦇</a> <a id="1335" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟦</a> <a id="1337" href="BitML.Semantics.Predicate.html#1319" class="Bound">e</a> <a id="1339" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟧ᵃʳ</a> <a id="1343" href="BitML.Semantics.Predicate.html#1329" class="Bound">Γ</a> <a id="1345" href="BitML.Semantics.Predicate.html#649" class="Function Operator">&lt;?ᵇ</a> <a id="1349" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟦</a> <a id="1351" href="BitML.Semantics.Predicate.html#1324" class="Bound">e′</a> <a id="1354" href="BitML.Semantics.Predicate.html#934" class="Function Operator">⟧ᵃʳ</a> <a id="1358" href="BitML.Semantics.Predicate.html#1329" class="Bound">Γ</a> <a id="1360" class="Symbol">⦈</a>
</pre></body></html>